var it=Object.defineProperty,ut=Object.defineProperties;var ct=Object.getOwnPropertyDescriptors;var ze=Object.getOwnPropertySymbols;var dt=Object.prototype.hasOwnProperty,pt=Object.prototype.propertyIsEnumerable;var He=(r,s,t)=>s in r?it(r,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[s]=t,oe=(r,s)=>{for(var t in s||(s={}))dt.call(s,t)&&He(r,t,s[t]);if(ze)for(var t of ze(s))pt.call(s,t)&&He(r,t,s[t]);return r},Ve=(r,s)=>ut(r,ct(s));var pe=(r,s,t)=>new Promise((a,m)=>{var l=c=>{try{b(t.next(c))}catch(w){m(w)}},d=c=>{try{b(t.throw(c))}catch(w){m(w)}},b=c=>c.done?a(c.value):Promise.resolve(c.value).then(l,d);b((t=t.apply(r,s)).next())});import{g as gt,r as A,i as F,o as n,a as u,n as z,j as J,F as Q,f as te,t as $,b as o,k as O,l as ie,u as v,m as W,p as ve,q as le,v as mt,x as de,y as fe,h as _e,z as je,A as X,B as ce,C as xe,d as N,w as K,D as vt,E as Se,T as ft,G as yt,H as bt,I as ne,J as ht,c as ue,K as $e,L as Fe,M as he,N as Je,O as qe,P as Ee,Q as ye,R as _t,S as be,U as Oe,e as ae,V as xt,W as wt,X as me,Y as kt,Z as Ye,s as Ke}from"./index-BIPCK0Np.js";const Ct=["src","alt"],St=gt({__name:"Avatar",props:{image:{},label:{},size:{default:"md"},shape:{default:"circle"}},setup(r){const s=A(!1),t=r,a=F(()=>({circle:"rounded-full",square:{xs:"rounded-[4px]",sm:"rounded-[5px]",md:"rounded-[5px]",lg:"rounded-[6px]",xl:"rounded-[6px]","2xl":"rounded-[8px]","3xl":"rounded-[10px]"}[t.size]})[t.shape]),m=F(()=>({xs:"w-4 h-4",sm:"w-5 h-5",md:"w-6 h-6",lg:"w-7 h-7",xl:"w-8 h-8","2xl":"w-10 h-10","3xl":"w-11.5 h-11.5"})[t.size]),l=F(()=>["font-medium",{xs:"text-2xs",sm:"text-sm",md:"text-base",lg:"text-base",xl:"text-lg","2xl":"text-xl","3xl":"text-2xl"}[t.size]]),d=F(()=>({xs:"-mr-[.1rem] -mb-[.1rem] h-2 w-2",sm:"-mr-[.1rem] -mb-[.1rem] h-[9px] w-[9px]",md:"-mr-[.1rem] -mb-[.1rem] h-2.5 w-2.5",lg:"-mr-[.1rem] -mb-[.1rem] h-3 w-3",xl:"-mr-[.1rem] -mb-[.1rem] h-3 w-3","2xl":"-mr-[.1rem] -mb-[.1rem] h-3.5 w-3.5","3xl":"-mr-[.2rem] -mb-[.2rem] h-4 w-4"})[t.size]),b=F(()=>({xs:"h-1 w-1",sm:"h-[5px] w-[5px]",md:"h-1.5 w-1.5",lg:"h-2 w-2",xl:"h-2 w-2","2xl":"h-2.5 w-2.5","3xl":"h-3 w-3"})[t.size]),c=F(()=>({xs:"h-2.5 w-2.5",sm:"h-3 w-3",md:"h-4 w-4",lg:"h-4 w-4",xl:"h-4 w-4","2xl":"h-5 w-5","3xl":"h-5 w-5"})[t.size]);function w(y){y.type&&(s.value=!0)}return(y,I)=>(n(),u("div",{class:z(["relative inline-block shrink-0",[m.value,a.value]])},[y.image&&!s.value?(n(),u("img",{key:0,src:y.image,alt:y.label,class:z([a.value,"h-full w-full object-cover"]),onError:I[0]||(I[0]=E=>w(E))},null,42,Ct)):(n(),u("div",{key:1,class:z(["flex h-full w-full items-center justify-center bg-surface-gray-2 uppercase text-ink-gray-5 select-none",[l.value,a.value]])},[y.$slots.default?(n(),u("div",{key:0,class:z(c.value)},[J(y.$slots,"default")],2)):(n(),u(Q,{key:1},[te($(y.label&&y.label[0]),1)],64))],2)),y.$slots.indicator?(n(),u("div",{key:2,class:z(["absolute bottom-0 right-0 grid place-items-center rounded-full bg-surface-white",d.value])},[o("div",{class:z(b.value)},[J(y.$slots,"indicator")],2)],2)):O("",!0)],2))}}),$t={class:"flex h-full w-full flex-col items-center justify-center text-base"},It={class:"text-xl font-medium"},Pt={class:"mt-1 text-base text-ink-gray-5"},Tt={__name:"ListEmptyState",setup(r){const s=ie("list");return(t,a)=>(n(),u("div",$t,[J(t.$slots,"default",{},()=>[o("div",It,$(v(s).options.emptyState.title),1),o("div",Pt,$(v(s).options.emptyState.description),1),v(s).options.emptyState.button?(n(),W(v(le),ve({key:0},v(s).options.emptyState.button,{class:"mt-4"}),null,16)):O("",!0)])]))}};function Xe(r,s=!0){let t=s?"14px ":"",a=r.map(m=>{let l=m.width||1;return typeof l=="number"?l+"fr":l}).join(" ");return t+a}const Ae={left:"justify-start",start:"justify-start",center:"justify-center",middle:"justify-center",right:"justify-end",end:"justify-end"},Rt={class:"truncate"},Ze={__name:"ListHeaderItem",props:{item:{type:Object,required:!0},debounce:{type:Number,default:1e3}},emits:["columnWidthUpdated"],setup(r,{emit:s}){const t=r,a=s,m=A(null),l=A(null),d=F(()=>{if(typeof t.item.width=="string"){const y=parseInt(t.item.width);if(t.item.width.includes("rem"))return y*16;if(t.item.width.includes("px"))return y}return l.value.offsetWidth}),b=y=>{const I=y.clientX,E=d.value,S=x=>{document.body.classList.add("select-none"),document.body.classList.add("cursor-col-resize"),m.value.style.backgroundColor="rgb(199 199 199)";let p=E+(x.clientX-I);t.item.width=`${p<50?50:p}px`,c(t.item.width)},f=()=>{document.body.classList.remove("select-none"),document.body.classList.remove("cursor-col-resize"),m.value.style.backgroundColor="",window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",f)};window.addEventListener("mousemove",S),window.addEventListener("mouseup",f)},c=mt(y=>{t.item.width=y,a("columnWidthUpdated")},t.debounce),w=ie("list");return(y,I)=>(n(),u("div",{ref_key:"columnRef",ref:l,class:z(["group relative flex items-center",r.item.align?v(Ae)[r.item.align]:"justify-between"])},[o("div",{class:z(["flex items-center space-x-2 truncate text-sm text-ink-gray-5",y.$attrs.class])},[J(y.$slots,"prefix",de(fe({item:r.item}))),J(y.$slots,"default",{},()=>[o("div",Rt,$(r.item.label),1)]),J(y.$slots,"suffix",de(fe({item:r.item})))],2),v(w).options.resizeColumn?J(y.$slots,"resizer",de(ve({key:0},{item:r.item})),()=>[o("div",{class:"flex h-4 absolute -right-2 w-2 cursor-col-resize justify-center",onMousedown:b},[o("div",{ref_key:"resizer",ref:m,class:"h-full w-[2px] rounded-full transition-all duration-300 ease-in-out group-hover:bg-gray-400"},null,512)],32)]):O("",!0)],2))}},et={__name:"ListHeader",emits:["columnWidthUpdated"],setup(r,{emit:s}){const t=s,a=ie("list");return(m,l)=>(n(),u("div",{class:"mb-2 grid items-center space-x-4 rounded bg-surface-gray-2 p-2",style:ce({gridTemplateColumns:v(Xe)(v(a).columns,v(a).options.selectable)})},[v(a).options.selectable?(n(),W(je,{key:0,class:"cursor-pointer duration-300",modelValue:v(a).allRowsSelected,onClick:_e(v(a).toggleAllRows,["stop"])},null,8,["modelValue","onClick"])):O("",!0),J(m.$slots,"default",{},()=>[(n(!0),u(Q,null,X(v(a).columns,d=>(n(),W(Ze,{key:d.key,item:d,onColumnWidthUpdated:b=>t("columnWidthUpdated",d)},null,8,["item","onColumnWidthUpdated"]))),128))])],4))}},Ft={class:"truncate text-base"},tt={__name:"ListRowItem",props:{column:{type:Object,default:{}},row:{type:Object,default:{}},item:{type:[String,Number,Object],default:""},align:{type:String,default:"left"}},setup(r){const s=r,t=F(()=>{var d,b;return(d=s.column)!=null&&d.getLabel?(b=s.column)==null?void 0:b.getLabel({row:s.row}):m(s.item).label||""}),a=F(()=>l.value.options.showTooltip?s.column.getTooltip?s.column.getTooltip(s.row):m(s.item).label:"");function m(d){return d&&typeof d=="object"?d:{label:d}}const l=ie("list");return(d,b)=>(n(),u("div",{class:z(["flex items-center space-x-2",v(Ae)[r.align]])},[J(d.$slots,"prefix",{},()=>[r.column.prefix?(n(),W(xe(typeof r.column.prefix=="function"?r.column.prefix({row:r.row}):r.column.prefix),{key:0})):O("",!0)]),N(v(vt),de(fe(v(l).options.showTooltip?{text:a.value}:{text:""})),{default:K(()=>[J(d.$slots,"default",de(fe({label:t.value})),()=>[o("div",Ft,$(t.value),1)])]),_:3},16),J(d.$slots,"suffix")],2))}},Be={__name:"ListRow",props:{row:{type:Object,required:!0}},setup(r){const s=r,t=ie("list"),a=F(()=>{var y;return(y=t.value.rows)!=null&&y.length?t.value.rows[t.value.rows.length-1][t.value.rowKey]===s.row[t.value.rowKey]:!1}),m=F(()=>t.value.selections.has(s.row[t.value.rowKey])),l=F(()=>t.value.options.enableActive&&t.value.activeRow.value===s.row.name),d=F(()=>t.value.options.getRowRoute||t.value.options.onRowClick),b=F(()=>typeof t.value.options.rowHeight=="number"?`${t.value.options.rowHeight}px`:t.value.options.rowHeight),c=F(()=>{var E,S,f;if(!m.value)return"rounded";const y=[...t.value.selections];let I=(E=t.value.rows[0])!=null&&E.group?t.value.rows.map(x=>x.rows):[t.value.rows];for(let x of I){let p=x.findIndex(R=>R==s.row);if(p===-1)continue;let k=!y.includes((S=x[p+1])==null?void 0:S.name),h=!y.includes((f=x[p-1])==null?void 0:f.name);return(k?"rounded-b ":"")+(h?"rounded-t":"")}}),w=(y,I)=>{t.value.options.onRowClick&&t.value.options.onRowClick(y,I),t.value.activeRow.value===y.name?t.value.activeRow.value=null:t.value.activeRow.value=y.name};return(y,I)=>(n(),W(xe(v(t).options.getRowRoute?"router-link":"div"),ve({class:[[c.value,m.value||l.value?"bg-surface-gray-2":"",d.value?"cursor-pointer":"",d.value?m.value||l.value?"hover:bg-surface-gray-3":"hover:bg-surface-menu-bar":""],"flex flex-col transition-all duration-300 ease-in-out"]},{to:v(t).options.getRowRoute?v(t).options.getRowRoute(r.row):void 0,onClick:E=>w(r.row,E)}),{default:K(()=>[(n(),W(xe(v(t).options.getRowRoute?"template":"button"),{class:"[all:unset] hover:[all:unset]"},{default:K(()=>{var E,S;return[o("div",{class:"grid items-center space-x-4 px-2",style:ce({height:b.value,gridTemplateColumns:v(Xe)(v(t).columns,v(t).options.selectable)})},[v(t).options.selectable?(n(),u("div",{key:0,class:"w-fit pr-2 py-3 flex",onClick:I[1]||(I[1]=_e(()=>{},["stop","prevent"])),onDblclick:I[2]||(I[2]=_e(()=>{},["stop"]))},[N(je,{modelValue:m.value,class:"cursor-pointer duration-300",onClick:I[0]||(I[0]=_e(f=>v(t).toggleRow(r.row[v(t).rowKey]),["stop"]))},null,8,["modelValue"])],32)):O("",!0),(n(!0),u(Q,null,X(v(t).columns,(f,x)=>(n(),u("div",{key:f.key,class:z([v(Ae)[f.align],x==0?"text-ink-gray-9":"text-ink-gray-7"])},[J(y.$slots,"default",ve({ref_for:!0},{idx:x,column:f,item:r.row[f.key],isActive:l.value}),()=>[v(t).slots.cell?(n(),W(xe(v(t).slots.cell),ve({key:0,ref_for:!0},{column:f,row:r.row,item:r.row[f.key],align:f.align}),null,16)):(n(),W(tt,{key:1,column:f,row:r.row,item:r.row[f.key],align:f.align},null,8,["column","row","item","align"]))])],2))),128))],4),a.value?O("",!0):(n(),u("div",{key:0,class:z(["h-px border-t",c.value==="rounded"||(S=(E=c.value)==null?void 0:E.includes)!=null&&S.call(E,"rounded-b")?"mx-2 border-outline-gray-1":"border-t-[--surface-gray-2]"])},null,2))]}),_:3}))]),_:3},16,["class"]))}},Et={class:"h-full overflow-y-auto"},st={__name:"ListRows",setup(r){const s=ie("list");return(t,a)=>(n(),u("div",Et,[J(t.$slots,"default",{},()=>[(n(!0),u(Q,null,X(v(s).rows,m=>(n(),W(Be,{key:m[v(s).rowKey],row:m},null,8,["row"]))),128))])]))}},Lt={},Mt={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16"};function Dt(r,s){return n(),u("svg",Mt,s[0]||(s[0]=[o("path",{fill:"currentColor",d:"M4.293 5.28h7.413a.5.5 0 0 1 .41.787l-3.707 5.295a.5.5 0 0 1-.82 0L3.884 6.067a.5.5 0 0 1 .41-.787Z"},null,-1)]))}const jt=Se(Lt,[["render",Dt]]),Ot={class:"flex items-center"},At={class:"w-full py-1.5 pr-2"},Bt={key:1,class:"text-base font-medium leading-6"},Nt={__name:"ListGroupHeader",props:{group:{type:Object,required:!0}},setup(r){const s=r,t=ie("list");function a(){s.group.collapsed==null&&(s.group.collapsed=!1),s.group.collapsed=!s.group.collapsed}return(m,l)=>(n(),u(Q,null,[o("div",Ot,[o("button",{onClick:a,class:"ml-[3px] mr-[11px] rounded p-1 hover:bg-surface-gray-2"},[N(jt,{class:z(["h-4 w-4 text-ink-gray-6 transition-transform duration-200",[r.group.collapsed?"-rotate-90":""]])},null,8,["class"])]),J(m.$slots,"default",{},()=>[o("div",At,[v(t).slots["group-header"]?(n(),W(xe(v(t).slots["group-header"]),de(ve({key:0},{group:r.group})),null,16)):(n(),u("span",Bt,$(r.group.group),1))])])]),l[0]||(l[0]=o("div",{class:"mx-2 h-px border-t border-outline-gray-modals"},null,-1))],64))}},Ut={key:0,class:"mb-5 mt-2"},zt={__name:"ListGroupRows",props:{group:{type:Object,required:!0}},setup(r){const s=ie("list");return(t,a)=>r.group.collapsed?O("",!0):(n(),u("div",Ut,[J(t.$slots,"default",{},()=>[(n(!0),u(Q,null,X(r.group.rows,m=>(n(),W(Be,{key:m[v(s).rowKey],row:m},null,8,["row"]))),128))])]))}},Ht={class:"h-full overflow-y-auto"},Vt={__name:"ListGroups",setup(r){const s=ie("list");return(t,a)=>(n(),u("div",Ht,[(n(!0),u(Q,null,X(v(s).rows,m=>(n(),u("div",{key:m.group},[J(t.$slots,"default",{},()=>[N(Nt,{group:m},{default:K(()=>[t.$slots["group-header"]?J(t.$slots,"group-header",ve({key:0,ref_for:!0},{group:m})):O("",!0)]),_:2},1032,["group"]),N(zt,{group:m},null,8,["group"])])]))),128))]))}},qt={key:0,class:"absolute inset-x-0 bottom-6 mx-auto w-max text-base"},Yt={class:"flex flex-1 justify-between border-r border-outline-gray-2 text-ink-gray-9"},Kt={class:"flex items-center space-x-3"},Wt={class:"mr-3"},Qt={class:"flex items-center space-x-1"},rt=Object.assign({inheritAttrs:!1},{__name:"ListSelectBanner",setup(r){const s=ie("list");let t=F(()=>s.value.options.selectionText(s.value.selections.size));return(a,m)=>(n(),W(ft,{"enter-active-class":"duration-300 ease-out","enter-from-class":"transform opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-300 ease-in","leave-from-class":"opacity-100","leave-to-class":"transform opacity-0"},{default:K(()=>[v(s).selections.size?(n(),u("div",qt,[o("div",{class:z(["flex min-w-[596px] items-center space-x-3 rounded-lg bg-surface-white px-4 py-2 shadow-2xl",a.$attrs.class])},[J(a.$slots,"default",de(fe({selections:v(s).selections,allRowsSelected:v(s).allRowsSelected,selectAll:()=>v(s).toggleAllRows(!0),unselectAll:()=>v(s).toggleAllRows(!1)})),()=>[o("div",Yt,[o("div",Kt,[N(je,{modelValue:!0,disabled:!0,class:"text-ink-gray-9"}),o("div",null,$(v(t)),1)]),o("div",Wt,[J(a.$slots,"actions",de(fe({selections:v(s).selections,allRowsSelected:v(s).allRowsSelected,selectAll:()=>v(s).toggleAllRows(!0),unselectAll:()=>v(s).toggleAllRows(!1)})))])]),o("div",Qt,[N(v(le),{class:z(["w- text-ink-gray-7",v(s).allRowsSelected?"cursor-not-allowed":""]),disabled:v(s).allRowsSelected,variant:"ghost",onClick:m[0]||(m[0]=l=>v(s).toggleAllRows(!0))},{default:K(()=>m[2]||(m[2]=[te(" Select all ")])),_:1,__:[2]},8,["disabled","class"]),N(v(le),{icon:"x",variant:"ghost",onClick:m[1]||(m[1]=l=>v(s).toggleAllRows(!1))})])])],2)])):O("",!0)]),_:3}))}}),Gt={class:"relative flex w-full flex-1 flex-col overflow-x-auto"},Jt=Object.assign({inheritAttrs:!1},{__name:"ListView",props:{columns:{type:Array,default:[]},rows:{type:Array,default:[]},rowKey:{type:String,required:!0},options:{type:Object,default:()=>({getRowRoute:null,onRowClick:null,showTooltip:!0,selectable:!0,resizeColumn:!1,rowHeight:40,emptyState:{title:"No Data",description:"No data available"}})}},emits:["update:selections","update:active-row"],setup(r,{expose:s,emit:t}){const a=r,m=yt();let l=bt(new Set),d=A(null);const b=t;ne(l,f=>{l.size&&(d.value=null),b("update:selections",f)}),ne(d,f=>{b("update:active-row",f)});let c=F(()=>{function f(p){return p===void 0?!0:p}function x(p){return p===void 0?!1:p}return{getRowRoute:a.options.getRowRoute||null,onRowClick:a.options.onRowClick||null,showTooltip:f(a.options.showTooltip),selectionText:a.options.selectionText||(p=>p===1?"1 row selected":`${p} rows selected`),enableActive:x(a.options.enableActive),selectable:f(a.options.selectable),resizeColumn:x(a.options.resizeColumn),rowHeight:a.options.rowHeight||40,emptyState:a.options.emptyState}});const w=F(()=>a.rows.length?I.value?l.size===a.rows.reduce((f,x)=>f+x.rows.length,0):l.size===a.rows.length:!1),y=F(()=>c.value.selectable);let I=F(()=>a.rows.every(f=>f.group&&f.rows&&Array.isArray(f.rows)));function E(f){l.delete(f)||l.add(f)}function S(f){if(!f||w.value){l.clear();return}if(I.value){a.rows.forEach(x=>{x.rows.forEach(p=>l.add(p[a.rowKey]))});return}a.rows.forEach(x=>l.add(x[a.rowKey]))}return ht("list",F(()=>({rowKey:a.rowKey,rows:a.rows,columns:a.columns,options:c.value,selections:l,activeRow:d,allRowsSelected:w.value,slots:m,toggleRow:E,toggleAllRows:S}))),s({selections:l,allRowsSelected:w,toggleRow:E,toggleAllRows:S}),(f,x)=>(n(),u("div",Gt,[o("div",{class:z(["flex w-max min-w-full flex-col overflow-y-hidden",f.$attrs.class]),style:ce(f.$attrs.style)},[J(f.$slots,"default",de(fe({showGroupedRows:v(I),selectable:y.value})),()=>[N(et),a.rows.length?(n(),u(Q,{key:0},[v(I)?(n(),W(Vt,{key:0})):(n(),W(st,{key:1}))],64)):(n(),W(Tt,{key:1})),y.value?(n(),W(rt,{key:2})):O("",!0)])],6)]))}});function Xt(a,m){return pe(this,arguments,function*(r,s,t={}){s||(s={});let l=Object.assign({Accept:"application/json","Content-Type":"application/json; charset=utf-8","X-Frappe-Site-Name":window.location.hostname},t.headers||{});window.csrf_token&&window.csrf_token!=="{{ csrf_token }}"&&(l["X-Frappe-CSRF-Token"]=window.csrf_token);let d=r.startsWith("/")?r:`/api/method/${r}`;const b=yield fetch(d,{method:"POST",headers:l,body:JSON.stringify(s)});if(b.ok){const c=yield b.json();if(c.docs||r==="login")return c;if(c.exc)try{console.groupCollapsed(r),console.log(`method: ${r}`),console.log("params:",s);let w=JSON.parse(c.exc);for(let y of w)console.log(y);console.groupEnd()}catch(w){console.warn("Error printing debug messages",w)}return c.message}else{let c=yield b.text(),w,y;try{w=JSON.parse(c)}catch(S){}let I=[[r,w.exc_type,w._error_message].filter(Boolean).join(" ")];if(w.exc){y=w.exc;try{y=JSON.parse(y)[0],console.log(y)}catch(S){}}let E=new Error(I.join(`
`));throw E.exc_type=w.exc_type,E.exc=y,E.status=b.status,E.messages=w._server_messages?JSON.parse(w._server_messages):[],E.messages=E.messages.concat(w.message),E.messages=E.messages.map(S=>{try{return JSON.parse(S).message}catch(f){return S}}),E.messages=E.messages.filter(Boolean),E.messages.length||(E.messages=w._error_message?[w._error_message]:["Internal Server Error"]),t.onError&&t.onError({response:b,status:b.status,error:E}),E}})}const Ce=ue({url:"force_trans_customization.api.issues.get_issues_with_assignments",makeParams(r){const s=r||{},t=s.limit_page_length||10,a=s.limit_start||0,m=s.filters||{},l=s.order_by||"creation desc";return{limit_page_length:t,limit_start:a,filters:m,order_by:l}},onError(r){console.error("Failed to fetch issues:",r),window.$toast&&window.$toast({title:"Error",text:"Failed to load issues. Please try again.",icon:"x",iconClasses:"text-red-600"})},auto:!0}),ot=ue({url:"force_trans_customization.api.issues.get_issues_count_with_filters",makeParams(r){return{filters:(r||{}).filters||{}}},onError(r){console.error("Failed to fetch issues count:",r)}});function we(r={}){const s={limit_page_length:r.limit_page_length||10,limit_start:r.limit_start||0,filters:r.filters||{},order_by:r.order_by||"creation desc"};return Ce.reload(s)}function ke(r={}){return ot.reload({filters:r})}const at=ue({url:"force_trans_customization.api.issues.get_single_issue_with_assignments",makeParams(r){return{issue_name:r}},onError(r){console.error("Failed to fetch single issue:",r)},auto:!1});function Zt(r){return at.reload(r)}const es=ue({url:"frappe.client.get_list",makeParams(){return{doctype:"Issue Priority",fields:["name"],limit_page_length:0,order_by:"name asc"}},cache:"IssuePriority",onError(r){console.error("Failed to fetch issue priorities:",r)},auto:!0}),ts=ue({url:"frappe.client.get_list",makeParams(){return{doctype:"Issue Type",fields:["name"],limit_page_length:0,order_by:"name asc"}},cache:"IssueType",onError(r){console.error("Failed to fetch issue types:",r)},auto:!0});ue({url:"frappe.client.get_list",makeParams(){return{doctype:"Project",fields:["name","project_name","status"],filters:{status:["!=","Cancelled"]},limit_page_length:0,order_by:"name asc"}},cache:"Project",onError(r){console.error("Failed to fetch projects:",r)},auto:!0});let Ie=null,We=null,Pe=null,Qe=null;function ss(){const r=es.data||[],s=JSON.stringify(r);if(Ie&&We===s)return Ie;const t=[{label:"All Priority",value:""},...r.map(a=>({label:a.name,value:a.name}))];return Ie=Object.freeze(t),We=s,Ie}function rs(){const r=ts.data||[],s=JSON.stringify(r);if(Pe&&Qe===s)return Pe;const t=[{label:"All Types",value:""},...r.map(a=>({label:a.name,value:a.name}))];return Pe=Object.freeze(t),Qe=s,Pe}const os=Object.freeze([{label:"All Status",value:""},{label:"Open",value:"Open"},{label:"Replied",value:"Replied"},{label:"On Hold",value:"On Hold"},{label:"Resolved",value:"Resolved"},{label:"Closed",value:"Closed"}]);function as(){return os}const ls=ue({url:"force_trans_customization.api.issues.get_tag_colors",cache:"TagColors",onError(r){console.error("Failed to fetch tag colors:",r)},auto:!0}),Te=new Map;let Ge=null;function De(r){const s=ls.data||{},t=JSON.stringify(s);if(Ge!==t&&(Te.clear(),Ge=t),Te.has(r))return Te.get(r);const a=s[r]||null;return Te.set(r,a),a}const Le=ue({url:"force_trans_customization.api.issues.issue_search",makeParams(r){const s=r||{};return{search_query:s.search_query||"",limit:s.limit||8}},onError(r){console.error("Failed to search issues:",r)},auto:!1});function ns(r,s=8){return!r||r.length<2?Promise.resolve(Le.data||[]):Le.reload({search_query:r,limit:s}).then(()=>Le.data||[])}const ge=ue({url:"force_trans_customization.api.issues.get_issues_by_stat_filter",makeParams(r){const s=r||{};return{stat_type:s.stat_type||"team_tickets",limit_page_length:s.limit_page_length||10,limit_start:s.limit_start||0,order_by:s.order_by||"creation desc"}},onError(r){console.error("Failed to filter issues by stat:",r),window.$toast&&window.$toast({title:"Error",text:"Failed to filter issues. Please try again.",icon:"x",iconClasses:"text-red-600"})},auto:!1}),lt=ue({url:"force_trans_customization.api.issues.get_stat_filter_count",makeParams(r){return{stat_type:(r||{}).stat_type||"team_tickets"}},onError(r){console.error("Failed to get stat filter count:",r)},auto:!1});function Re(r,s={}){const t={stat_type:r,limit_page_length:s.limit_page_length||10,limit_start:s.limit_start||0,order_by:s.order_by||"creation desc"};return ge.reload(t)}function Me(r){return lt.reload({stat_type:r})}const is={class:"relative w-full max-w-2xl mx-auto"},us={class:"relative group"},cs=["placeholder"],ds={class:"absolute inset-y-0 right-0 flex items-center pr-4 space-x-2"},ps={key:1,class:"flex items-center pointer-events-none"},gs={key:2,class:"animate-spin"},ms={key:0,class:"px-4 py-3 bg-gradient-to-r from-slate-50 to-slate-100/50 border-b border-slate-100"},vs={class:"flex items-center justify-between"},fs={class:"text-xs font-semibold text-slate-600 uppercase tracking-wider"},ys={class:"text-xs text-slate-500"},bs={key:0,class:"px-6 py-8 text-center"},hs=["onClick"],_s={class:"flex items-start space-x-4"},xs={class:"flex-1 min-w-0"},ws={class:"flex items-start justify-between"},ks={class:"flex-1 min-w-0"},Cs={class:"text-sm font-semibold text-slate-900 truncate group-hover:text-blue-900 transition-colors duration-150"},Ss=["innerHTML"],$s={class:"text-xs text-slate-500 mt-1 line-clamp-2"},Is={key:0,class:"ml-2"},Ps={class:"flex-shrink-0 ml-4"},Ts={class:"mt-2 flex items-center justify-between text-xs text-slate-400"},Rs={key:0,class:"flex items-center"},Fs={key:1,class:"flex items-center"},Es={key:1,class:"px-4 py-3 bg-slate-50/50 border-t border-slate-100"},Ls={__name:"CustomSearchBox",props:{modelValue:{type:String,default:""},placeholder:{type:String,default:"Search issues by title, description, ID..."},issues:{type:Array,default:()=>[]}},emits:["update:modelValue","search","suggestion-selected"],setup(r,{expose:s,emit:t}){const a=r,m=t,l=A(null),d=A(a.modelValue),b=A(!1),c=A(!1),w=A(-1),y=A(!1),I=A(0),E=A(null),S=A([]);let f=null;ne(()=>a.modelValue,e=>{d.value=e}),ne(d,e=>{m("update:modelValue",e),m("search",e)});const x=A([]),p=e=>pe(this,null,function*(){if(!e||e.length<2){x.value=[],c.value=!1,y.value=!1;return}try{y.value=!0;const i=performance.now(),P=yield ns(e,8);I.value=performance.now()-i,x.value=P||[],c.value=!0}catch(i){console.error("Search error:",i),x.value=[],c.value=!1}finally{y.value=!1}}),k=e=>{if(f&&clearTimeout(f),w.value=-1,!e||e.length<2){x.value=[],c.value=!1,y.value=!1;return}y.value=!0,f=setTimeout(()=>{p(e)},1e3)},h=()=>{k(d.value)},R=(e,i)=>{if(!e||!i)return e;const P=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),M=new RegExp(`(${P})`,"gi");return e.replace(M,'<mark class="bg-yellow-200 text-yellow-900 px-0.5 rounded">$1</mark>')},U=e=>({Open:"bg-green-100 text-green-800 border border-green-200",New:"bg-blue-100 text-blue-800 border border-blue-200","In Progress":"bg-blue-100 text-blue-800 border border-blue-200","In Review":"bg-orange-100 text-orange-800 border border-orange-200",Resolved:"bg-gray-100 text-gray-800 border border-gray-200",Closed:"bg-red-100 text-red-800 border border-red-200",Pending:"bg-yellow-100 text-yellow-800 border border-yellow-200","On Hold":"bg-orange-100 text-orange-800 border border-orange-200",Delivered:"bg-green-100 text-green-800 border border-green-200",Confirmed:"bg-purple-100 text-purple-800 border border-purple-200"})[e]||"bg-gray-100 text-gray-800 border border-gray-200",B=()=>{b.value=!0,D&&(clearTimeout(D),D=null),d.value.length>=2&&(x.value.length>0?c.value=!0:p(d.value))};let D=null;const L=()=>{b.value=!1,D=setTimeout(()=>{c.value=!1,D=null},200)},H=e=>{var i;if(c.value)switch(e.key){case"ArrowDown":e.preventDefault(),w.value=Math.min(w.value+1,x.value.length-1),q();break;case"ArrowUp":e.preventDefault(),w.value=Math.max(w.value-1,-1),q();break;case"Enter":e.preventDefault(),w.value>=0&&G(x.value[w.value]);break;case"Escape":V(),(i=l.value)==null||i.blur();break}},G=e=>{d.value=e.name,V();const P=`${window.location.origin}/app/issue/${e.name}`;window.open(P,"_blank"),m("suggestion-selected",e)},Z=()=>{var e;d.value="",V(),(e=l.value)==null||e.focus()},V=()=>{c.value=!1,w.value=-1},q=()=>{if(w.value<0||!E.value||!S.value[w.value])return;const e=E.value,i=S.value[w.value];if(i){const P=e.getBoundingClientRect(),M=i.getBoundingClientRect(),Y=M.top-P.top+e.scrollTop,g=Y+M.height,C=e.scrollTop,T=e.clientHeight;Y<C?e.scrollTop=Y:g>C+T&&(e.scrollTop=g-T)}},ee=e=>{if(!e)return"";try{const i=new Date(e),P=new Date,M=Math.abs(P-i),Y=Math.ceil(M/(1e3*60*60*24));return Y===1?"Today":Y===2?"Yesterday":Y<=7?`${Y-1} days ago`:i.toLocaleDateString("en-US",{month:"short",day:"numeric",year:i.getFullYear()!==P.getFullYear()?"numeric":void 0})}catch(i){return console.error("Error formatting date:",i),e}},_=e=>{var i,P;(e.metaKey||e.ctrlKey)&&e.key==="k"&&(e.preventDefault(),(i=l.value)==null||i.focus(),(P=l.value)==null||P.select())};return $e(()=>{document.addEventListener("keydown",_)}),Fe(()=>{document.removeEventListener("keydown",_),f&&clearTimeout(f),D&&clearTimeout(D)}),s({focus:()=>{var e,i;(e=l.value)==null||e.focus(),(i=l.value)==null||i.select()},select:()=>{var e;return(e=l.value)==null?void 0:e.select()},$el:l}),(e,i)=>(n(),u("div",is,[o("div",us,[i[4]||(i[4]=o("div",{class:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none z-10"},[o("svg",{class:"h-5 w-5 text-slate-400 transition-colors duration-200 group-focus-within:text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),he(o("input",{ref_key:"searchInput",ref:l,type:"text","onUpdate:modelValue":i[0]||(i[0]=P=>d.value=P),onInput:h,onFocus:B,onBlur:L,onKeydown:H,placeholder:r.placeholder,class:z(["w-full h-14 pl-12 pr-20 text-base bg-white border border-slate-200 rounded-2xl placeholder-slate-400 text-slate-700 transition-all duration-200 ease-out focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 focus:bg-white hover:border-slate-300 hover:shadow-sm focus:shadow-lg backdrop-blur-sm",{"shadow-lg ring-2 ring-blue-500/20 border-blue-500":b.value,"bg-slate-50/50":!b.value&&d.value}])},null,42,cs),[[Je,d.value]]),o("div",ds,[d.value?(n(),u("button",{key:0,onClick:Z,class:"p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500/20","aria-label":"Clear search"},i[1]||(i[1]=[o("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))):O("",!0),!d.value&&!b.value?(n(),u("div",ps,i[2]||(i[2]=[o("kbd",{class:"hidden sm:inline-flex items-center px-2.5 py-1.5 border border-slate-200 rounded-lg text-xs font-mono text-slate-400 bg-slate-50/80 shadow-sm"},[o("span",{class:"text-xs"},"⌘+"),te("K ")],-1)]))):O("",!0),y.value?(n(),u("div",gs,i[3]||(i[3]=[o("svg",{class:"h-4 w-4 text-blue-500",fill:"none",viewBox:"0 0 24 24"},[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):O("",!0)])]),c.value?(n(),u("div",{key:0,class:z(["absolute z-50 w-full mt-3 bg-white border border-slate-200 rounded-2xl shadow-2xl overflow-hidden backdrop-blur-sm bg-white/95",{"animate-in slide-in-from-top-2 duration-200":c.value}])},[x.value.length>0?(n(),u("div",ms,[o("div",vs,[o("span",fs,$(x.value.length)+" Result"+$(x.value.length!==1?"s":""),1),o("span",ys,$(Math.round(I.value))+"ms ",1)])])):O("",!0),o("div",{ref_key:"suggestionsContainer",ref:E,class:"max-h-80 overflow-y-auto scrollbar-thin scrollbar-thumb-slate-200 scrollbar-track-transparent"},[x.value.length===0&&d.value.length>=2?(n(),u("div",bs,i[5]||(i[5]=[qe('<div class="w-16 h-16 mx-auto mb-4 bg-slate-100 rounded-full flex items-center justify-center" data-v-4969cdcf><svg class="w-8 h-8 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-4969cdcf><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-4969cdcf></path></svg></div><p class="text-slate-500 text-sm font-medium" data-v-4969cdcf>No issues found</p><p class="text-slate-400 text-xs mt-1" data-v-4969cdcf>Try adjusting your search terms</p>',3)]))):O("",!0),(n(!0),u(Q,null,X(x.value,(P,M)=>(n(),u("div",{key:P.name||M,ref_for:!0,ref:Y=>S.value[M]=Y,onClick:Y=>G(P),class:z(["group px-4 py-4 hover:bg-blue-50/50 cursor-pointer transition-all duration-150 border-b border-slate-50 last:border-b-0",{"bg-blue-50 ring-2 ring-blue-500/10":M===w.value}])},[o("div",_s,[i[8]||(i[8]=o("div",{class:"flex-shrink-0 mt-0.5"},[o("div",{class:"w-10 h-10 bg-gradient-to-br from-blue-100 to-blue-200 rounded-xl flex items-center justify-center group-hover:from-blue-200 group-hover:to-blue-300 transition-all duration-200"},[o("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])])],-1)),o("div",xs,[o("div",ws,[o("div",ks,[o("h4",Cs,[o("span",{innerHTML:R(P.subject||P.name,d.value)},null,8,Ss)]),o("p",$s,[te(" ID: "+$(P.name)+" ",1),P.customer?(n(),u("span",Is,"• "+$(P.customer),1)):O("",!0)])]),o("div",Ps,[o("span",{class:z(["inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium transition-colors duration-150",U(P.status)])},$(P.status),3)])]),o("div",Ts,[P.raised_by?(n(),u("div",Rs,[i[6]||(i[6]=o("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),te(" "+$(P.raised_by),1)])):O("",!0),P.creation?(n(),u("div",Fs,[i[7]||(i[7]=o("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),te(" "+$(ee(P.creation)),1)])):O("",!0)])])])],10,hs))),128))],512),d.value&&x.value.length>0?(n(),u("div",Es,i[9]||(i[9]=[qe('<div class="flex items-center justify-between text-xs text-slate-500" data-v-4969cdcf><div class="flex items-center space-x-4" data-v-4969cdcf><span class="flex items-center" data-v-4969cdcf><kbd class="px-1.5 py-0.5 bg-white border border-slate-200 rounded text-xs font-mono mr-1" data-v-4969cdcf>↵</kbd> to select </span><span class="flex items-center" data-v-4969cdcf><kbd class="px-1.5 py-0.5 bg-white border border-slate-200 rounded text-xs font-mono mr-1" data-v-4969cdcf>↑↓</kbd> to navigate </span></div><span class="flex items-center" data-v-4969cdcf><kbd class="px-1.5 py-0.5 bg-white border border-slate-200 rounded text-xs font-mono mr-1" data-v-4969cdcf>esc</kbd> to close </span></div>',1)]))):O("",!0)],2)):O("",!0),c.value?(n(),u("div",{key:1,class:"fixed inset-0 z-40 bg-black/5",onClick:V})):O("",!0)]))}},Ms=Se(Ls,[["__scopeId","data-v-4969cdcf"]]),Ds={class:"bg-white p-6 rounded-lg shadow-sm border mb-6"},js={class:"mb-6"},Os={class:"relative max-w-2xl mx-auto"},As={key:0,class:"absolute top-full left-0 right-0 mt-1 text-sm text-gray-500 text-center"},Bs={class:"border-t border-gray-200 pt-4"},Ns={class:"flex items-center justify-between"},Us={class:"flex items-center space-x-3 flex-1"},zs={key:0,class:"bg-blue-600 text-white text-xs px-1.5 py-0.5 rounded-full"},Hs={key:0,class:"flex items-center space-x-2 flex-1 overflow-x-auto"},Vs={class:"text-gray-600 font-medium"},qs={class:"text-gray-500"},Ys={key:1,class:"text-gray-900"},Ks=["onClick"],Ws={key:0,class:"flex items-center space-x-2 ml-4"},Qs={key:0,class:"relative"},Gs={class:"absolute top-2 left-0 right-0 z-50 bg-white border border-gray-200 rounded-lg shadow-lg"},Js={class:"flex"},Xs={class:"w-48 border-r border-gray-200 bg-gray-50"},Zs={class:"max-h-64 overflow-y-auto"},er=["onClick"],tr={class:"flex-1 min-w-96"},sr={class:"p-4"},rr={key:0,class:"text-center py-8 text-gray-500"},or={key:1,class:"space-y-3"},ar={class:"w-24 text-sm font-medium text-gray-700"},lr={class:"w-24"},nr=["onUpdate:modelValue","onChange"],ir=["value"],ur={class:"flex-1"},cr={key:0,class:"relative"},dr=["onUpdate:modelValue","onChange"],pr=["value"],gr={key:0,class:"absolute right-8 top-1/2 transform -translate-y-1/2"},mr=["onUpdate:modelValue","onChange"],vr=["value"],fr=["onUpdate:modelValue","onInput","placeholder"],yr=["onClick"],br={key:2,class:"flex justify-between items-center pt-4 mt-4 border-t border-gray-200"},hr={__name:"IssueFilters",props:{searchQuery:{type:String,default:""},filters:{type:Object,default:()=>({status:"",priority:"",assignee:"",tags:"",sortBy:"creation"})},statusOptions:{type:Array,default:()=>[]},priorityOptions:{type:Array,default:()=>[]},assigneeOptions:{type:Array,default:()=>[]},tagsOptions:{type:Array,default:()=>[]},filteredCount:{type:Number,default:0},issues:{type:Array,default:()=>[]}},emits:["update:searchQuery","update:filters","suggestion-selected"],setup(r,{emit:s}){const t=r,a=s,m=A(t.searchQuery),l=A(oe({},t.filters)),d=A(null),b=A(!1),c=A([]);let w=0;const y=F(()=>{const _=new Set;return t.issues.forEach(e=>{e._user_tags&&Array.isArray(e._user_tags)&&e._user_tags.forEach(i=>{i&&i.trim()&&_.add(i.trim())})}),Array.from(_).sort().map(e=>({label:e,value:e,color:De(e)}))}),I=F(()=>[{value:"subject",label:"Subject",description:"Filter by issue title",icon:"type",type:"text"},{value:"status",label:"Status",description:"Filter by issue status (New, In Review, etc.)",icon:"circle",type:"select"},{value:"priority",label:"Priority",description:"Filter by priority level",icon:"flag",type:"select"},{value:"issue_type",label:"Issue Type",description:"Filter by issue category",icon:"tag",type:"select"},{value:"raised_by",label:"Raised By (Email)",description:"Filter by who raised the issue",icon:"user",type:"text"},{value:"description",label:"Description",description:"Filter by issue description",icon:"file-text",type:"text"},{value:"customer",label:"Customer",description:"Filter by customer",icon:"building",type:"link"},{value:"customer_name",label:"Customer Name",description:"Filter by customer name",icon:"building",type:"text"},{value:"contact",label:"Contact",description:"Filter by contact person",icon:"user",type:"link"},{value:"lead",label:"Lead",description:"Filter by associated lead",icon:"user-plus",type:"link"},{value:"project",label:"Project",description:"Filter by project",icon:"folder",type:"link"},{value:"company",label:"Company",description:"Filter by company",icon:"building",type:"link"},{value:"service_level_agreement",label:"Service Level Agreement",description:"Filter by SLA",icon:"clock",type:"link"},{value:"agreement_status",label:"SLA Status",description:"Filter by SLA status",icon:"check-circle",type:"select"},{value:"response_by",label:"Response By",description:"Filter by response deadline",icon:"clock",type:"datetime"},{value:"sla_resolution_by",label:"Resolution By",description:"Filter by resolution deadline",icon:"clock",type:"datetime"},{value:"custom_assigned_csm_team",label:"Assigned CSM Team",description:"Filter by assigned CSM team",icon:"users",type:"link"},{value:"custom_users_assigned",label:"Users Assigned",description:"Filter by assigned users",icon:"user-check",type:"multiselect"},{value:"custom_labels",label:"Labels",description:"Filter by issue labels",icon:"tag",type:"multiselect"},{value:"creation",label:"Created Date",description:"Filter by creation date",icon:"calendar",type:"date"},{value:"modified",label:"Modified Date",description:"Filter by last modified date",icon:"clock",type:"date"},{value:"opening_date",label:"Opening Date",description:"Filter by opening date",icon:"calendar",type:"date"},{value:"opening_time",label:"Opening Time",description:"Filter by opening time",icon:"clock",type:"time"},{value:"sla_resolution_date",label:"Resolution Date",description:"Filter by resolution date",icon:"calendar",type:"datetime"},{value:"first_responded_on",label:"First Responded On",description:"Filter by first response date",icon:"clock",type:"datetime"},{value:"first_response_time",label:"First Response Time",description:"Filter by first response time",icon:"clock",type:"duration"},{value:"avg_response_time",label:"Average Response Time",description:"Filter by average response time",icon:"clock",type:"duration"},{value:"resolution_time",label:"Resolution Time",description:"Filter by resolution time",icon:"clock",type:"duration"},{value:"user_resolution_time",label:"User Resolution Time",description:"Filter by user resolution time",icon:"clock",type:"duration"},{value:"total_hold_time",label:"Total Hold Time",description:"Filter by total hold time",icon:"pause",type:"duration"},{value:"via_customer_portal",label:"Via Customer Portal",description:"Filter by customer portal origin",icon:"globe",type:"boolean"},{value:"naming_series",label:"Series",description:"Filter by naming series",icon:"hash",type:"text"},{value:"email_account",label:"Email Account",description:"Filter by email account",icon:"mail",type:"link"},{value:"issue_split_from",label:"Issue Split From",description:"Filter by parent issue",icon:"git-branch",type:"link"},{value:"_user_tags",label:"Tags",description:"Filter by user tags",icon:"tag",type:"tags"}]),E=F(()=>[{label:"Created Date (Newest)",value:"creation desc"},{label:"Created Date (Oldest)",value:"creation asc"},{label:"Modified Date (Newest)",value:"modified desc"},{label:"Modified Date (Oldest)",value:"modified asc"},{label:"Subject (A-Z)",value:"subject asc"},{label:"Subject (Z-A)",value:"subject desc"},{label:"Priority",value:"priority asc"},{label:"Status",value:"status asc"}]);ne(()=>t.searchQuery,_=>{m.value=_}),ne(()=>t.filters,_=>{l.value=oe({},_)},{deep:!0});const S=_=>{(_.ctrlKey||_.metaKey)&&_.key==="k"&&(_.preventDefault(),f())},f=()=>{d.value&&(d.value.focus(),d.value.select())},x=_=>{m.value=_,a("update:searchQuery",_)},p=_=>{a("suggestion-selected",_)};F(()=>{let _=0;return l.value.status&&_++,l.value.priority&&_++,l.value.assignee&&_++,l.value.tags&&_++,l.value.sortBy!=="creation desc"&&_++,_}),F(()=>{const _=[];if(l.value.status){const e=t.statusOptions.find(i=>i.value===l.value.status);_.push({key:"status",label:"Status",value:(e==null?void 0:e.label)||l.value.status,colorClass:"bg-green-100 text-green-800 border-green-200"})}if(l.value.priority){const e=t.priorityOptions.find(i=>i.value===l.value.priority);_.push({key:"priority",label:"Priority",value:(e==null?void 0:e.label)||l.value.priority,colorClass:"bg-orange-100 text-orange-800 border-orange-200"})}if(l.value.assignee){const e=t.assigneeOptions.find(i=>i.value===l.value.assignee);_.push({key:"assignee",label:"Assignee",value:(e==null?void 0:e.label)||l.value.assignee,colorClass:"bg-blue-100 text-blue-800 border-blue-200"})}if(l.value.tags){const e=t.tagsOptions.find(i=>i.value===l.value.tags);_.push({key:"tags",label:"Tags",value:(e==null?void 0:e.label)||l.value.tags,colorClass:"bg-purple-100 text-purple-800 border-purple-200"})}if(l.value.sortBy!=="creation desc"){const e=E.value.find(i=>i.value===l.value.sortBy);_.push({key:"sortBy",label:"Sort",value:(e==null?void 0:e.label)||l.value.sortBy,colorClass:"bg-indigo-100 text-indigo-800 border-indigo-200"})}return _});const k=_=>{const e=I.value.find(P=>P.value===_);if(!e)return;const i={id:++w,field:_,operator:L(_),value:"",type:e.type};c.value.push(i),b.value=!1,B()},h=_=>{c.value.splice(_,1),B()},R=()=>{c.value=[],B()},U=_=>{B()},B=()=>{const _={};c.value.forEach(e=>{if(e.value){const i=e.field==="issue_type"?"tags":e.field==="raised_by"?"assignee":e.field;e.operator==="equals"||e.operator==="contains"?_[i]=e.value:e.operator==="not_equals"&&(_[i]=`!${e.value}`)}}),l.value=oe(oe({},l.value),_),a("update:filters",oe({},l.value))},D=_=>{const e=I.value.find(i=>i.value===_);return(e==null?void 0:e.label)||_},L=_=>{const e=I.value.find(i=>i.value===_);return(e==null?void 0:e.type)==="select"?"equals":(e==null?void 0:e.type)==="text"?"like":(e==null?void 0:e.type)==="date"||(e==null?void 0:e.type)==="datetime"||(e==null?void 0:e.type)==="time"||(e==null?void 0:e.type)==="duration"||(e==null?void 0:e.type)==="boolean"||(e==null?void 0:e.type)==="link"?"equals":(e==null?void 0:e.type)==="multiselect"||(e==null?void 0:e.type)==="tags"?"like":"equals"},H=_=>{const e=I.value.find(i=>i.value===_);return(e==null?void 0:e.type)==="select"?[{label:"Equals",value:"equals"},{label:"Not Equals",value:"not_equals"},{label:"In",value:"in"},{label:"Not In",value:"not_in"}]:(e==null?void 0:e.type)==="text"?[{label:"Like",value:"like"},{label:"Equals",value:"equals"},{label:"Not Equals",value:"not_equals"},{label:"Starts with",value:"starts_with"},{label:"Ends with",value:"ends_with"},{label:"Is Set",value:"is_set"},{label:"Is Not Set",value:"is_not_set"}]:(e==null?void 0:e.type)==="date"||(e==null?void 0:e.type)==="datetime"?[{label:"Equals",value:"equals"},{label:"Not Equals",value:"not_equals"},{label:"Greater than",value:"greater_than"},{label:"Less than",value:"less_than"},{label:"Greater than or equal",value:"greater_than_equal"},{label:"Less than or equal",value:"less_than_equal"},{label:"Between",value:"between"},{label:"Is Set",value:"is_set"},{label:"Is Not Set",value:"is_not_set"}]:(e==null?void 0:e.type)==="time"?[{label:"Equals",value:"equals"},{label:"Not Equals",value:"not_equals"},{label:"Greater than",value:"greater_than"},{label:"Less than",value:"less_than"}]:(e==null?void 0:e.type)==="duration"?[{label:"Equals",value:"equals"},{label:"Not Equals",value:"not_equals"},{label:"Greater than",value:"greater_than"},{label:"Less than",value:"less_than"},{label:"Is Set",value:"is_set"},{label:"Is Not Set",value:"is_not_set"}]:(e==null?void 0:e.type)==="boolean"?[{label:"Equals",value:"equals"},{label:"Not Equals",value:"not_equals"}]:(e==null?void 0:e.type)==="link"?[{label:"Equals",value:"equals"},{label:"Not Equals",value:"not_equals"},{label:"Like",value:"like"},{label:"In",value:"in"},{label:"Not In",value:"not_in"},{label:"Is Set",value:"is_set"},{label:"Is Not Set",value:"is_not_set"}]:(e==null?void 0:e.type)==="multiselect"||(e==null?void 0:e.type)==="tags"?[{label:"Like",value:"like"},{label:"Not Like",value:"not_like"},{label:"In",value:"in"},{label:"Not In",value:"not_in"},{label:"Is Set",value:"is_set"},{label:"Is Not Set",value:"is_not_set"}]:[{label:"Equals",value:"equals"}]},G=_=>{const e=I.value.find(i=>i.value===_);return(e==null?void 0:e.type)==="select"||(e==null?void 0:e.type)==="tags"},Z=_=>{switch(_){case"status":return t.statusOptions;case"priority":return t.priorityOptions;case"raised_by":return t.assigneeOptions;case"issue_type":return t.tagsOptions;case"_user_tags":return y.value;default:return[]}},V=_=>{var i,P,M;const e=I.value.find(Y=>Y.value===_);switch(_){case"subject":return"Enter issue title...";case"description":return"Enter description text...";case"raised_by":return"Enter email address...";case"customer_name":return"Enter customer name...";case"naming_series":return"Enter series (e.g., ISS-2025-)...";case"creation":case"modified":case"opening_date":case"sla_resolution_date":case"first_responded_on":return"YYYY-MM-DD or YYYY-MM-DD HH:MM:SS";case"response_by":case"sla_resolution_by":return"YYYY-MM-DD HH:MM:SS";case"opening_time":return"HH:MM:SS";case"first_response_time":case"avg_response_time":case"resolution_time":case"user_resolution_time":case"total_hold_time":return"Enter duration (e.g., 2:30:00 for 2h 30m)";case"customer":return"Enter customer name or ID...";case"contact":return"Enter contact name or ID...";case"lead":return"Enter lead name or ID...";case"project":return"Enter project name or ID...";case"company":return"Enter company name or ID...";case"service_level_agreement":return"Enter SLA name or ID...";case"custom_assigned_csm_team":return"Enter team name or ID...";case"email_account":return"Enter email account name...";case"issue_split_from":return"Enter parent issue ID...";case"via_customer_portal":return"Enter 1 for Yes, 0 for No";case"custom_users_assigned":return"Enter user names (comma separated)...";case"custom_labels":return"Enter labels (comma separated)...";case"_user_tags":return"Enter tags (comma separated)...";default:return(e==null?void 0:e.type)==="date"||(e==null?void 0:e.type)==="datetime"?"YYYY-MM-DD or YYYY-MM-DD HH:MM:SS":(e==null?void 0:e.type)==="time"?"HH:MM:SS":(e==null?void 0:e.type)==="duration"?"Enter duration (e.g., 2:30:00)":(e==null?void 0:e.type)==="boolean"?"Enter 1 for Yes, 0 for No":(e==null?void 0:e.type)==="link"?`Enter ${((i=e==null?void 0:e.label)==null?void 0:i.toLowerCase())||"value"} name or ID...`:(e==null?void 0:e.type)==="multiselect"||(e==null?void 0:e.type)==="tags"?`Enter ${((P=e==null?void 0:e.label)==null?void 0:P.toLowerCase())||"values"} (comma separated)...`:`Enter ${((M=e==null?void 0:e.label)==null?void 0:M.toLowerCase())||"value"}...`}},q=_=>{const e=De(_);if(e){const i=e.replace("#",""),P=parseInt(i.substr(0,2),16),M=parseInt(i.substr(2,2),16),Y=parseInt(i.substr(4,2),16),g=`rgba(${P}, ${M}, ${Y}, 0.1)`,C=`rgb(${Math.max(P-50,0)}, ${Math.max(M-50,0)}, ${Math.max(Y-50,0)})`;return{backgroundColor:g,color:C,borderColor:C}}return{backgroundColor:"#f3f4f6",color:"#374151",borderColor:"#d1d5db"}},ee=()=>{B(),b.value=!1};return $e(()=>{document.addEventListener("keydown",S)}),Fe(()=>{document.removeEventListener("keydown",S)}),(_,e)=>(n(),u("div",Ds,[o("div",js,[o("div",Os,[N(Ms,{ref_key:"searchBoxRef",ref:d,"model-value":m.value,"onUpdate:modelValue":x,onSuggestionSelected:p,issues:r.issues,placeholder:"Search issues by title, description, assignee...",class:"awesome-search"},null,8,["model-value","issues"]),m.value?(n(),u("div",As," Searching in "+$(r.filteredCount)+" issues ",1)):O("",!0)])]),o("div",Bs,[o("div",Ns,[o("div",Us,[o("button",{onClick:e[0]||(e[0]=i=>b.value=!b.value),class:"inline-flex items-center space-x-2 px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-md text-sm font-medium text-gray-700 transition-colors"},[e[2]||(e[2]=o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.414A1 1 0 013 6.707V4z"})],-1)),e[3]||(e[3]=o("span",null,"Filters",-1)),c.value.length>0?(n(),u("span",zs,$(c.value.length),1)):O("",!0)]),c.value.length>0?(n(),u("div",Hs,[(n(!0),u(Q,null,X(c.value,(i,P)=>(n(),u("div",{key:i.id,class:"flex items-center space-x-1 bg-gray-100 rounded px-2 py-1 text-sm whitespace-nowrap"},[o("span",Vs,$(D(i.field)),1),o("span",qs,$(i.operator),1),i.field==="_user_tags"&&i.value?(n(),u("span",{key:0,style:ce(q(i.value)),class:"inline-flex items-center px-2 py-0.5 text-xs font-medium rounded-full border"},$(i.value),5)):(n(),u("span",Ys,$(i.value),1)),o("button",{onClick:M=>h(P),class:"text-gray-400 hover:text-red-600 ml-1"},e[4]||(e[4]=[o("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Ks)]))),128))])):O("",!0)]),c.value.length>0?(n(),u("div",Ws,[o("button",{onClick:R,class:"px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors"}," Clear Filters "),o("button",{onClick:ee,class:"px-4 py-2 bg-gray-900 text-white text-sm font-medium rounded-md hover:bg-gray-800 transition-colors"}," Apply Filters ")])):O("",!0)])]),b.value?(n(),u("div",Qs,[o("div",Gs,[o("div",Js,[o("div",Xs,[e[5]||(e[5]=o("div",{class:"p-3 border-b border-gray-200"},[o("h4",{class:"text-sm font-medium text-gray-900"},"Add Filter")],-1)),o("div",Zs,[(n(!0),u(Q,null,X(I.value,i=>(n(),u("button",{key:i.value,onClick:P=>k(i.value),class:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors"},$(i.label),9,er))),128))])]),o("div",tr,[o("div",sr,[c.value.length===0?(n(),u("div",rr,e[6]||(e[6]=[o("p",{class:"text-sm"},"Select a field from the left to add a filter",-1)]))):(n(),u("div",or,[(n(!0),u(Q,null,X(c.value,(i,P)=>(n(),u("div",{key:i.id,class:"flex items-center space-x-3 p-3 bg-gray-50 rounded border"},[o("div",ar,$(D(i.field)),1),o("div",lr,[he(o("select",{"onUpdate:modelValue":M=>i.operator=M,onChange:M=>U(),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},[(n(!0),u(Q,null,X(H(i.field),M=>(n(),u("option",{key:M.value,value:M.value},$(M.label),9,ir))),128))],40,nr),[[Ee,i.operator]])]),o("div",ur,[i.field==="_user_tags"?(n(),u("div",cr,[he(o("select",{"onUpdate:modelValue":M=>i.value=M,onChange:M=>U(),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},[e[7]||(e[7]=o("option",{value:""},"Select tag...",-1)),(n(!0),u(Q,null,X(y.value,M=>(n(),u("option",{key:M.value,value:M.value},$(M.label),9,pr))),128))],40,dr),[[Ee,i.value]]),i.value?(n(),u("div",gr,[o("span",{style:ce(q(i.value)),class:"inline-flex items-center px-2 py-0.5 text-xs font-medium rounded-full border"},$(i.value),5)])):O("",!0)])):G(i.field)?he((n(),u("select",{key:1,"onUpdate:modelValue":M=>i.value=M,onChange:M=>U(),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},[e[8]||(e[8]=o("option",{value:""},"Select...",-1)),(n(!0),u(Q,null,X(Z(i.field),M=>(n(),u("option",{key:M.value,value:M.value},$(M.label),9,vr))),128))],40,mr)),[[Ee,i.value]]):he((n(),u("input",{key:2,"onUpdate:modelValue":M=>i.value=M,onInput:M=>U(),type:"text",placeholder:V(i.field),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},null,40,fr)),[[Je,i.value]])]),o("button",{onClick:M=>h(P),class:"p-1 text-gray-400 hover:text-red-600 transition-colors"},e[9]||(e[9]=[o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,yr)]))),128))])),c.value.length>0?(n(),u("div",br,[o("button",{onClick:R,class:"text-sm text-gray-600 hover:text-gray-900 transition-colors"}," Clear Filters "),o("button",{onClick:ee,class:"px-4 py-2 bg-gray-900 text-white text-sm font-medium rounded hover:bg-gray-800 transition-colors"}," Apply Filters ")])):O("",!0)])])])]),o("div",{class:"fixed inset-0 z-40",onClick:e[1]||(e[1]=i=>b.value=!1)})])):O("",!0)]))}},_r=Se(hr,[["__scopeId","data-v-0a7d2720"]]),xr={class:"bg-white rounded-lg shadow-sm border mt-4"},wr={class:"px-6 py-4 flex items-center justify-between"},kr={class:"text-sm text-gray-700"},Cr={key:0},Sr={key:1},$r={key:0,class:"flex items-center space-x-2"},Ir={class:"flex items-center space-x-1"},Pr={key:1,class:"px-2 text-gray-500"},Tr={key:2,class:"px-2 text-gray-500"},Rr={key:1,class:"flex items-center space-x-2"},Fr={__name:"IssuePagination",props:{currentPage:{type:Number,default:1},totalItems:{type:Number,default:0},itemsPerPage:{type:Number,default:10},showItemsPerPage:{type:Boolean,default:!0},maxVisiblePages:{type:Number,default:5}},emits:["update:currentPage","update:itemsPerPage","pageChange"],setup(r,{emit:s}){const t=r,a=s,m=A(t.itemsPerPage);ne(()=>t.itemsPerPage,h=>{m.value=h});const l=F(()=>Math.ceil(t.totalItems/t.itemsPerPage)),d=F(()=>t.totalItems===0?0:(t.currentPage-1)*t.itemsPerPage+1),b=F(()=>{const h=t.currentPage*t.itemsPerPage;return Math.min(h,t.totalItems)}),c=F(()=>{const h=[],R=t.maxVisiblePages,U=t.currentPage,B=l.value;if(B<=R)for(let D=1;D<=B;D++)h.push(D);else{let D=Math.max(1,U-Math.floor(R/2)),L=Math.min(B,D+R-1);L-D+1<R&&(D=Math.max(1,L-R+1)),D>1&&(D=Math.max(2,D)),L<B&&(L=Math.min(B-1,L));for(let H=D;H<=L;H++)h.push(H)}return h}),w=F(()=>l.value>t.maxVisiblePages&&!c.value.includes(1)),y=F(()=>l.value>t.maxVisiblePages&&!c.value.includes(l.value)),I=F(()=>w.value&&c.value.length>0&&c.value[0]>2),E=F(()=>y.value&&c.value.length>0&&c.value[c.value.length-1]<l.value-1),S=F(()=>[{label:"5",value:5},{label:"10",value:10},{label:"20",value:20},{label:"50",value:50},{label:"100",value:100}]),f=h=>{h>=1&&h<=l.value&&h!==t.currentPage&&(a("update:currentPage",h),a("pageChange",{page:h,itemsPerPage:t.itemsPerPage,offset:(h-1)*t.itemsPerPage}))},x=()=>{t.currentPage>1&&f(t.currentPage-1)},p=()=>{t.currentPage<l.value&&f(t.currentPage+1)},k=()=>{const h=m.value;a("update:itemsPerPage",h);const R=(t.currentPage-1)*t.itemsPerPage+1,U=Math.ceil(R/h);a("pageChange",{page:U,itemsPerPage:h,offset:(U-1)*h})};return(h,R)=>(n(),u("div",xr,[o("div",wr,[o("div",kr,[r.totalItems>0?(n(),u("span",Cr," Showing "+$(d.value)+" to "+$(b.value)+" of "+$(r.totalItems)+" results ",1)):(n(),u("span",Sr," No results found "))]),l.value>1?(n(),u("div",$r,[N(v(le),{theme:"gray",variant:"outline",size:"sm",disabled:r.currentPage===1,onClick:x},{prefix:K(()=>[N(v(ye),{name:"chevron-left",class:"h-4 w-4"})]),default:K(()=>[R[3]||(R[3]=te(" Previous "))]),_:1,__:[3]},8,["disabled"]),o("div",Ir,[w.value?(n(),W(v(le),{key:0,theme:"gray",variant:"outline",size:"sm",class:z({"bg-blue-50 text-blue-600 border-blue-200":r.currentPage===1}),onClick:R[0]||(R[0]=U=>f(1))},{default:K(()=>R[4]||(R[4]=[te(" 1 ")])),_:1,__:[4]},8,["class"])):O("",!0),I.value?(n(),u("span",Pr,"...")):O("",!0),(n(!0),u(Q,null,X(c.value,U=>(n(),W(v(le),{key:U,theme:"gray",variant:"outline",size:"sm",class:z({"bg-blue-50 text-blue-600 border-blue-200":r.currentPage===U}),onClick:B=>f(U)},{default:K(()=>[te($(U),1)]),_:2},1032,["class","onClick"]))),128)),E.value?(n(),u("span",Tr,"...")):O("",!0),y.value?(n(),W(v(le),{key:3,theme:"gray",variant:"outline",size:"sm",class:z({"bg-blue-50 text-blue-600 border-blue-200":r.currentPage===l.value}),onClick:R[1]||(R[1]=U=>f(l.value))},{default:K(()=>[te($(l.value),1)]),_:1},8,["class"])):O("",!0)]),N(v(le),{theme:"gray",variant:"outline",size:"sm",disabled:r.currentPage===l.value,onClick:p},{suffix:K(()=>[N(v(ye),{name:"chevron-right",class:"h-4 w-4"})]),default:K(()=>[R[5]||(R[5]=te(" Next "))]),_:1,__:[5]},8,["disabled"])])):O("",!0),r.showItemsPerPage?(n(),u("div",Rr,[R[6]||(R[6]=o("span",{class:"text-sm text-gray-700"},"Items per page:",-1)),N(v(_t),{modelValue:m.value,"onUpdate:modelValue":R[2]||(R[2]=U=>m.value=U),options:S.value,onChange:k,class:"w-20"},null,8,["modelValue","options"])])):O("",!0)])]))}},Er={class:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-8"},Lr={class:"text-3xl font-bold text-gray-900"},Mr={class:"text-3xl font-bold text-blue-600"},Dr={class:"text-3xl font-bold text-green-600"},jr={class:"text-3xl font-bold text-orange-600"},Or={class:"text-3xl font-bold text-purple-600"},Ar=3e4,Br={__name:"IssueStats",props:{issues:{type:Array,default:()=>[]},activeFilter:{type:String,default:"team_tickets"}},emits:["filter-changed"],setup(r,{expose:s,emit:t}){const a=r,m=t,l=be({team_tickets:0,open_tickets:0,assigned_to_me:0,actionable_tickets:0,response_tickets:0}),d=F(()=>l.value.team_tickets),b=F(()=>l.value.open_tickets),c=F(()=>l.value.assigned_to_me),w=F(()=>l.value.actionable_tickets),y=F(()=>l.value.response_tickets);let I=null,E=0;const S=()=>pe(this,null,function*(){const k=Date.now();if(I&&k-E<Ar)return I;try{const h=yield Xt("force_trans_customization.api.issues.get_issue_stats");return l.value=h,I=h,E=k,h}catch(h){return console.error("Error fetching issue stats:",h),l.value}});let f=null;const x=()=>{f&&clearTimeout(f),f=setTimeout(()=>{S()},500)};$e(()=>{S()}),ne(()=>a.issues.length,()=>{x()});const p=k=>{m("filter-changed",k)};return s({refreshStats:S}),(k,h)=>(n(),u("div",Er,[o("div",{onClick:h[0]||(h[0]=R=>p("team_tickets")),class:z(["bg-white p-6 rounded-lg shadow-sm border cursor-pointer transition-all duration-200 hover:shadow-md",r.activeFilter==="team_tickets"?"ring-2 ring-gray-500 bg-gray-50":"hover:bg-gray-50"])},[o("div",Lr,$(d.value),1),h[5]||(h[5]=o("div",{class:"text-sm text-gray-600 mt-1"},"Team Tickets",-1))],2),o("div",{onClick:h[1]||(h[1]=R=>p("open_tickets")),class:z(["bg-white p-6 rounded-lg shadow-sm border cursor-pointer transition-all duration-200 hover:shadow-md",r.activeFilter==="open_tickets"?"ring-2 ring-blue-500 bg-blue-50":"hover:bg-blue-50"])},[o("div",Mr,$(b.value),1),h[6]||(h[6]=o("div",{class:"text-sm text-gray-600 mt-1"},"Open Tickets",-1))],2),o("div",{onClick:h[2]||(h[2]=R=>p("assigned_to_me")),class:z(["bg-white p-6 rounded-lg shadow-sm border cursor-pointer transition-all duration-200 hover:shadow-md",r.activeFilter==="assigned_to_me"?"ring-2 ring-green-500 bg-green-50":"hover:bg-green-50"])},[o("div",Dr,$(c.value),1),h[7]||(h[7]=o("div",{class:"text-sm text-gray-600 mt-1"},"Assigned To Me",-1))],2),o("div",{onClick:h[3]||(h[3]=R=>p("actionable_tickets")),class:z(["bg-white p-6 rounded-lg shadow-sm border cursor-pointer transition-all duration-200 hover:shadow-md",r.activeFilter==="actionable_tickets"?"ring-2 ring-orange-500 bg-orange-50":"hover:bg-orange-50"])},[o("div",jr,$(w.value),1),h[8]||(h[8]=o("div",{class:"text-sm text-gray-600 mt-1"},"Actionable",-1))],2),o("div",{onClick:h[4]||(h[4]=R=>p("response_tickets")),class:z(["bg-white p-6 rounded-lg shadow-sm border cursor-pointer transition-all duration-200 hover:shadow-md",r.activeFilter==="response_tickets"?"ring-2 ring-purple-500 bg-purple-50":"hover:bg-purple-50"])},[o("div",Or,$(y.value),1),h[9]||(h[9]=o("div",{class:"text-sm text-gray-600 mt-1"},"Response",-1))],2)]))}},Nr={props:["status"],template:`
    <Badge :label="displayStatus" :theme="statusTheme" variant="subtle" />
  `,computed:{displayStatus(){return this.status||"New"},statusTheme(){const r=this.status||"New";return{New:"blue","In Review":"orange","Waiting on Customer":"yellow",Confirmed:"purple","In Transit":"blue","In Transit Unmanaged":"gray",Delivered:"green",Closed:"green",Open:"red",Replied:"orange","On Hold":"yellow",Resolved:"green"}[r]||"gray"}},components:{Badge:Oe}},Ur={props:["priority"],template:`
    <div class="flex items-center gap-2">
      <div :class="priorityIndicatorClass" class="w-2 h-2 rounded-full"></div>
      <Badge :label="displayPriority" :theme="priorityTheme" variant="subtle" />
    </div>
  `,computed:{displayPriority(){return this.priority||"Medium"},priorityTheme(){const r=this.priority||"Medium";return{Critical:"red",High:"red",Medium:"yellow",Low:"green"}[r]||"yellow"},priorityIndicatorClass(){const r=this.priority||"Medium";return{"bg-red-500":r==="Critical","bg-red-400":r==="High","bg-yellow-400":r==="Medium","bg-green-400":r==="Low"}}},components:{Badge:Oe}},zr={components:{ListView:Jt,Avatar:St,Badge:Oe,Button:le,FeatherIcon:ye,ListHeader:et,ListHeaderItem:Ze,ListRow:Be,ListRowItem:tt,ListRows:st,ListSelectBanner:rt,StatusBadge:Nr,PriorityBadge:Ur},props:{issues:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},sortField:{type:String,default:"creation"},sortDirection:{type:String,default:"desc"}},emits:["sort"],setup(r,{emit:s}){const t=A(!1),a=A(null),m=A({x:0,y:0}),l=A(!1),d=A({x:0,y:0}),b=A(null),c=g=>{if(!g||typeof g!="string")return"?";if(g.includes("@")){const C=g.split("@")[0];return C.includes(".")||C.includes("_")?C.split(/[._]/).map(j=>j[0]).join("").toUpperCase().slice(0,2):C.slice(0,2).toUpperCase()}return g.includes(" ")?g.split(" ").map(C=>C[0]).join("").toUpperCase().slice(0,2):g.slice(0,2).toUpperCase()},w=g=>{if(!g)return"";const C=g.match(/ISS-(\d{4}-\d+)/);return C?C[1]:g},y=g=>{if(!g)return"";const C=document.createElement("div");return C.innerHTML=g,C.textContent||C.innerText||""},I=g=>g?new Date(g).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-",E=g=>g?new Date(g).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",S=g=>({New:"blue","In Review":"orange","Waiting on Customer":"yellow",Confirmed:"purple","In Transit":"blue","In Transit Unmanaged":"gray",Delivered:"green",Closed:"green",Open:"red",Replied:"orange","On Hold":"yellow",Resolved:"green"})[g]||"gray",f=g=>({Critical:"red",High:"red",Medium:"yellow",Low:"green"})[g]||"yellow",x=new Map,p=F(()=>r.issues.map(g=>{const C=g.name;if(x.has(C)){const j=x.get(C);if(j.originalStatus===g.status&&j.originalPriority===g.priority&&j.originalSubject===g.subject&&j.originalUsersAssigned===JSON.stringify(g.custom_users_assigned))return j.transformed}const T=Ve(oe({},g),{status:{label:g.status||"New",color:S(g.status)},priority:{label:g.priority||"Medium",color:f(g.priority)}});return x.set(C,{transformed:T,originalStatus:g.status,originalPriority:g.priority,originalSubject:g.subject,originalUsersAssigned:JSON.stringify(g.custom_users_assigned)}),T})),k=be([{label:"Issue ID",key:"name",width:"110px",sortable:!0},{label:"Title",key:"subject",width:4,sortable:!0},{label:"Status",key:"status",width:"160px",sortable:!0},{label:"Assignee",key:"raised_by",width:"150px",sortable:!0},{label:"Assigned Users",key:"custom_users_assigned",width:"180px",sortable:!1},{label:"Tags",key:"_user_tags",width:"120px",sortable:!1},{label:"Created At",key:"creation",width:"120px",sortable:!0}]),h=be({showTooltip:!0,selectable:!0,resizeColumn:!1,rowHeight:60,emptyState:{title:"No issues found",description:"Try adjusting your search or filter criteria"},onRowClick:g=>{console.log("Row clicked:",g)}}),R=g=>{console.log("Selected rows:",g)},U=g=>{console.log("Issue clicked:",g);const T=`${window.location.origin}/app/issue/${g.name}`;window.open(T,"_blank")},B=g=>{const C=g||"New";return{"bg-blue-500":C==="New","bg-orange-500":C==="In Review","bg-yellow-500":C==="Waiting on Customer","bg-purple-500":C==="Confirmed","bg-blue-500":C==="In Transit","bg-gray-500":C==="In Transit Unmanaged","bg-green-500":C==="Delivered","bg-green-500":C==="Closed","bg-red-500":C==="Open","bg-orange-500":C==="Replied","bg-yellow-500":C==="On Hold","bg-green-500":C==="Resolved"}},D=g=>{const C=g||"Medium";return{"bg-red-500":C==="Critical"||C==="High","bg-yellow-500":C==="Medium","bg-green-500":C==="Low"}},L=g=>({New:"bg-blue-100 text-blue-800","In Review":"bg-orange-100 text-orange-800","Waiting on Customer":"bg-yellow-100 text-yellow-800",Confirmed:"bg-purple-100 text-purple-800","In Transit":"bg-blue-100 text-blue-800","In Transit Unmanaged":"bg-gray-100 text-gray-800",Delivered:"bg-green-100 text-green-800",Closed:"bg-green-100 text-green-800",Open:"bg-red-100 text-red-800",Replied:"bg-orange-100 text-orange-800","On Hold":"bg-yellow-100 text-yellow-800",Resolved:"bg-green-100 text-green-800"})[g||"New"]||"bg-gray-100 text-gray-800",H=g=>({Critical:"bg-red-100 text-red-800",High:"bg-red-100 text-red-800",Medium:"bg-yellow-100 text-yellow-800",Low:"bg-green-100 text-green-800"})[g||"Medium"]||"bg-yellow-100 text-yellow-800",G=g=>{const C=g||"Medium";return{"bg-red-500":C==="Critical","bg-red-400":C==="High","bg-yellow-400":C==="Medium","bg-green-400":C==="Low"}},Z=(g,C)=>{const T=g.target.getBoundingClientRect();m.value={x:T.left+T.width/2,y:T.top-10},a.value=C,t.value=!0},V=()=>{t.value=!1,a.value=null},q=(g,C)=>{if(!C||C.length===0)return;const T=g.target.getBoundingClientRect();d.value={x:T.left+T.width/2,y:T.top-10},b.value=C,l.value=!0},ee=()=>{l.value=!1,b.value=null},_=g=>{let C="asc";r.sortField===g&&(C=r.sortDirection==="asc"?"desc":"asc"),s("sort",{field:g,direction:C})},e=g=>r.sortField!==g?"arrow-up-down":r.sortDirection==="asc"?"arrow-up":"arrow-down",i=g=>r.sortField!==g?"text-gray-400":"text-blue-600",P=g=>r.sortField===g?"bg-blue-50":"",M=new Map;return{columns:k,listOptions:h,transformedIssues:p,handleSelections:R,handleIssueClick:U,getStatusColor:B,getPriorityColor:D,getStatusBadgeClass:L,getPriorityBadgeClass:H,getPriorityIndicatorClass:G,getInitials:c,formatIssueId:w,stripHtml:y,formatDate:I,formatTime:E,showPopup:t,popupUser:a,popupPosition:m,showUserPopup:Z,hideUserPopup:V,handleColumnSort:_,getSortIcon:e,getSortIconClass:i,getSortButtonClass:P,getTagStyle:g=>{if(M.has(g))return M.get(g);const C=De(g);let T;if(C){const j=C.replace("#",""),se=parseInt(j.substr(0,2),16),re=parseInt(j.substr(2,2),16),Ne=parseInt(j.substr(4,2),16),nt=`rgba(${se}, ${re}, ${Ne}, 0.1)`,Ue=`rgb(${Math.max(se-50,0)}, ${Math.max(re-50,0)}, ${Math.max(Ne-50,0)})`;T={backgroundColor:nt,color:Ue,borderColor:Ue}}else T={backgroundColor:"#f3f4f6",color:"#374151",borderColor:"#d1d5db"};return M.set(g,T),T},showTagsPopup:l,tagsPopupPosition:d,tagsPopupData:b,showTagsPopupFn:q,hideTagsPopupFn:ee}}},Hr={class:"bg-white rounded-lg shadow-sm border"},Vr={key:0,class:"px-6 py-12 text-center text-gray-500"},qr=["onClick"],Yr=["onClick"],Kr={key:1,class:"max-w-xs"},Wr=["title"],Qr=["title"],Gr=["title"],Jr={key:3,class:"flex flex-wrap gap-1"},Xr=["onMouseenter"],Zr={key:1,class:"text-gray-400 text-sm"},eo=["onMouseenter"],to=["title"],so={class:"truncate"},ro={key:0,class:"inline-flex items-center px-1 py-1 text-xs font-medium text-gray-500"},oo={key:1,class:"text-gray-400 text-sm"},ao={key:5,class:"flex flex-col"},lo={class:"text-xs text-gray-400"},no={key:7},io={class:"flex gap-2"},uo={class:"text-sm"},co={class:"font-semibold text-gray-900 mb-1"},po={class:"text-gray-600 flex items-center gap-1"},go={class:"text-xs text-gray-500 mt-1"},mo={class:"text-sm"},vo={class:"flex flex-wrap gap-1"};function fo(r,s,t,a,m,l){const d=ae("FeatherIcon"),b=ae("ListHeaderItem"),c=ae("ListHeader"),w=ae("Avatar"),y=ae("ListRowItem"),I=ae("ListRow"),E=ae("ListRows"),S=ae("Button"),f=ae("ListSelectBanner"),x=ae("ListView");return n(),u("div",Hr,[s[5]||(s[5]=o("div",{class:"px-6 py-4 border-b border-gray-200"},[o("h3",{class:"text-lg font-medium text-gray-900"},"Issues")],-1)),t.loading?(n(),u("div",Vr,s[2]||(s[2]=[o("div",{class:"flex items-center justify-center"},[o("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),o("span",{class:"ml-2"},"Loading issues...")],-1)]))):(n(),W(x,{key:1,columns:a.columns,rows:a.transformedIssues,"row-key":"name",options:a.listOptions,"onUpdate:selections":a.handleSelections},{default:K(()=>[N(c,null,{default:K(()=>[(n(!0),u(Q,null,X(a.columns,p=>(n(),W(b,{key:p.key,item:p},xt({_:2},[p.icon?{name:"prefix",fn:K(({item:k})=>[N(d,{name:k.icon,class:"h-4 w-4"},null,8,["name"])]),key:"0"}:void 0,p.sortable?{name:"suffix",fn:K(()=>[o("button",{onClick:k=>a.handleColumnSort(p.key),class:z(["ml-2 p-1 rounded hover:bg-gray-100 transition-colors",a.getSortButtonClass(p.key)])},[N(d,{name:a.getSortIcon(p.key),class:z(["h-3 w-3",a.getSortIconClass(p.key)])},null,8,["name","class"])],10,qr)]),key:"1"}:void 0]),1032,["item"]))),128))]),_:1}),N(E,null,{default:K(()=>[(n(!0),u(Q,null,X(a.transformedIssues,p=>(n(),W(I,{key:p.name,row:p},{default:K(({column:k,item:h})=>[N(y,{item:h,align:k.align},{prefix:K(()=>[k.key==="raised_by"?(n(),W(w,{key:0,size:"sm",label:a.getInitials(p.raised_by),class:"mr-3"},null,8,["label"])):O("",!0)]),default:K(()=>{var R,U;return[k.key==="name"?(n(),u("a",{key:0,href:"#",class:"text-blue-600 hover:text-blue-800 hover:underline font-medium",onClick:_e(B=>a.handleIssueClick(p),["prevent"])},$(a.formatIssueId(h)),9,Yr)):k.key==="subject"?(n(),u("div",Kr,[o("div",{class:"font-medium truncate",title:p.subject},$(p.subject),9,Wr),p.description?(n(),u("div",{key:0,class:"text-gray-500 text-xs mt-1 truncate",title:p.description},$(a.stripHtml(p.description)),9,Qr)):O("",!0)])):k.key==="raised_by"?(n(),u("span",{key:2,class:"text-sm font-medium text-gray-900 truncate block",title:h||"-"},$(h||"-"),9,Gr)):k.key==="custom_users_assigned"?(n(),u("div",Jr,[p.custom_users_assigned&&p.custom_users_assigned.length>0?(n(!0),u(Q,{key:0},X(p.custom_users_assigned.filter(B=>B.user_assigned),B=>(n(),u("div",{key:B.name||B,class:"relative inline-block"},[o("span",{class:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800 cursor-pointer hover:bg-blue-200 transition-colors",onMouseenter:D=>a.showUserPopup(D,B),onMouseleave:s[0]||(s[0]=(...D)=>a.hideUserPopup&&a.hideUserPopup(...D))},$(a.getInitials(B.user_assigned)),41,Xr)]))),128)):(n(),u("span",Zr,"-"))])):k.key==="_user_tags"?(n(),u("div",{key:4,class:"flex items-center gap-1 cursor-pointer hover:bg-gray-50 p-1 rounded transition-colors",onMouseenter:B=>a.showTagsPopupFn(B,p._user_tags),onMouseleave:s[1]||(s[1]=(...B)=>a.hideTagsPopupFn&&a.hideTagsPopupFn(...B))},[p._user_tags&&p._user_tags.length>0?(n(),u(Q,{key:0},[o("span",{style:ce(a.getTagStyle(p._user_tags[0])),class:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full border transition-colors max-w-16",title:p._user_tags[0]},[o("span",so,$(p._user_tags[0]),1)],12,to),p._user_tags.length>1?(n(),u("span",ro," +"+$(p._user_tags.length-1),1)):O("",!0)],64)):(n(),u("span",oo,"-"))],40,eo)):k.key==="creation"?(n(),u("div",ao,[o("span",null,$(a.formatDate(h)),1),o("span",lo,$(a.formatTime(h)),1)])):k.key==="status"?(n(),u("span",{key:6,class:z([a.getStatusBadgeClass(((R=p.status)==null?void 0:R.label)||p.status||"New"),"inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},$(((U=p.status)==null?void 0:U.label)||p.status||"New"),3)):(n(),u("span",no,$(h),1))]}),_:2},1032,["item","align"])]),_:2},1032,["row"]))),128))]),_:1}),N(f,null,{actions:K(({unselectAll:p})=>[o("div",io,[N(S,{variant:"ghost",label:"Delete"}),N(S,{variant:"ghost",label:"Unselect all",onClick:p},null,8,["onClick"])])]),_:1})]),_:1},8,["columns","rows","options","onUpdate:selections"])),a.showPopup&&a.popupUser?(n(),u("div",{key:2,class:"fixed z-50 bg-white border border-gray-200 rounded-lg shadow-lg p-3 min-w-48",style:ce({left:a.popupPosition.x+"px",top:a.popupPosition.y+"px",transform:"translateX(-50%) translateY(-100%)"})},[o("div",uo,[o("div",co,$(a.popupUser.user_assigned||"Unknown User"),1),o("div",po,[s[3]||(s[3]=o("span",{class:"inline-block w-2 h-2 bg-blue-500 rounded-full"},null,-1)),te(" "+$(a.popupUser.team||"No Team"),1)]),o("div",go," Assigned: "+$(a.formatDate(a.popupUser.assigned_date)),1)])],4)):O("",!0),a.showTagsPopup&&a.tagsPopupData?(n(),u("div",{key:3,class:"fixed z-50 bg-white border border-gray-200 rounded-lg shadow-lg p-3 min-w-48 max-w-xs",style:ce({left:a.tagsPopupPosition.x+"px",top:a.tagsPopupPosition.y+"px",transform:"translateX(-50%) translateY(-100%)"})},[o("div",mo,[s[4]||(s[4]=o("div",{class:"font-semibold text-gray-900 mb-2"},"All Tags",-1)),o("div",vo,[(n(!0),u(Q,null,X(a.tagsPopupData,p=>(n(),u("span",{key:p,style:ce(a.getTagStyle(p)),class:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full border"},$(p),5))),128))])])],4)):O("",!0)])}const yo=Se(zr,[["render",fo]]),bo={class:"fixed top-4 right-4 z-50 space-y-2 max-w-sm"},ho={class:"flex items-start justify-between"},_o={class:"flex items-start space-x-3"},xo={class:"flex-shrink-0"},wo={class:"flex-1 min-w-0"},ko={class:"text-sm font-medium text-gray-900"},Co={class:"text-sm text-gray-600 mt-1"},So={class:"text-xs text-gray-500 mt-1"},$o=["onClick"],Io={__name:"RealTimeNotifications",props:{notifications:{type:Array,default:()=>[]}},emits:["remove"],setup(r){const s=l=>{const d="bg-white/95 border-l-4",b={success:"border-green-500",info:"border-blue-500",warning:"border-yellow-500",error:"border-red-500"};return`${d} ${b[l]||b.info}`},t=l=>{const d={success:"check-circle",info:"info",warning:"alert-triangle",error:"alert-circle"};return d[l]||d.info},a=l=>{const d={success:"text-green-500",info:"text-blue-500",warning:"text-yellow-500",error:"text-red-500"};return d[l]||d.info},m=l=>{const b=new Date-l,c=Math.floor(b/6e4);if(c<1)return"Just now";if(c<60)return`${c}m ago`;const w=Math.floor(c/60);return w<24?`${w}h ago`:l.toLocaleDateString()};return(l,d)=>(n(),u("div",bo,[N(wt,{name:"notification",tag:"div"},{default:K(()=>[(n(!0),u(Q,null,X(r.notifications,b=>(n(),u("div",{key:b.id,class:z([s(b.type),"p-4 rounded-lg shadow-lg border backdrop-blur-sm"])},[o("div",ho,[o("div",_o,[o("div",xo,[N(v(ye),{name:t(b.type),class:z([a(b.type),"h-5 w-5"])},null,8,["name","class"])]),o("div",wo,[o("p",ko,$(b.title),1),o("p",Co,$(b.message),1),o("p",So,$(m(b.timestamp)),1)])]),o("button",{onClick:c=>l.$emit("remove",b.id),class:"flex-shrink-0 ml-3 text-gray-400 hover:text-gray-600 focus:outline-none"},[N(v(ye),{name:"x",class:"h-4 w-4"})],8,$o)])],2))),128))]),_:1})]))}},Po=Se(Io,[["__scopeId","data-v-d57fd7d2"]]);function To(r,s){let t;return function(...m){const l=()=>{clearTimeout(t),r(...m)};clearTimeout(t),t=setTimeout(l,s)}}function Ro(){const r=A(""),s=A({status:"",priority:"",assignee:"",tags:"",sortBy:"creation desc"}),t=A(""),a=To(S=>{t.value=S},300);ne(r,S=>{a(S)});const m=F(()=>{const S={};return t.value.trim()&&(S.subject=["like",`%${t.value.trim()}%`]),s.value.status&&(S.status=s.value.status),s.value.priority&&(S.priority=s.value.priority),s.value.assignee&&(S.raised_by=s.value.assignee),s.value.tags&&(S.issue_type=s.value.tags),S}),l=F(()=>s.value.sortBy||"creation desc"),d=new Map,b=S=>{if(!S||!Array.isArray(S))return[];const f=JSON.stringify({issuesLength:S.length,searchQuery:r.value.trim(),status:s.value.status,priority:s.value.priority,assignee:s.value.assignee,tags:s.value.tags,sortBy:s.value.sortBy});if(d.has(f))return d.get(f);let x=[...S];if(r.value.trim()){const k=r.value.toLowerCase().trim();x=x.filter(h=>{const R=(h.subject||"").toLowerCase(),U=(h.description||"").toLowerCase();return R.includes(k)||U.includes(k)})}s.value.status&&(x=x.filter(k=>k.status===s.value.status)),s.value.priority&&(x=x.filter(k=>k.priority===s.value.priority)),s.value.assignee&&(x=x.filter(k=>k.raised_by===s.value.assignee)),s.value.tags&&(x=x.filter(k=>k.issue_type===s.value.tags));const p=me({Critical:4,High:3,Medium:2,Low:1});if(x.sort((k,h)=>{const[R,U]=s.value.sortBy.split(" "),B=k[R]||"",D=h[R]||"";let L=0;return R==="creation"||R==="modified"?L=new Date(B)-new Date(D):R==="priority"?L=(p[B]||0)-(p[D]||0):L=B.toString().localeCompare(D.toString()),U==="desc"?-L:L}),d.size>50){const k=d.keys().next().value;d.delete(k)}return d.set(f,x),x};let c=null,w=null;const y=S=>{if(!S||!Array.isArray(S))return me([{label:"All Assignees",value:""}]);const f=S.map(k=>k.raised_by).filter(k=>k&&k.trim()).sort().join("|");if(c&&w===f)return c;const x=[...new Set(S.map(k=>k.raised_by).filter(k=>k&&k.trim()))],p=me([{label:"All Assignees",value:""},...x.map(k=>({label:k,value:k}))]);return c=p,w=f,p},I=()=>{r.value="",t.value="",s.value={status:"",priority:"",assignee:"",tags:"",sortBy:"creation desc"}},E=F(()=>r.value.trim()!==""||s.value.status!==""||s.value.priority!==""||s.value.assignee!==""||s.value.tags!==""||s.value.sortBy!=="creation desc");return{searchQuery:r,filters:s,debouncedSearchQuery:t,apiFilters:m,sortOrder:l,hasActiveFilters:E,filterIssues:b,getAssigneeOptions:y,resetFilters:I}}function Fo(r,s){const t=kt(),a=A([]),m=A(!1),l=A(!1);let d=null;const b=l.value?15e3:2e3,c=()=>{d&&clearTimeout(d),d=setTimeout(()=>{I()},b)},w=()=>{if(!t||m.value)return;t.emit("doctype_subscribe","Issue"),t.off("list_update"),t.on("list_update",L=>{if((L==null?void 0:L.doctype)==="Issue"&&!x()){if(L.action==="insert"||L.action==="create"){console.log("📝 Skipping new issue creation update:",L.name);return}a.value.push(L),c()}}),["doctype_update","Issue_update","Issue_create","Issue_delete"].forEach(L=>{t.on(L,H=>{if((H==null?void 0:H.doctype)!=="Issue"||x())return;const G={doctype:"Issue",name:H.name,action:L.includes("create")?"insert":L.includes("delete")?"delete":"update",modified_by:H.modified_by||H.owner,timestamp:new Date().toISOString()};if(G.action==="insert"){console.log("📝 Skipping new issue creation update:",H.name);return}a.value.push(G),c()})}),m.value=!0},y=()=>{if(!t||!m.value)return;t.emit("doctype_unsubscribe","Issue"),t.off("list_update"),["doctype_update","Issue_update","Issue_create","Issue_delete"].forEach(L=>{t.off(L)}),m.value=!1},I=()=>pe(this,null,function*(){if(!a.value.length)return;const D=window.location.hash||window.location.pathname;if(!D.includes("issue-tracker")&&!D.includes("issues")){a.value=[],y();return}const L=[...new Set(a.value.map(G=>G.name))],H=L.length;a.value=[];try{yield E(L),window&&typeof window.dispatchEvent=="function"&&window.dispatchEvent(new CustomEvent("issueListUpdated",{detail:{count:H,documents:L}}))}catch(G){console.error("Error updating individual rows, falling back to full refresh:",G);try{yield we(),yield ke()}catch(Z){console.error("Error in fallback refresh:",Z)}}}),E=D=>pe(this,null,function*(){try{const{activeResource:L,currentData:H}=S();if(!H||!Array.isArray(H)){console.log("📋 No current data available, falling back to custom refresh"),s&&typeof s=="function"&&(yield s());return}let G={limit_page_length:10,limit_start:0,filters:{},order_by:"creation desc"};if(r&&typeof r=="function")try{const q=r();q&&(G=oe(oe({},G),q))}catch(q){console.warn("Error getting current parameters, using defaults:",q)}const Z=H.map(q=>q.name),V=D.filter(q=>Z.includes(q));if(V.length===0){console.log("📋 Updated issues not visible on current page, skipping grid update");return}console.log(`🔄 Updating ${V.length} visible issues:`,V),yield f(V,L,H)}catch(L){throw console.error("Error during targeted refresh:",L),s&&typeof s=="function"&&(yield s()),L}}),S=()=>ge.data&&Array.isArray(ge.data)&&ge.data.length>0?{activeResource:ge,currentData:ge.data,resourceType:"stat"}:{activeResource:Ce,currentData:Ce.data||[],resourceType:"main"},f=(D,L,H)=>pe(this,null,function*(){try{const Z=(yield Promise.all(D.map(V=>pe(this,null,function*(){try{return yield Zt(V),at.data}catch(q){return console.warn(`Failed to fetch updated issue ${V}:`,q),null}})))).filter(V=>V!==null);if(Z.length===0){console.warn("No valid updated issues fetched, falling back to custom refresh"),s&&typeof s=="function"&&(yield s());return}if(L.data&&Array.isArray(L.data))Z.forEach(V=>{const q=L.data.findIndex(ee=>ee.name===V.name);q!==-1&&Object.assign(L.data[q],V)});else{const V=[...H];Z.forEach(q=>{const ee=V.findIndex(_=>_.name===q.name);ee!==-1&&(V[ee]=q)}),L.data=V}console.log(`🎯 Successfully updated ${Z.length} issues in current view`)}catch(G){console.error("Error updating visible issues in place:",G),s&&typeof s=="function"&&(yield s())}}),x=()=>!!document.hidden,p=A(!1),k=()=>{document.hidden?p.value=!0:p.value&&(p.value=!1,console.log("🔄 Page came back into focus - refreshing Issue table"),a.value.length>0?(console.log(`📋 Processing ${a.value.length} pending updates`),I()):h())},h=()=>{a.value=[];try{s&&typeof s=="function"?s():(we(),ke())}catch(D){console.error("Error during manual refresh:",D)}},R=()=>{w()},U=()=>{m.value=!1},B=D=>{console.error("Socket connection error:",D),m.value=!1};return $e(()=>{t&&(t.on("connect",R),t.on("disconnect",U),t.on("connect_error",B),document.addEventListener("visibilitychange",k),t.connected&&w())}),Fe(()=>{t&&(t.off("connect",R),t.off("disconnect",U),t.off("connect_error",B)),document.removeEventListener("visibilitychange",k),y(),d&&clearTimeout(d)}),{pendingDocumentRefreshes:a,realtimeEventsSetup:m,setupRealtimeUpdates:w,disableRealtimeUpdates:y,manualRefresh:h,processDocumentRefreshes:I}}const Eo={class:"min-h-screen bg-gray-50"},Lo={class:"bg-white shadow-sm border-b"},Mo={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Do={class:"flex justify-between items-center py-4"},jo={class:"flex items-center space-x-4"},Oo={class:"flex space-x-4"},Ao={class:"flex items-center space-x-4"},Bo={class:"text-sm text-gray-600"},No={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Uo={class:"fixed top-20 right-4 flex flex-col space-y-2"},zo=["title"],Ho={class:"relative"},Vo={key:0,class:"absolute -top-2 -right-2 bg-orange-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-medium animate-bounce"},Ko={__name:"IssueTracker",setup(r){const{searchQuery:s,filters:t,debouncedSearchQuery:a,apiFilters:m,sortOrder:l,getAssigneeOptions:d}=Ro(),b=A(!1),c=A("team_tickets"),w=()=>{const T={limit_page_length:P.value,limit_start:(i.value-1)*P.value,order_by:l.value};b.value?(Re(c.value,T),Me(c.value)):(we(oe({filters:Y.value},T)),ke(Y.value))},{pendingDocumentRefreshes:y,realtimeEventsSetup:I,manualRefresh:E}=Fo(()=>({filters:Y.value,order_by:l.value,limit_page_length:P.value,limit_start:(i.value-1)*P.value}),w),S=()=>{w()},f=A([]),x=T=>{f.value.push(oe({id:Date.now()+Math.random()},T)),setTimeout(()=>{var j;p((j=f.value[f.value.length-1])==null?void 0:j.id)},5e3)},p=T=>{f.value=f.value.filter(j=>j.id!==T)},k=F(()=>b.value?ge.data||[]:Ce.data||[]),h=F(()=>b.value?lt.data||0:ot.data||0),R=F(()=>b.value?ge.loading:Ce.loading),U=F(()=>k.value),B=F(()=>(l.value||"creation desc").split(" ")[0]),D=F(()=>(l.value||"creation desc").split(" ")[1]||"desc"),L=({field:T,direction:j})=>{const se=`${T} ${j}`;t.value.sortBy=se},H=T=>{},G=T=>{b.value=!0,c.value=T,s.value="",i.value=1,Re(T,{limit_page_length:P.value,limit_start:0,order_by:l.value}),Me(T)},Z=be(me(ss())),V=be(me(rs())),q=be(me(as()));let ee=null,_=0;const e=F(()=>{const T=k.value.length;return ee&&_===T||(ee=me(d(k.value)),_=T),ee}),i=A(1),P=A(10),M=({page:T,itemsPerPage:j,offset:se})=>{i.value=T,P.value=j,b.value?Re(c.value,{limit_page_length:j,limit_start:se,order_by:l.value}):(we({filters:Y.value,order_by:l.value,limit_page_length:j,limit_start:se}),ke(Y.value))},Y=F(()=>{const T={};return t.value.status&&(T.status=t.value.status),t.value.priority&&(T.priority=t.value.priority),t.value.assignee&&(T.raised_by=t.value.assignee),t.value.tags&&(T.issue_type=t.value.tags),T});let g=null;return ne([Y,l],()=>{g&&clearTimeout(g),g=setTimeout(()=>{b.value&&(b.value=!1,c.value="team_tickets"),i.value=1,we({filters:Y.value,order_by:l.value,limit_page_length:P.value,limit_start:0}),ke(Y.value)},300)},{deep:!0}),$e(()=>{b.value=!0,c.value="team_tickets",Re("team_tickets",{limit_page_length:P.value,limit_start:0,order_by:l.value}),Me("team_tickets"),window.addEventListener("issueListUpdated",T=>{const{count:j,documents:se}=T.detail;x({type:"info",title:"List Updated",message:`${j} issue${j>1?"s":""} updated: ${se.slice(0,3).join(", ")}${se.length>3?"...":""}`,timestamp:new Date})})}),Fe(()=>{window.removeEventListener("issueListUpdated",()=>{})}),(T,j)=>{const se=ae("router-link");return n(),u("div",Eo,[o("div",Lo,[o("div",Mo,[o("div",Do,[o("div",jo,[j[7]||(j[7]=o("h1",{class:"text-2xl font-bold text-gray-900"},"Issue Tracker",-1)),o("nav",Oo,[N(se,{to:"/",class:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium"},{default:K(()=>j[5]||(j[5]=[te(" Home ")])),_:1,__:[5]}),N(se,{to:"/issue-tracker",class:"bg-blue-100 text-blue-700 px-3 py-2 rounded-md text-sm font-medium"},{default:K(()=>j[6]||(j[6]=[te(" Issues ")])),_:1,__:[6]})])]),o("div",Ao,[o("span",Bo,$(v(Ke).user),1),N(v(le),{onClick:j[0]||(j[0]=re=>v(Ke).logout.submit()),theme:"gray",variant:"outline",size:"sm"},{default:K(()=>j[8]||(j[8]=[te(" Logout ")])),_:1,__:[8]})])])])]),o("div",No,[N(Br,{issues:U.value,activeFilter:c.value,onFilterChanged:G},null,8,["issues","activeFilter"]),N(_r,{searchQuery:v(s),"onUpdate:searchQuery":j[1]||(j[1]=re=>Ye(s)?s.value=re:null),filters:v(t),"onUpdate:filters":j[2]||(j[2]=re=>Ye(t)?t.value=re:null),statusOptions:q.value,priorityOptions:Z.value,assigneeOptions:e.value,tagsOptions:V.value,issues:k.value,filteredCount:h.value,onSuggestionSelected:H},null,8,["searchQuery","filters","statusOptions","priorityOptions","assigneeOptions","tagsOptions","issues","filteredCount"]),N(yo,{issues:U.value,loading:R.value,sortField:B.value,sortDirection:D.value,onSort:L},null,8,["issues","loading","sortField","sortDirection"]),N(Fr,{currentPage:i.value,"onUpdate:currentPage":j[3]||(j[3]=re=>i.value=re),itemsPerPage:P.value,"onUpdate:itemsPerPage":j[4]||(j[4]=re=>P.value=re),totalItems:h.value,onPageChange:M},null,8,["currentPage","itemsPerPage","totalItems"]),o("div",Uo,[o("div",{class:"group relative bg-white rounded-full shadow-lg border p-2 hover:shadow-xl transition-all duration-200",title:v(I)?"Real-time updates active":"Real-time updates disabled"},[o("div",Ho,[N(v(ye),{name:v(I)?"wifi":"wifi-off",class:z(["h-5 w-5 transition-colors duration-200",v(I)?"text-green-600":"text-red-500"])},null,8,["name","class"]),o("div",{class:z(["absolute -top-1 -right-1 w-3 h-3 rounded-full border-2 border-white",v(I)?"bg-green-500 animate-pulse":"bg-red-500"])},null,2),v(y).length>0?(n(),u("div",Vo,$(v(y).length>9?"9+":v(y).length),1)):O("",!0)])],8,zo),o("button",{onClick:S,class:"group bg-white rounded-full shadow-lg border p-2 hover:shadow-xl hover:bg-blue-50 transition-all duration-200 active:scale-95",title:"Manual refresh"},[N(v(ye),{name:"refresh-cw",class:"h-5 w-5 text-gray-600 group-hover:text-blue-600 group-active:rotate-180 transition-all duration-300"})])])]),N(Po,{notifications:f.value,onRemove:p},null,8,["notifications"])])}}};export{Ko as default};
//# sourceMappingURL=IssueTracker-Dag3v5ku.js.map
