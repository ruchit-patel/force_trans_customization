{"version":3,"file":"SentEmails-g8xBurR4.js","sources":["../../../../frontend/src/pages/SentEmails.vue"],"sourcesContent":["<template>\n  <div class=\"h-full flex flex-col bg-gray-50\">\n    <!-- Header -->\n    <div class=\"bg-white border-b border-gray-200 px-6 py-4\">\n      <div class=\"flex items-center justify-between\">\n        <div>\n          <h1 class=\"text-2xl font-semibold text-gray-900\">Sent Emails</h1>\n          <p class=\"text-sm text-gray-500 mt-1\">View all newsletters sent, scheduled, or saved as drafts</p>\n        </div>\n        <Button @click=\"refreshNewsletters\" :loading=\"isLoading\">\n          <template #prefix>\n            <FeatherIcon name=\"refresh-cw\" class=\"w-4 h-4\" />\n          </template>\n          Refresh\n        </Button>\n      </div>\n    </div>\n\n    <!-- Loading State -->\n    <div v-if=\"isLoading && newsletters.length === 0\" class=\"flex items-center justify-center flex-1\">\n      <div class=\"text-center\">\n        <LoadingIndicator class=\"w-8 h-8 mx-auto mb-4\" />\n        <p class=\"text-gray-500\">Loading newsletters...</p>\n      </div>\n    </div>\n\n    <!-- Empty State -->\n    <div v-else-if=\"!isLoading && newsletters.length === 0\" class=\"flex items-center justify-center flex-1\">\n      <div class=\"text-center max-w-md\">\n        <FeatherIcon name=\"mail\" class=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n        <h3 class=\"text-lg font-medium text-gray-900 mb-2\">No newsletters found</h3>\n        <p class=\"text-gray-500 mb-6\">You haven't sent any newsletters yet. Create one from the Issues page.</p>\n      </div>\n    </div>\n\n    <!-- Newsletter List -->\n    <div v-else class=\"flex-1 overflow-auto p-6\">\n      <div class=\"max-w-7xl mx-auto\">\n        <div class=\"bg-white rounded-lg shadow overflow-hidden\">\n          <table class=\"min-w-full divide-y divide-gray-200\">\n            <thead class=\"bg-gray-50\">\n              <tr>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Subject\n                </th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Status\n                </th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Recipients\n                </th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Sent By\n                </th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Date\n                </th>\n                <th class=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Actions\n                </th>\n              </tr>\n            </thead>\n            <tbody class=\"bg-white divide-y divide-gray-200\">\n              <tr v-for=\"newsletter in newsletters\" :key=\"newsletter.name\" class=\"hover:bg-gray-50\">\n                <td class=\"px-6 py-4\">\n                  <div class=\"flex items-center\">\n                    <FeatherIcon name=\"mail\" class=\"w-4 h-4 text-gray-400 mr-3\" />\n                    <div>\n                      <div class=\"text-sm font-medium text-gray-900\">\n                        {{ newsletter.subject }}\n                      </div>\n                      <div class=\"text-xs text-gray-500\">\n                        {{ newsletter.name }}\n                      </div>\n                    </div>\n                  </div>\n                </td>\n                <td class=\"px-6 py-4 whitespace-nowrap\">\n                  <span :class=\"getStatusBadgeClass(newsletter)\" class=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium\">\n                    {{ getStatusText(newsletter) }}\n                  </span>\n                </td>\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                  {{ newsletter.total_recipients || 0 }}\n                </td>\n                <td class=\"px-6 py-4 whitespace-nowrap\">\n                  <div class=\"text-sm text-gray-900\">{{ newsletter.sender_name || 'Unknown' }}</div>\n                  <div class=\"text-xs text-gray-500\">{{ newsletter.sender_email }}</div>\n                </td>\n                <td class=\"px-6 py-4 whitespace-nowrap\">\n                  <div class=\"text-sm text-gray-900\">\n                    {{ formatDate(newsletter.email_sent_at || newsletter.schedule_send || newsletter.modified) }}\n                  </div>\n                  <div class=\"text-xs text-gray-500\">\n                    {{ formatTime(newsletter.email_sent_at || newsletter.schedule_send || newsletter.modified) }}\n                  </div>\n                </td>\n                <td class=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                  <button @click=\"viewNewsletter(newsletter)\" class=\"text-blue-600 hover:text-blue-900 mr-4\">\n                    View\n                  </button>\n                  <button v-if=\"!newsletter.email_sent\" @click=\"deleteNewsletter(newsletter)\" class=\"text-red-600 hover:text-red-900\">\n                    Delete\n                  </button>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport { Button, FeatherIcon, LoadingIndicator } from 'frappe-ui'\nimport { call } from 'frappe-ui'\n\nconst newsletters = ref([])\nconst isLoading = ref(false)\n\nconst loadNewsletters = async () => {\n  isLoading.value = true\n  try {\n    console.log('Loading newsletters...')\n\n    const response = await call('frappe.client.get_list', {\n      doctype: 'Newsletter',\n      fields: [\n        'name',\n        'subject',\n        'sender_name',\n        'sender_email',\n        'email_sent',\n        'email_sent_at',\n        'schedule_sending',\n        'schedule_send',\n        'total_recipients',\n        'total_views',\n        'modified',\n        'owner'\n      ],\n      order_by: 'modified desc',\n      limit_page_length: 100\n    })\n\n    newsletters.value = response || []\n    console.log(`Loaded ${newsletters.value.length} newsletters`)\n  } catch (error) {\n    console.error('Error loading newsletters:', error)\n    newsletters.value = []\n  } finally {\n    isLoading.value = false\n  }\n}\n\nconst refreshNewsletters = () => {\n  loadNewsletters()\n}\n\nconst getStatusText = (newsletter) => {\n  if (newsletter.email_sent) {\n    return 'Sent'\n  } else if (newsletter.schedule_sending) {\n    return 'Scheduled'\n  } else {\n    return 'Draft'\n  }\n}\n\nconst getStatusBadgeClass = (newsletter) => {\n  if (newsletter.email_sent) {\n    return 'bg-green-100 text-green-800'\n  } else if (newsletter.schedule_sending) {\n    return 'bg-blue-100 text-blue-800'\n  } else {\n    return 'bg-gray-100 text-gray-800'\n  }\n}\n\nconst formatDate = (dateString) => {\n  if (!dateString) return 'N/A'\n  const date = new Date(dateString)\n  return date.toLocaleDateString('en-US', {\n    month: 'short',\n    day: 'numeric',\n    year: 'numeric'\n  })\n}\n\nconst formatTime = (dateString) => {\n  if (!dateString) return ''\n  const date = new Date(dateString)\n  return date.toLocaleTimeString('en-US', {\n    hour: '2-digit',\n    minute: '2-digit'\n  })\n}\n\nconst viewNewsletter = (newsletter) => {\n  // Open newsletter in Frappe desk\n  window.open(`/app/newsletter/${newsletter.name}`, '_blank')\n}\n\nconst deleteNewsletter = async (newsletter) => {\n  if (!confirm(`Are you sure you want to delete \"${newsletter.subject}\"?`)) {\n    return\n  }\n\n  try {\n    await call('frappe.client.delete', {\n      doctype: 'Newsletter',\n      name: newsletter.name\n    })\n\n    // Remove from list\n    newsletters.value = newsletters.value.filter(n => n.name !== newsletter.name)\n\n    console.log(`Deleted newsletter: ${newsletter.name}`)\n  } catch (error) {\n    console.error('Error deleting newsletter:', error)\n    alert(`Failed to delete newsletter: ${error.message || error}`)\n  }\n}\n\nonMounted(() => {\n  loadNewsletters()\n})\n</script>\n"],"names":["newsletters","ref","isLoading","loadNewsletters","__async","response","call","error","refreshNewsletters","getStatusText","newsletter","getStatusBadgeClass","formatDate","dateString","formatTime","viewNewsletter","deleteNewsletter","n","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","_unref","Button","FeatherIcon","_hoisted_4","_hoisted_5","LoadingIndicator","_cache","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_Fragment","_renderList","_hoisted_13","_hoisted_14","_hoisted_15","_toDisplayString","_hoisted_16","_hoisted_17","_normalizeClass","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","$event","_hoisted_26","_hoisted_27"],"mappings":"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"}