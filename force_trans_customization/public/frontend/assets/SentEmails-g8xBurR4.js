var y=(v,n,o)=>new Promise((_,p)=>{var g=i=>{try{c(o.next(i))}catch(m){p(m)}},f=i=>{try{c(o.throw(i))}catch(m){p(m)}},c=i=>i.done?_(i.value):Promise.resolve(i.value).then(g,f);c((o=o.apply(v,n)).next())});import{r as w,o as C,A as l,G as e,M as x,L as b,P as u,F as D,T as $,z as d,V as h,D as L,S as j,aF as V,E as r,B,I as E}from"./index-D4AQx-eV.js";import{c as k}from"./call-DjkLykxt.js";const T={class:"h-full flex flex-col bg-gray-50"},A={class:"bg-white border-b border-gray-200 px-6 py-4"},F={class:"flex items-center justify-between"},U={key:0,class:"flex items-center justify-center flex-1"},z={class:"text-center"},I={key:1,class:"flex items-center justify-center flex-1"},M={class:"text-center max-w-md"},R={key:2,class:"flex-1 overflow-auto p-6"},G={class:"max-w-7xl mx-auto"},P={class:"bg-white rounded-lg shadow overflow-hidden"},Y={class:"min-w-full divide-y divide-gray-200"},q={class:"bg-white divide-y divide-gray-200"},H={class:"px-6 py-4"},J={class:"flex items-center"},K={class:"text-sm font-medium text-gray-900"},O={class:"text-xs text-gray-500"},Q={class:"px-6 py-4 whitespace-nowrap"},W={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},X={class:"px-6 py-4 whitespace-nowrap"},Z={class:"text-sm text-gray-900"},ee={class:"text-xs text-gray-500"},te={class:"px-6 py-4 whitespace-nowrap"},se={class:"text-sm text-gray-900"},ae={class:"text-xs text-gray-500"},ne={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},oe=["onClick"],ie=["onClick"],ce={__name:"SentEmails",setup(v){const n=w([]),o=w(!1),_=()=>y(this,null,function*(){o.value=!0;try{console.log("Loading newsletters...");const t=yield k("frappe.client.get_list",{doctype:"Newsletter",fields:["name","subject","sender_name","sender_email","email_sent","email_sent_at","schedule_sending","schedule_send","total_recipients","total_views","modified","owner"],order_by:"modified desc",limit_page_length:100});n.value=t||[],console.log(`Loaded ${n.value.length} newsletters`)}catch(t){console.error("Error loading newsletters:",t),n.value=[]}finally{o.value=!1}}),p=()=>{_()},g=t=>t.email_sent?"Sent":t.schedule_sending?"Scheduled":"Draft",f=t=>t.email_sent?"bg-green-100 text-green-800":t.schedule_sending?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800",c=t=>t?new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"N/A",i=t=>t?new Date(t).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",m=t=>{window.open(`/app/newsletter/${t.name}`,"_blank")},S=t=>y(this,null,function*(){if(confirm(`Are you sure you want to delete "${t.subject}"?`))try{yield k("frappe.client.delete",{doctype:"Newsletter",name:t.name}),n.value=n.value.filter(s=>s.name!==t.name),console.log(`Deleted newsletter: ${t.name}`)}catch(s){console.error("Error deleting newsletter:",s),alert(`Failed to delete newsletter: ${s.message||s}`)}});return C(()=>{_()}),(t,s)=>(d(),l("div",T,[e("div",A,[e("div",F,[s[1]||(s[1]=e("div",null,[e("h1",{class:"text-2xl font-semibold text-gray-900"},"Sent Emails"),e("p",{class:"text-sm text-gray-500 mt-1"},"View all newsletters sent, scheduled, or saved as drafts")],-1)),x(u(j),{onClick:p,loading:o.value},{prefix:b(()=>[x(u(h),{name:"refresh-cw",class:"w-4 h-4"})]),default:b(()=>[s[0]||(s[0]=L(" Refresh "))]),_:1,__:[0]},8,["loading"])])]),o.value&&n.value.length===0?(d(),l("div",U,[e("div",z,[x(u(V),{class:"w-8 h-8 mx-auto mb-4"}),s[2]||(s[2]=e("p",{class:"text-gray-500"},"Loading newsletters...",-1))])])):!o.value&&n.value.length===0?(d(),l("div",I,[e("div",M,[x(u(h),{name:"mail",class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s[3]||(s[3]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No newsletters found",-1)),s[4]||(s[4]=e("p",{class:"text-gray-500 mb-6"},"You haven't sent any newsletters yet. Create one from the Issues page.",-1))])])):(d(),l("div",R,[e("div",G,[e("div",P,[e("table",Y,[s[5]||(s[5]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Subject "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Recipients "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Sent By "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date "),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",q,[(d(!0),l(D,null,$(n.value,a=>(d(),l("tr",{key:a.name,class:"hover:bg-gray-50"},[e("td",H,[e("div",J,[x(u(h),{name:"mail",class:"w-4 h-4 text-gray-400 mr-3"}),e("div",null,[e("div",K,r(a.subject),1),e("div",O,r(a.name),1)])])]),e("td",Q,[e("span",{class:B([f(a),"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},r(g(a)),3)]),e("td",W,r(a.total_recipients||0),1),e("td",X,[e("div",Z,r(a.sender_name||"Unknown"),1),e("div",ee,r(a.sender_email),1)]),e("td",te,[e("div",se,r(c(a.email_sent_at||a.schedule_send||a.modified)),1),e("div",ae,r(i(a.email_sent_at||a.schedule_send||a.modified)),1)]),e("td",ne,[e("button",{onClick:N=>m(a),class:"text-blue-600 hover:text-blue-900 mr-4"}," View ",8,oe),a.email_sent?E("",!0):(d(),l("button",{key:0,onClick:N=>S(a),class:"text-red-600 hover:text-red-900"}," Delete ",8,ie))])]))),128))])])])])]))]))}};export{ce as default};
//# sourceMappingURL=SentEmails-g8xBurR4.js.map
