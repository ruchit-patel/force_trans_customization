var cs=Object.defineProperty,ps=Object.defineProperties;var gs=Object.getOwnPropertyDescriptors;var it=Object.getOwnPropertySymbols;var Mt=Object.prototype.hasOwnProperty,Rt=Object.prototype.propertyIsEnumerable;var Et=(t,s,o)=>s in t?cs(t,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[s]=o,Fe=(t,s)=>{for(var o in s||(s={}))Mt.call(s,o)&&Et(t,o,s[o]);if(it)for(var o of it(s))Rt.call(s,o)&&Et(t,o,s[o]);return t},ut=(t,s)=>ps(t,gs(s));var dt=(t,s)=>{var o={};for(var n in t)Mt.call(t,n)&&s.indexOf(n)<0&&(o[n]=t[n]);if(t!=null&&it)for(var n of it(t))s.indexOf(n)<0&&Rt.call(t,n)&&(o[n]=t[n]);return o};var de=(t,s,o)=>new Promise((n,u)=>{var p=m=>{try{h(o.next(m))}catch(_){u(_)}},y=m=>{try{h(o.throw(m))}catch(_){u(_)}},h=m=>m.done?n(m.value):Promise.resolve(m.value).then(p,y);h((o=o.apply(t,s)).next())});import{r as D,o as Qe,w as Ht,a as he,d as ot,y as ms,c as z,b as vs,h as fs,p as Nt,e as bs,u as ys,l as ft,H as yt,t as kt,f as hs,g as xs,N as At,i as ht,j as ws,k as Ve,x as _s,m as De,n as Ce,q as Je,v as ks,s as Lt,_ as Gt,O as Cs,z as a,A as i,B as q,C as fe,F as le,D as se,E as I,G as e,I as V,J as $s,K as ne,L as Q,M as B,P as g,Q as ze,R as Ke,S as ve,T as ae,U as Ye,V as ge,W as Ss,X as Is,Y as Ze,Z as Ie,$ as Ct,a0 as Be,a1 as qt,a2 as lt,a3 as Ts,a4 as Ps,a5 as Es,a6 as $e,a7 as He,a8 as re,a9 as me,aa as Dt,ab as Kt,ac as Ue,ad as Ms,ae as st,af as $t,ag as Le,ah as Rs,ai as As,aj as Wt,ak as St,al as Ls,am as Ds,an as Jt,ao as js,ap as Fs,aq as Vs,ar as Us,as as Os,at as Bs,au as zs,av as Hs,aw as Ns,ax as Gs,ay as qs,az as Ks,aA as ct,aB as nt,aC as Xe,aD as Ws,aE as jt}from"./index-D4AQx-eV.js";import{c as Oe}from"./call-DjkLykxt.js";function Ft(t,s){if(t)return t;let o=s!=null?s:"button";if(typeof o=="string"&&o.toLowerCase()==="button")return"button"}function Js(t,s){let o=D(Ft(t.value.type,t.value.as));return Qe(()=>{o.value=Ft(t.value.type,t.value.as)}),Ht(()=>{var n;o.value||he(s)&&he(s)instanceof HTMLButtonElement&&!((n=he(s))!=null&&n.hasAttribute("type"))&&(o.value="button")}),o}let Vt=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function Ut(t){var s,o;let n=(s=t.innerText)!=null?s:"",u=t.cloneNode(!0);if(!(u instanceof HTMLElement))return n;let p=!1;for(let h of u.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))h.remove(),p=!0;let y=p?(o=u.innerText)!=null?o:"":n;return Vt.test(y)&&(y=y.replace(Vt,"")),y}function Qs(t){let s=t.getAttribute("aria-label");if(typeof s=="string")return s.trim();let o=t.getAttribute("aria-labelledby");if(o){let n=o.split(" ").map(u=>{let p=document.getElementById(u);if(p){let y=p.getAttribute("aria-label");return typeof y=="string"?y.trim():Ut(p).trim()}return null}).filter(Boolean);if(n.length>0)return n.join(", ")}return Ut(t).trim()}function Xs(t){let s=D(""),o=D("");return()=>{let n=he(t);if(!n)return"";let u=n.innerText;if(s.value===u)return o.value;let p=Qs(n).trim().toLowerCase();return s.value=u,o.value=p,p}}var Ys=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(Ys||{}),Zs=(t=>(t[t.Pointer=0]="Pointer",t[t.Other=1]="Other",t))(Zs||{});function eo(t){requestAnimationFrame(()=>requestAnimationFrame(t))}let Qt=Symbol("MenuContext");function xt(t){let s=Ve(Qt,null);if(s===null){let o=new Error(`<${t} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(o,xt),o}return s}let to=ot({name:"Menu",props:{as:{type:[Object,String],default:"template"}},setup(t,{slots:s,attrs:o}){let n=D(1),u=D(null),p=D(null),y=D([]),h=D(""),m=D(null),_=D(1);function v(T=E=>E){let E=m.value!==null?y.value[m.value]:null,x=Cs(T(y.value.slice()),F=>he(F.dataRef.domRef)),d=E?x.indexOf(E):null;return d===-1&&(d=null),{items:x,activeItemIndex:d}}let L={menuState:n,buttonRef:u,itemsRef:p,items:y,searchQuery:h,activeItemIndex:m,activationTrigger:_,closeMenu:()=>{n.value=1,m.value=null},openMenu:()=>n.value=0,goToItem(T,E,x){let d=v(),F=_s(T===De.Specific?{focus:De.Specific,id:E}:{focus:T},{resolveItems:()=>d.items,resolveActiveIndex:()=>d.activeItemIndex,resolveId:k=>k.id,resolveDisabled:k=>k.dataRef.disabled});h.value="",m.value=F,_.value=x!=null?x:1,y.value=d.items},search(T){let E=h.value!==""?0:1;h.value+=T.toLowerCase();let x=(m.value!==null?y.value.slice(m.value+E).concat(y.value.slice(0,m.value+E)):y.value).find(F=>F.dataRef.textValue.startsWith(h.value)&&!F.dataRef.disabled),d=x?y.value.indexOf(x):-1;d===-1||d===m.value||(m.value=d,_.value=1)},clearSearch(){h.value=""},registerItem(T,E){let x=v(d=>[...d,{id:T,dataRef:E}]);y.value=x.items,m.value=x.activeItemIndex,_.value=1},unregisterItem(T){let E=v(x=>{let d=x.findIndex(F=>F.id===T);return d!==-1&&x.splice(d,1),x});y.value=E.items,m.value=E.activeItemIndex,_.value=1}};return ms([u,p],(T,E)=>{var x;L.closeMenu(),vs(E,fs.Loose)||(T.preventDefault(),(x=he(u))==null||x.focus())},z(()=>n.value===0)),Nt(Qt,L),bs(z(()=>ys(n.value,{0:ft.Open,1:ft.Closed}))),()=>{let T={open:n.value===0,close:L.closeMenu};return yt({ourProps:{},theirProps:t,slot:T,slots:s,attrs:o,name:"Menu"})}}}),so=ot({name:"MenuButton",props:{disabled:{type:Boolean,default:!1},as:{type:[Object,String],default:"button"},id:{type:String,default:()=>`headlessui-menu-button-${kt()}`}},setup(t,{attrs:s,slots:o,expose:n}){let u=xt("MenuButton");n({el:u.buttonRef,$el:u.buttonRef});function p(_){switch(_.key){case Ce.Space:case Ce.Enter:case Ce.ArrowDown:_.preventDefault(),_.stopPropagation(),u.openMenu(),Je(()=>{var v;(v=he(u.itemsRef))==null||v.focus({preventScroll:!0}),u.goToItem(De.First)});break;case Ce.ArrowUp:_.preventDefault(),_.stopPropagation(),u.openMenu(),Je(()=>{var v;(v=he(u.itemsRef))==null||v.focus({preventScroll:!0}),u.goToItem(De.Last)});break}}function y(_){switch(_.key){case Ce.Space:_.preventDefault();break}}function h(_){t.disabled||(u.menuState.value===0?(u.closeMenu(),Je(()=>{var v;return(v=he(u.buttonRef))==null?void 0:v.focus({preventScroll:!0})})):(_.preventDefault(),u.openMenu(),eo(()=>{var v;return(v=he(u.itemsRef))==null?void 0:v.focus({preventScroll:!0})})))}let m=Js(z(()=>({as:t.as,type:s.type})),u.buttonRef);return()=>{var _;let v={open:u.menuState.value===0},x=t,{id:L}=x,T=dt(x,["id"]),E={ref:u.buttonRef,id:L,type:m.value,"aria-haspopup":"menu","aria-controls":(_=he(u.itemsRef))==null?void 0:_.id,"aria-expanded":u.menuState.value===0,onKeydown:p,onKeyup:y,onClick:h};return yt({ourProps:E,theirProps:T,slot:v,attrs:s,slots:o,name:"MenuButton"})}}}),oo=ot({name:"MenuItems",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-menu-items-${kt()}`}},setup(t,{attrs:s,slots:o,expose:n}){let u=xt("MenuItems"),p=D(null);n({el:u.itemsRef,$el:u.itemsRef}),hs({container:z(()=>he(u.itemsRef)),enabled:z(()=>u.menuState.value===0),accept(v){return v.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:v.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(v){v.setAttribute("role","none")}});function y(v){var L;switch(p.value&&clearTimeout(p.value),v.key){case Ce.Space:if(u.searchQuery.value!=="")return v.preventDefault(),v.stopPropagation(),u.search(v.key);case Ce.Enter:if(v.preventDefault(),v.stopPropagation(),u.activeItemIndex.value!==null){let T=u.items.value[u.activeItemIndex.value];(L=he(T.dataRef.domRef))==null||L.click()}u.closeMenu(),Gt(he(u.buttonRef));break;case Ce.ArrowDown:return v.preventDefault(),v.stopPropagation(),u.goToItem(De.Next);case Ce.ArrowUp:return v.preventDefault(),v.stopPropagation(),u.goToItem(De.Previous);case Ce.Home:case Ce.PageUp:return v.preventDefault(),v.stopPropagation(),u.goToItem(De.First);case Ce.End:case Ce.PageDown:return v.preventDefault(),v.stopPropagation(),u.goToItem(De.Last);case Ce.Escape:v.preventDefault(),v.stopPropagation(),u.closeMenu(),Je(()=>{var T;return(T=he(u.buttonRef))==null?void 0:T.focus({preventScroll:!0})});break;case Ce.Tab:v.preventDefault(),v.stopPropagation(),u.closeMenu(),Je(()=>ks(he(u.buttonRef),v.shiftKey?Lt.Previous:Lt.Next));break;default:v.key.length===1&&(u.search(v.key),p.value=setTimeout(()=>u.clearSearch(),350));break}}function h(v){switch(v.key){case Ce.Space:v.preventDefault();break}}let m=xs(),_=z(()=>m!==null?(m.value&ft.Open)===ft.Open:u.menuState.value===0);return()=>{var v,L;let T={open:u.menuState.value===0},F=t,{id:E}=F,x=dt(F,["id"]),d={"aria-activedescendant":u.activeItemIndex.value===null||(v=u.items.value[u.activeItemIndex.value])==null?void 0:v.id,"aria-labelledby":(L=he(u.buttonRef))==null?void 0:L.id,id:E,onKeydown:y,onKeyup:h,role:"menu",tabIndex:0,ref:u.itemsRef};return yt({ourProps:d,theirProps:x,slot:T,attrs:s,slots:o,features:At.RenderStrategy|At.Static,visible:_.value,name:"MenuItems"})}}}),lo=ot({name:"MenuItem",inheritAttrs:!1,props:{as:{type:[Object,String],default:"template"},disabled:{type:Boolean,default:!1},id:{type:String,default:()=>`headlessui-menu-item-${kt()}`}},setup(t,{slots:s,attrs:o,expose:n}){let u=xt("MenuItem"),p=D(null);n({el:p,$el:p});let y=z(()=>u.activeItemIndex.value!==null?u.items.value[u.activeItemIndex.value].id===t.id:!1),h=Xs(p),m=z(()=>({disabled:t.disabled,get textValue(){return h()},domRef:p}));Qe(()=>u.registerItem(t.id,m)),ht(()=>u.unregisterItem(t.id)),Ht(()=>{u.menuState.value===0&&y.value&&u.activationTrigger.value!==0&&Je(()=>{var d,F;return(F=(d=he(p))==null?void 0:d.scrollIntoView)==null?void 0:F.call(d,{block:"nearest"})})});function _(d){if(t.disabled)return d.preventDefault();u.closeMenu(),Gt(he(u.buttonRef))}function v(){if(t.disabled)return u.goToItem(De.Nothing);u.goToItem(De.Specific,t.id)}let L=ws();function T(d){L.update(d)}function E(d){L.wasMoved(d)&&(t.disabled||y.value||u.goToItem(De.Specific,t.id,0))}function x(d){L.wasMoved(d)&&(t.disabled||y.value&&u.goToItem(De.Nothing))}return()=>{let{disabled:d}=t,F={active:y.value,disabled:d,close:u.closeMenu},C=t,{id:k}=C,S=dt(C,["id"]);return yt({ourProps:{id:k,ref:p,role:"menuitem",tabIndex:d===!0?void 0:-1,"aria-disabled":d===!0?!0:void 0,disabled:void 0,onClick:_,onFocus:v,onPointerenter:T,onMouseenter:T,onPointermove:E,onMousemove:E,onPointerleave:x,onMouseleave:x},theirProps:Fe(Fe({},o),S),slot:F,attrs:o,slots:s,name:"MenuItem"})}}});const no=["src","alt"],ao=ot({__name:"Avatar",props:{image:{},label:{},size:{default:"md"},shape:{default:"circle"}},setup(t){const s=D(!1),o=t,n=z(()=>({circle:"rounded-full",square:{xs:"rounded-[4px]",sm:"rounded-[5px]",md:"rounded-[5px]",lg:"rounded-[6px]",xl:"rounded-[6px]","2xl":"rounded-[8px]","3xl":"rounded-[10px]"}[o.size]})[o.shape]),u=z(()=>({xs:"w-4 h-4",sm:"w-5 h-5",md:"w-6 h-6",lg:"w-7 h-7",xl:"w-8 h-8","2xl":"w-10 h-10","3xl":"w-11.5 h-11.5"})[o.size]),p=z(()=>["font-medium",{xs:"text-2xs",sm:"text-sm",md:"text-base",lg:"text-base",xl:"text-lg","2xl":"text-xl","3xl":"text-2xl"}[o.size]]),y=z(()=>({xs:"-mr-[.1rem] -mb-[.1rem] h-2 w-2",sm:"-mr-[.1rem] -mb-[.1rem] h-[9px] w-[9px]",md:"-mr-[.1rem] -mb-[.1rem] h-2.5 w-2.5",lg:"-mr-[.1rem] -mb-[.1rem] h-3 w-3",xl:"-mr-[.1rem] -mb-[.1rem] h-3 w-3","2xl":"-mr-[.1rem] -mb-[.1rem] h-3.5 w-3.5","3xl":"-mr-[.2rem] -mb-[.2rem] h-4 w-4"})[o.size]),h=z(()=>({xs:"h-1 w-1",sm:"h-[5px] w-[5px]",md:"h-1.5 w-1.5",lg:"h-2 w-2",xl:"h-2 w-2","2xl":"h-2.5 w-2.5","3xl":"h-3 w-3"})[o.size]),m=z(()=>({xs:"h-2.5 w-2.5",sm:"h-3 w-3",md:"h-4 w-4",lg:"h-4 w-4",xl:"h-4 w-4","2xl":"h-5 w-5","3xl":"h-5 w-5"})[o.size]);function _(v){v.type&&(s.value=!0)}return(v,L)=>(a(),i("div",{class:q(["relative inline-block shrink-0",[u.value,n.value]])},[v.image&&!s.value?(a(),i("img",{key:0,src:v.image,alt:v.label,class:q([n.value,"h-full w-full object-cover"]),onError:L[0]||(L[0]=T=>_(T))},null,42,no)):(a(),i("div",{key:1,class:q(["flex h-full w-full items-center justify-center bg-surface-gray-2 uppercase text-ink-gray-5 select-none",[p.value,n.value]])},[v.$slots.default?(a(),i("div",{key:0,class:q(m.value)},[fe(v.$slots,"default")],2)):(a(),i(le,{key:1},[se(I(v.label&&v.label[0]),1)],64))],2)),v.$slots.indicator?(a(),i("div",{key:2,class:q(["absolute bottom-0 right-0 grid place-items-center rounded-full bg-surface-white",y.value])},[e("div",{class:q(h.value)},[fe(v.$slots,"indicator")],2)],2)):V("",!0)],2))}}),ro={key:0,class:"flex h-7 items-center px-2 text-sm font-medium text-ink-gray-6"},io=["onClick"],uo={class:"whitespace-nowrap text-ink-gray-7"},co=ot({__name:"Dropdown",props:{button:{},options:{default:()=>[]},placement:{default:"left"}},setup(t){const s=$s(),o=t,n=m=>{let _=()=>{m.route?s.push(m.route):m.onClick&&m.onClick()};return{label:m.label,icon:m.icon,component:m.component,onClick:_}},u=m=>(m||[]).filter(Boolean).filter(_=>_.condition?_.condition():!0).map(_=>n(_)),p=z(()=>{let m=[],_=null,v=0;for(let L of o.options)if(L!=null){if("group"in L){_&&(m.push(_),_=null);let T=ut(Fe({key:v},L),{items:u(L.items)});m.push(T)}else _||(_={key:v,group:"",hideLabel:!0,items:[]}),_.items.push(...u([L]));v++}return _&&m.push(_),m}),y=z(()=>({enterActiveClass:"transition duration-100 ease-out",enterFromClass:"transform scale-95 opacity-0",enterToClass:"transform scale-100 opacity-100",leaveActiveClass:"transition duration-75 ease-in",leaveFromClass:"transform scale-100 opacity-100",leaveToClass:"transform scale-95 opacity-0"})),h=z(()=>o.placement==="left"?"bottom-start":o.placement==="right"?"bottom-end":o.placement==="center"?"bottom-center":"bottom");return(m,_)=>(a(),ne(g(to),{as:"div",class:"relative inline-block text-left"},{default:Q(({open:v})=>[B(g(Ss),{transition:y.value,show:v,placement:h.value},{target:Q(()=>[B(g(so),{as:"div"},{default:Q(()=>[m.$slots.default?fe(m.$slots,"default",ze(Ke({key:0},{open:v}))):(a(),ne(g(ve),Ke({key:1,active:v},m.button),{default:Q(()=>{var L;return[se(I(m.button?((L=m.button)==null?void 0:L.label)||null:"Options"),1)]}),_:2},1040,["active"]))]),_:2},1024)]),body:Q(()=>[B(g(oo),{class:q(["mt-2 min-w-40 divide-y divide-outline-gray-modals rounded-lg bg-surface-modal shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none",{"left-0 origin-top-left":m.placement=="left","right-0 origin-top-right":m.placement=="right","inset-x-0 origin-top":m.placement=="center"}])},{default:Q(()=>[(a(!0),i(le,null,ae(p.value,L=>(a(),i("div",{key:L.key,class:"p-1.5"},[L.group&&!L.hideLabel?(a(),i("div",ro,I(L.group),1)):V("",!0),(a(!0),i(le,null,ae(L.items,T=>(a(),ne(g(lo),{key:T.label},{default:Q(({active:E})=>[T.component?(a(),ne(Ye(T.component),{key:0,active:E},null,8,["active"])):(a(),i("button",{key:1,class:q([E?"bg-surface-gray-3":"text-ink-gray-6","group flex h-7 w-full items-center rounded px-2 text-base"]),onClick:T.onClick},[T.icon&&typeof T.icon=="string"?(a(),ne(ge,{key:0,name:T.icon,class:"mr-2 h-4 w-4 flex-shrink-0 text-ink-gray-6","aria-hidden":"true"},null,8,["name"])):T.icon?(a(),ne(Ye(T.icon),{key:1,class:"mr-2 h-4 w-4 flex-shrink-0 text-ink-gray-6"})):V("",!0),e("span",uo,I(T.label),1)],10,io))]),_:2},1024))),128))]))),128))]),_:1},8,["class"])]),_:2},1032,["transition","show","placement"])]),_:3}))}}),po={class:"flex h-full w-full flex-col items-center justify-center text-base"},go={class:"text-xl font-medium"},mo={class:"mt-1 text-base text-ink-gray-5"},vo={__name:"ListEmptyState",setup(t){const s=Ve("list");return(o,n)=>(a(),i("div",po,[fe(o.$slots,"default",{},()=>[e("div",go,I(g(s).options.emptyState.title),1),e("div",mo,I(g(s).options.emptyState.description),1),g(s).options.emptyState.button?(a(),ne(g(ve),Ke({key:0},g(s).options.emptyState.button,{class:"mt-4"}),null,16)):V("",!0)])]))}};function Xt(t,s=!0){let o=s?"14px ":"",n=t.map(u=>{let p=u.width||1;return typeof p=="number"?p+"fr":p}).join(" ");return o+n}const It={left:"justify-start",start:"justify-start",center:"justify-center",middle:"justify-center",right:"justify-end",end:"justify-end"},fo={class:"truncate"},Yt={__name:"ListHeaderItem",props:{item:{type:Object,required:!0},debounce:{type:Number,default:1e3}},emits:["columnWidthUpdated"],setup(t,{emit:s}){const o=t,n=s,u=D(null),p=D(null),y=z(()=>{if(typeof o.item.width=="string"){const v=parseInt(o.item.width);if(o.item.width.includes("rem"))return v*16;if(o.item.width.includes("px"))return v}return p.value.offsetWidth}),h=v=>{const L=v.clientX,T=y.value,E=d=>{document.body.classList.add("select-none"),document.body.classList.add("cursor-col-resize"),u.value.style.backgroundColor="rgb(199 199 199)";let F=T+(d.clientX-L);o.item.width=`${F<50?50:F}px`,m(o.item.width)},x=()=>{document.body.classList.remove("select-none"),document.body.classList.remove("cursor-col-resize"),u.value.style.backgroundColor="",window.removeEventListener("mousemove",E),window.removeEventListener("mouseup",x)};window.addEventListener("mousemove",E),window.addEventListener("mouseup",x)},m=Is(v=>{o.item.width=v,n("columnWidthUpdated")},o.debounce),_=Ve("list");return(v,L)=>(a(),i("div",{ref_key:"columnRef",ref:p,class:q(["group relative flex items-center",t.item.align?g(It)[t.item.align]:"justify-between"])},[e("div",{class:q(["flex items-center space-x-2 truncate text-sm text-ink-gray-5",v.$attrs.class])},[fe(v.$slots,"prefix",ze(Ze({item:t.item}))),fe(v.$slots,"default",{},()=>[e("div",fo,I(t.item.label),1)]),fe(v.$slots,"suffix",ze(Ze({item:t.item})))],2),g(_).options.resizeColumn?fe(v.$slots,"resizer",ze(Ke({key:0},{item:t.item})),()=>[e("div",{class:"flex h-4 absolute -right-2 w-2 cursor-col-resize justify-center",onMousedown:h},[e("div",{ref_key:"resizer",ref:u,class:"h-full w-[2px] rounded-full transition-all duration-300 ease-in-out group-hover:bg-gray-400"},null,512)],32)]):V("",!0)],2))}},Zt={__name:"ListHeader",emits:["columnWidthUpdated"],setup(t,{emit:s}){const o=s,n=Ve("list");return(u,p)=>(a(),i("div",{class:"mb-2 grid items-center space-x-4 rounded bg-surface-gray-2 p-2",style:Be({gridTemplateColumns:g(Xt)(g(n).columns,g(n).options.selectable)})},[g(n).options.selectable?(a(),ne(Ct,{key:0,class:"cursor-pointer duration-300",modelValue:g(n).allRowsSelected,onClick:Ie(g(n).toggleAllRows,["stop"])},null,8,["modelValue","onClick"])):V("",!0),fe(u.$slots,"default",{},()=>[(a(!0),i(le,null,ae(g(n).columns,y=>(a(),ne(Yt,{key:y.key,item:y,onColumnWidthUpdated:h=>o("columnWidthUpdated",y)},null,8,["item","onColumnWidthUpdated"]))),128))])],4))}},bo={class:"truncate text-base"},es={__name:"ListRowItem",props:{column:{type:Object,default:{}},row:{type:Object,default:{}},item:{type:[String,Number,Object],default:""},align:{type:String,default:"left"}},setup(t){const s=t,o=z(()=>{var y,h;return(y=s.column)!=null&&y.getLabel?(h=s.column)==null?void 0:h.getLabel({row:s.row}):u(s.item).label||""}),n=z(()=>p.value.options.showTooltip?s.column.getTooltip?s.column.getTooltip(s.row):u(s.item).label:"");function u(y){return y&&typeof y=="object"?y:{label:y}}const p=Ve("list");return(y,h)=>(a(),i("div",{class:q(["flex items-center space-x-2",g(It)[t.align]])},[fe(y.$slots,"prefix",{},()=>[t.column.prefix?(a(),ne(Ye(typeof t.column.prefix=="function"?t.column.prefix({row:t.row}):t.column.prefix),{key:0})):V("",!0)]),B(g(qt),ze(Ze(g(p).options.showTooltip?{text:n.value}:{text:""})),{default:Q(()=>[fe(y.$slots,"default",ze(Ze({label:o.value})),()=>[e("div",bo,I(o.value),1)])]),_:3},16),fe(y.$slots,"suffix")],2))}},Tt={__name:"ListRow",props:{row:{type:Object,required:!0}},setup(t){const s=t,o=Ve("list"),n=z(()=>{var v;return(v=o.value.rows)!=null&&v.length?o.value.rows[o.value.rows.length-1][o.value.rowKey]===s.row[o.value.rowKey]:!1}),u=z(()=>o.value.selections.has(s.row[o.value.rowKey])),p=z(()=>o.value.options.enableActive&&o.value.activeRow.value===s.row.name),y=z(()=>o.value.options.getRowRoute||o.value.options.onRowClick),h=z(()=>typeof o.value.options.rowHeight=="number"?`${o.value.options.rowHeight}px`:o.value.options.rowHeight),m=z(()=>{var T,E,x;if(!u.value)return"rounded";const v=[...o.value.selections];let L=(T=o.value.rows[0])!=null&&T.group?o.value.rows.map(d=>d.rows):[o.value.rows];for(let d of L){let F=d.findIndex(C=>C==s.row);if(F===-1)continue;let k=!v.includes((E=d[F+1])==null?void 0:E.name),S=!v.includes((x=d[F-1])==null?void 0:x.name);return(k?"rounded-b ":"")+(S?"rounded-t":"")}}),_=(v,L)=>{o.value.options.onRowClick&&o.value.options.onRowClick(v,L),o.value.activeRow.value===v.name?o.value.activeRow.value=null:o.value.activeRow.value=v.name};return(v,L)=>(a(),ne(Ye(g(o).options.getRowRoute?"router-link":"div"),Ke({class:[[m.value,u.value||p.value?"bg-surface-gray-2":"",y.value?"cursor-pointer":"",y.value?u.value||p.value?"hover:bg-surface-gray-3":"hover:bg-surface-menu-bar":""],"flex flex-col transition-all duration-300 ease-in-out"]},{to:g(o).options.getRowRoute?g(o).options.getRowRoute(t.row):void 0,onClick:T=>_(t.row,T)}),{default:Q(()=>[(a(),ne(Ye(g(o).options.getRowRoute?"template":"button"),{class:"[all:unset] hover:[all:unset]"},{default:Q(()=>{var T,E;return[e("div",{class:"grid items-center space-x-4 px-2",style:Be({height:h.value,gridTemplateColumns:g(Xt)(g(o).columns,g(o).options.selectable)})},[g(o).options.selectable?(a(),i("div",{key:0,class:"w-fit pr-2 py-3 flex",onClick:L[1]||(L[1]=Ie(()=>{},["stop","prevent"])),onDblclick:L[2]||(L[2]=Ie(()=>{},["stop"]))},[B(Ct,{modelValue:u.value,class:"cursor-pointer duration-300",onClick:L[0]||(L[0]=Ie(x=>g(o).toggleRow(t.row[g(o).rowKey]),["stop"]))},null,8,["modelValue"])],32)):V("",!0),(a(!0),i(le,null,ae(g(o).columns,(x,d)=>(a(),i("div",{key:x.key,class:q([g(It)[x.align],d==0?"text-ink-gray-9":"text-ink-gray-7"])},[fe(v.$slots,"default",Ke({ref_for:!0},{idx:d,column:x,item:t.row[x.key],isActive:p.value}),()=>[g(o).slots.cell?(a(),ne(Ye(g(o).slots.cell),Ke({key:0,ref_for:!0},{column:x,row:t.row,item:t.row[x.key],align:x.align}),null,16)):(a(),ne(es,{key:1,column:x,row:t.row,item:t.row[x.key],align:x.align},null,8,["column","row","item","align"]))])],2))),128))],4),n.value?V("",!0):(a(),i("div",{key:0,class:q(["h-px border-t",m.value==="rounded"||(E=(T=m.value)==null?void 0:T.includes)!=null&&E.call(T,"rounded-b")?"mx-2 border-outline-gray-1":"border-t-[--surface-gray-2]"])},null,2))]}),_:3}))]),_:3},16,["class"]))}},yo={class:"h-full overflow-y-auto"},ts={__name:"ListRows",setup(t){const s=Ve("list");return(o,n)=>(a(),i("div",yo,[fe(o.$slots,"default",{},()=>[(a(!0),i(le,null,ae(g(s).rows,u=>(a(),ne(Tt,{key:u[g(s).rowKey],row:u},null,8,["row"]))),128))])]))}},ho={},xo={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16"};function wo(t,s){return a(),i("svg",xo,s[0]||(s[0]=[e("path",{fill:"currentColor",d:"M4.293 5.28h7.413a.5.5 0 0 1 .41.787l-3.707 5.295a.5.5 0 0 1-.82 0L3.884 6.067a.5.5 0 0 1 .41-.787Z"},null,-1)]))}const _o=lt(ho,[["render",wo]]),ko={class:"flex items-center"},Co={class:"w-full py-1.5 pr-2"},$o={key:1,class:"text-base font-medium leading-6"},So={__name:"ListGroupHeader",props:{group:{type:Object,required:!0}},setup(t){const s=t,o=Ve("list");function n(){s.group.collapsed==null&&(s.group.collapsed=!1),s.group.collapsed=!s.group.collapsed}return(u,p)=>(a(),i(le,null,[e("div",ko,[e("button",{onClick:n,class:"ml-[3px] mr-[11px] rounded p-1 hover:bg-surface-gray-2"},[B(_o,{class:q(["h-4 w-4 text-ink-gray-6 transition-transform duration-200",[t.group.collapsed?"-rotate-90":""]])},null,8,["class"])]),fe(u.$slots,"default",{},()=>[e("div",Co,[g(o).slots["group-header"]?(a(),ne(Ye(g(o).slots["group-header"]),ze(Ke({key:0},{group:t.group})),null,16)):(a(),i("span",$o,I(t.group.group),1))])])]),p[0]||(p[0]=e("div",{class:"mx-2 h-px border-t border-outline-gray-modals"},null,-1))],64))}},Io={key:0,class:"mb-5 mt-2"},To={__name:"ListGroupRows",props:{group:{type:Object,required:!0}},setup(t){const s=Ve("list");return(o,n)=>t.group.collapsed?V("",!0):(a(),i("div",Io,[fe(o.$slots,"default",{},()=>[(a(!0),i(le,null,ae(t.group.rows,u=>(a(),ne(Tt,{key:u[g(s).rowKey],row:u},null,8,["row"]))),128))])]))}},Po={class:"h-full overflow-y-auto"},Eo={__name:"ListGroups",setup(t){const s=Ve("list");return(o,n)=>(a(),i("div",Po,[(a(!0),i(le,null,ae(g(s).rows,u=>(a(),i("div",{key:u.group},[fe(o.$slots,"default",{},()=>[B(So,{group:u},{default:Q(()=>[o.$slots["group-header"]?fe(o.$slots,"group-header",Ke({key:0,ref_for:!0},{group:u})):V("",!0)]),_:2},1032,["group"]),B(To,{group:u},null,8,["group"])])]))),128))]))}},Mo={key:0,class:"absolute inset-x-0 bottom-6 mx-auto w-max text-base"},Ro={class:"flex flex-1 justify-between border-r border-outline-gray-2 text-ink-gray-9"},Ao={class:"flex items-center space-x-3"},Lo={class:"mr-3"},Do={class:"flex items-center space-x-1"},ss=Object.assign({inheritAttrs:!1},{__name:"ListSelectBanner",setup(t){const s=Ve("list");let o=z(()=>s.value.options.selectionText(s.value.selections.size));return(n,u)=>(a(),ne(Ts,{"enter-active-class":"duration-300 ease-out","enter-from-class":"transform opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-300 ease-in","leave-from-class":"opacity-100","leave-to-class":"transform opacity-0"},{default:Q(()=>[g(s).selections.size?(a(),i("div",Mo,[e("div",{class:q(["flex min-w-[596px] items-center space-x-3 rounded-lg bg-surface-white px-4 py-2 shadow-2xl",n.$attrs.class])},[fe(n.$slots,"default",ze(Ze({selections:g(s).selections,allRowsSelected:g(s).allRowsSelected,selectAll:()=>g(s).toggleAllRows(!0),unselectAll:()=>g(s).toggleAllRows(!1)})),()=>[e("div",Ro,[e("div",Ao,[B(Ct,{modelValue:!0,disabled:!0,class:"text-ink-gray-9"}),e("div",null,I(g(o)),1)]),e("div",Lo,[fe(n.$slots,"actions",ze(Ze({selections:g(s).selections,allRowsSelected:g(s).allRowsSelected,selectAll:()=>g(s).toggleAllRows(!0),unselectAll:()=>g(s).toggleAllRows(!1)})))])]),e("div",Do,[B(g(ve),{class:q(["w- text-ink-gray-7",g(s).allRowsSelected?"cursor-not-allowed":""]),disabled:g(s).allRowsSelected,variant:"ghost",onClick:u[0]||(u[0]=p=>g(s).toggleAllRows(!0))},{default:Q(()=>u[2]||(u[2]=[se(" Select all ")])),_:1,__:[2]},8,["disabled","class"]),B(g(ve),{icon:"x",variant:"ghost",onClick:u[1]||(u[1]=p=>g(s).toggleAllRows(!1))})])])],2)])):V("",!0)]),_:3}))}}),jo={class:"relative flex w-full flex-1 flex-col overflow-x-auto"},Fo=Object.assign({inheritAttrs:!1},{__name:"ListView",props:{columns:{type:Array,default:[]},rows:{type:Array,default:[]},rowKey:{type:String,required:!0},options:{type:Object,default:()=>({getRowRoute:null,onRowClick:null,showTooltip:!0,selectable:!0,resizeColumn:!1,rowHeight:40,emptyState:{title:"No Data",description:"No data available"}})}},emits:["update:selections","update:active-row"],setup(t,{expose:s,emit:o}){const n=t,u=Ps();let p=Es(new Set),y=D(null);const h=o;$e(p,x=>{p.size&&(y.value=null),h("update:selections",x)}),$e(y,x=>{h("update:active-row",x)});let m=z(()=>{function x(F){return F===void 0?!0:F}function d(F){return F===void 0?!1:F}return{getRowRoute:n.options.getRowRoute||null,onRowClick:n.options.onRowClick||null,showTooltip:x(n.options.showTooltip),selectionText:n.options.selectionText||(F=>F===1?"1 row selected":`${F} rows selected`),enableActive:d(n.options.enableActive),selectable:x(n.options.selectable),resizeColumn:d(n.options.resizeColumn),rowHeight:n.options.rowHeight||40,emptyState:n.options.emptyState}});const _=z(()=>n.rows.length?L.value?p.size===n.rows.reduce((x,d)=>x+d.rows.length,0):p.size===n.rows.length:!1),v=z(()=>m.value.selectable);let L=z(()=>n.rows.every(x=>x.group&&x.rows&&Array.isArray(x.rows)));function T(x){p.delete(x)||p.add(x)}function E(x){if(!x||_.value){p.clear();return}if(L.value){n.rows.forEach(d=>{d.rows.forEach(F=>p.add(F[n.rowKey]))});return}n.rows.forEach(d=>p.add(d[n.rowKey]))}return Nt("list",z(()=>({rowKey:n.rowKey,rows:n.rows,columns:n.columns,options:m.value,selections:p,activeRow:y,allRowsSelected:_.value,slots:u,toggleRow:T,toggleAllRows:E}))),s({selections:p,allRowsSelected:_,toggleRow:T,toggleAllRows:E}),(x,d)=>(a(),i("div",jo,[e("div",{class:q(["flex w-max min-w-full flex-col overflow-y-hidden",x.$attrs.class]),style:Be(x.$attrs.style)},[fe(x.$slots,"default",ze(Ze({showGroupedRows:g(L),selectable:v.value})),()=>[B(Zt),n.rows.length?(a(),i(le,{key:0},[g(L)?(a(),ne(Eo,{key:0})):(a(),ne(ts,{key:1}))],64)):(a(),ne(vo,{key:1})),v.value?(a(),ne(ss,{key:2})):V("",!0)])],6)]))}}),Me=He({url:"force_trans_customization.api.issues.get_issues_with_assignments",makeParams(t){const s=t||{},o=s.limit_page_length||10,n=s.limit_start||0,u=s.filters||{},p=s.order_by||"creation desc";return console.log("issuesResource params:",{limit_page_length:o,limit_start:n,filters:u,order_by:p}),{limit_page_length:o,limit_start:n,filters:u,order_by:p}},onError(t){console.error("Failed to fetch issues:",t),window.$toast&&window.$toast({title:"Error",text:"Failed to load issues. Please try again.",icon:"x",iconClasses:"text-red-600"})},auto:!0}),os=He({url:"force_trans_customization.api.issues.get_issues_count_with_filters",makeParams(t){const s=t||{},o=s.filters||s||{};return console.log("issuesCountResource filters:",o),{filters:o}},onError(t){console.error("Failed to fetch issues count:",t)}});function at(t={}){const s={limit_page_length:t.limit_page_length||10,limit_start:t.limit_start||0,filters:t.filters||{},order_by:t.order_by||"creation desc"};return console.log("reloadIssues with params:",s),Me.reload(s)}function bt(t={}){return console.log("getIssuesCount with filters:",t),os.reload(t)}const ls=He({url:"force_trans_customization.api.issues.get_single_issue_with_assignments",makeParams(t){return{issue_name:t}},onError(t){console.error("Failed to fetch single issue:",t)},auto:!1});function Vo(t){return ls.reload(t)}const Uo=He({url:"frappe.client.get_list",makeParams(){return{doctype:"Issue Priority",fields:["name"],limit_page_length:0,order_by:"name asc"}},cache:"IssuePriority",onError(t){console.error("Failed to fetch issue priorities:",t)},auto:!0}),Oo=He({url:"frappe.client.get_list",makeParams(){return{doctype:"Issue Type",fields:["name"],limit_page_length:0,order_by:"name asc"}},cache:"IssueType",onError(t){console.error("Failed to fetch issue types:",t)},auto:!0});He({url:"frappe.client.get_list",makeParams(){return{doctype:"Project",fields:["name","project_name","status"],filters:{status:["!=","Cancelled"]},limit_page_length:0,order_by:"name asc"}},cache:"Project",onError(t){console.error("Failed to fetch projects:",t)},auto:!0});let pt=null,Ot=null,gt=null,Bt=null;function Bo(){const t=Uo.data||[],s=JSON.stringify(t);if(pt&&Ot===s)return pt;const o=[{label:"All Priority",value:""},...t.map(n=>({label:n.name,value:n.name}))];return pt=Object.freeze(o),Ot=s,pt}function zo(){const t=Oo.data||[],s=JSON.stringify(t);if(gt&&Bt===s)return gt;const o=[{label:"All Types",value:""},...t.map(n=>({label:n.name,value:n.name}))];return gt=Object.freeze(o),Bt=s,gt}const Ho=Object.freeze([{label:"All Status",value:""},{label:"Open",value:"Open"},{label:"Replied",value:"Replied"},{label:"On Hold",value:"On Hold"},{label:"Resolved",value:"Resolved"},{label:"Closed",value:"Closed"}]);function No(){return Ho}const Go=He({url:"force_trans_customization.api.issues.get_tag_colors",cache:"TagColors",onError(t){console.error("Failed to fetch tag colors:",t)},auto:!0}),mt=new Map;let zt=null;function ns(t){const s=Go.data||{},o=JSON.stringify(s);if(zt!==o&&(mt.clear(),zt=o),mt.has(t))return mt.get(t);const n=s[t]||null;return mt.set(t,n),n}const wt=He({url:"force_trans_customization.api.issues.issue_search",makeParams(t){const s=t||{};return{search_query:s.search_query||"",limit:s.limit||8}},onError(t){console.error("Failed to search issues:",t)},auto:!1});function qo(t,s=8){return!t||t.length<2?Promise.resolve(wt.data||[]):wt.reload({search_query:t,limit:s}).then(()=>wt.data||[])}const Re=He({url:"force_trans_customization.api.issues.get_issues_by_stat_filter",makeParams(t){const s=t||{},o={stat_type:s.stat_type||"team_tickets",limit_page_length:s.limit_page_length||10,limit_start:s.limit_start||0,order_by:s.order_by||"creation desc"};return s.filters&&(o.filters=s.filters),o},onError(t){console.error("Failed to filter issues by stat:",t),window.$toast&&window.$toast({title:"Error",text:"Failed to filter issues. Please try again.",icon:"x",iconClasses:"text-red-600"})},auto:!1}),as=He({url:"force_trans_customization.api.issues.get_stat_filter_count",makeParams(t){const s=t||{},o={stat_type:s.stat_type||"team_tickets"};return s.filters&&(o.filters=s.filters),o},onError(t){console.error("Failed to get stat filter count:",t)},auto:!1});function _t(t,s={}){const o={stat_type:t,limit_page_length:s.limit_page_length||10,limit_start:s.limit_start||0,order_by:s.order_by||"creation desc"};return s.filters&&(o.filters=s.filters),console.log("filterIssuesByStat params:",o),Re.reload(o)}function vt(t,s=null){const o={stat_type:t};return s&&(o.filters=s),as.reload(o)}const Ko={class:"relative w-full max-w-2xl mx-auto"},Wo={class:"relative group"},Jo=["placeholder"],Qo={class:"absolute inset-y-0 right-0 flex items-center pr-4 space-x-2"},Xo={key:1,class:"flex items-center pointer-events-none"},Yo={key:2,class:"animate-spin"},Zo={key:0,class:"px-4 py-3 bg-gradient-to-r from-slate-50 to-slate-100/50 border-b border-slate-100"},el={class:"flex items-center justify-between"},tl={class:"text-xs font-semibold text-slate-600 uppercase tracking-wider"},sl={class:"text-xs text-slate-500"},ol={key:0,class:"px-6 py-8 text-center"},ll=["onClick"],nl={class:"flex items-start space-x-4"},al={class:"flex-1 min-w-0"},rl={class:"flex items-start justify-between"},il={class:"flex-1 min-w-0"},ul={class:"text-sm font-semibold text-slate-900 truncate group-hover:text-blue-900 transition-colors duration-150"},dl=["innerHTML"],cl={class:"text-xs text-slate-500 mt-1 line-clamp-2"},pl={key:0,class:"ml-2"},gl={class:"flex-shrink-0 ml-4"},ml={class:"mt-2 flex items-center justify-between text-xs text-slate-400"},vl={key:0,class:"flex items-center"},fl={key:1,class:"flex items-center"},bl={key:1,class:"px-4 py-3 bg-slate-50/50 border-t border-slate-100"},yl={__name:"CustomSearchBox",props:{modelValue:{type:String,default:""},placeholder:{type:String,default:"Search issues by title, description, ID..."},issues:{type:Array,default:()=>[]}},emits:["update:modelValue","search","suggestion-selected"],setup(t,{expose:s,emit:o}){const n=t,u=o,p=D(null),y=D(n.modelValue),h=D(!1),m=D(!1),_=D(-1),v=D(!1),L=D(0),T=D(null),E=D([]);let x=null;$e(()=>n.modelValue,N=>{y.value=N}),$e(y,N=>{u("update:modelValue",N),u("search",N)});const d=D([]),F=N=>de(this,null,function*(){if(!N||N.length<2){d.value=[],m.value=!1,v.value=!1;return}try{v.value=!0;const G=performance.now(),ee=yield qo(N,8);L.value=performance.now()-G,d.value=ee||[],m.value=!0}catch(G){console.error("Search error:",G),d.value=[],m.value=!1}finally{v.value=!1}}),k=N=>{if(x&&clearTimeout(x),_.value=-1,!N||N.length<2){d.value=[],m.value=!1,v.value=!1;return}v.value=!0,x=setTimeout(()=>{F(N)},1e3)},S=()=>{k(y.value)},C=(N,G)=>{if(!N||!G)return N;const ee=G.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),xe=new RegExp(`(${ee})`,"gi");return N.replace(xe,'<mark class="bg-yellow-200 text-yellow-900 px-0.5 rounded">$1</mark>')},P=N=>({Open:"bg-green-100 text-green-800 border border-green-200",New:"bg-blue-100 text-blue-800 border border-blue-200","In Progress":"bg-blue-100 text-blue-800 border border-blue-200","In Review":"bg-orange-100 text-orange-800 border border-orange-200",Resolved:"bg-gray-100 text-gray-800 border border-gray-200",Closed:"bg-red-100 text-red-800 border border-red-200",Pending:"bg-yellow-100 text-yellow-800 border border-yellow-200","On Hold":"bg-orange-100 text-orange-800 border border-orange-200",Delivered:"bg-green-100 text-green-800 border border-green-200",Confirmed:"bg-purple-100 text-purple-800 border border-purple-200"})[N]||"bg-gray-100 text-gray-800 border border-gray-200",M=()=>{h.value=!0,W&&(clearTimeout(W),W=null),y.value.length>=2&&(d.value.length>0?m.value=!0:F(y.value))};let W=null;const X=()=>{h.value=!1,W=setTimeout(()=>{m.value=!1,W=null},200)},J=N=>{var G;if(m.value)switch(N.key){case"ArrowDown":N.preventDefault(),_.value=Math.min(_.value+1,d.value.length-1),H();break;case"ArrowUp":N.preventDefault(),_.value=Math.max(_.value-1,-1),H();break;case"Enter":N.preventDefault(),_.value>=0&&oe(d.value[_.value]);break;case"Escape":te(),(G=p.value)==null||G.blur();break}},oe=N=>{y.value=N.name,te();const ee=`${window.location.origin}/app/issue/${N.name}`;window.open(ee,"_blank"),u("suggestion-selected",N)},ie=()=>{var N;y.value="",te(),(N=p.value)==null||N.focus()},te=()=>{m.value=!1,_.value=-1},H=()=>{if(_.value<0||!T.value||!E.value[_.value])return;const N=T.value,G=E.value[_.value];if(G){const ee=N.getBoundingClientRect(),xe=G.getBoundingClientRect(),be=xe.top-ee.top+N.scrollTop,Ae=be+xe.height,Pe=N.scrollTop,Ee=N.clientHeight;be<Pe?N.scrollTop=be:Ae>Pe+Ee&&(N.scrollTop=Ae-Ee)}},Y=N=>{if(!N)return"";try{const G=new Date(N),ee=new Date,xe=Math.abs(ee-G),be=Math.ceil(xe/(1e3*60*60*24));return be===1?"Today":be===2?"Yesterday":be<=7?`${be-1} days ago`:G.toLocaleDateString("en-US",{month:"short",day:"numeric",year:G.getFullYear()!==ee.getFullYear()?"numeric":void 0})}catch(G){return console.error("Error formatting date:",G),N}},ce=N=>{var G,ee;(N.metaKey||N.ctrlKey)&&N.key==="k"&&(N.preventDefault(),(G=p.value)==null||G.focus(),(ee=p.value)==null||ee.select())};return Qe(()=>{document.addEventListener("keydown",ce)}),ht(()=>{document.removeEventListener("keydown",ce),x&&clearTimeout(x),W&&clearTimeout(W)}),s({focus:()=>{var N,G;(N=p.value)==null||N.focus(),(G=p.value)==null||G.select()},select:()=>{var N;return(N=p.value)==null?void 0:N.select()},$el:p}),(N,G)=>(a(),i("div",Ko,[e("div",Wo,[G[4]||(G[4]=e("div",{class:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none z-10"},[e("svg",{class:"h-5 w-5 text-slate-400 transition-colors duration-200 group-focus-within:text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),re(e("input",{ref_key:"searchInput",ref:p,type:"text","onUpdate:modelValue":G[0]||(G[0]=ee=>y.value=ee),onInput:S,onFocus:M,onBlur:X,onKeydown:J,placeholder:t.placeholder,class:q(["w-full h-14 pl-12 pr-20 text-base bg-white border border-slate-200 rounded-2xl placeholder-slate-400 text-slate-700 transition-all duration-200 ease-out focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 focus:bg-white hover:border-slate-300 hover:shadow-sm focus:shadow-lg backdrop-blur-sm",{"shadow-lg ring-2 ring-blue-500/20 border-blue-500":h.value,"bg-slate-50/50":!h.value&&y.value}])},null,42,Jo),[[me,y.value]]),e("div",Qo,[y.value?(a(),i("button",{key:0,onClick:ie,class:"p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500/20","aria-label":"Clear search"},G[1]||(G[1]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))):V("",!0),!y.value&&!h.value?(a(),i("div",Xo,G[2]||(G[2]=[e("kbd",{class:"hidden sm:inline-flex items-center px-2.5 py-1.5 border border-slate-200 rounded-lg text-xs font-mono text-slate-400 bg-slate-50/80 shadow-sm"},[e("span",{class:"text-xs"},"⌘+"),se("K ")],-1)]))):V("",!0),v.value?(a(),i("div",Yo,G[3]||(G[3]=[e("svg",{class:"h-4 w-4 text-blue-500",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):V("",!0)])]),m.value?(a(),i("div",{key:0,class:q(["absolute z-50 w-full mt-3 bg-white border border-slate-200 rounded-2xl shadow-2xl overflow-hidden backdrop-blur-sm bg-white/95",{"animate-in slide-in-from-top-2 duration-200":m.value}])},[d.value.length>0?(a(),i("div",Zo,[e("div",el,[e("span",tl,I(d.value.length)+" Result"+I(d.value.length!==1?"s":""),1),e("span",sl,I(Math.round(L.value))+"ms ",1)])])):V("",!0),e("div",{ref_key:"suggestionsContainer",ref:T,class:"max-h-80 overflow-y-auto scrollbar-thin scrollbar-thumb-slate-200 scrollbar-track-transparent"},[d.value.length===0&&y.value.length>=2?(a(),i("div",ol,G[5]||(G[5]=[Dt('<div class="w-16 h-16 mx-auto mb-4 bg-slate-100 rounded-full flex items-center justify-center" data-v-4969cdcf><svg class="w-8 h-8 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-4969cdcf><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-4969cdcf></path></svg></div><p class="text-slate-500 text-sm font-medium" data-v-4969cdcf>No issues found</p><p class="text-slate-400 text-xs mt-1" data-v-4969cdcf>Try adjusting your search terms</p>',3)]))):V("",!0),(a(!0),i(le,null,ae(d.value,(ee,xe)=>(a(),i("div",{key:ee.name||xe,ref_for:!0,ref:be=>E.value[xe]=be,onClick:be=>oe(ee),class:q(["group px-4 py-4 hover:bg-blue-50/50 cursor-pointer transition-all duration-150 border-b border-slate-50 last:border-b-0",{"bg-blue-50 ring-2 ring-blue-500/10":xe===_.value}])},[e("div",nl,[G[8]||(G[8]=e("div",{class:"flex-shrink-0 mt-0.5"},[e("div",{class:"w-10 h-10 bg-gradient-to-br from-blue-100 to-blue-200 rounded-xl flex items-center justify-center group-hover:from-blue-200 group-hover:to-blue-300 transition-all duration-200"},[e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])])],-1)),e("div",al,[e("div",rl,[e("div",il,[e("h4",ul,[e("span",{innerHTML:C(ee.subject||ee.name,y.value)},null,8,dl)]),e("p",cl,[se(" ID: "+I(ee.name)+" ",1),ee.customer?(a(),i("span",pl,"• "+I(ee.customer),1)):V("",!0)])]),e("div",gl,[e("span",{class:q(["inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium transition-colors duration-150",P(ee.status)])},I(ee.status),3)])]),e("div",ml,[ee.raised_by?(a(),i("div",vl,[G[6]||(G[6]=e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),se(" "+I(ee.raised_by),1)])):V("",!0),ee.creation?(a(),i("div",fl,[G[7]||(G[7]=e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),se(" "+I(Y(ee.creation)),1)])):V("",!0)])])])],10,ll))),128))],512),y.value&&d.value.length>0?(a(),i("div",bl,G[9]||(G[9]=[Dt('<div class="flex items-center justify-between text-xs text-slate-500" data-v-4969cdcf><div class="flex items-center space-x-4" data-v-4969cdcf><span class="flex items-center" data-v-4969cdcf><kbd class="px-1.5 py-0.5 bg-white border border-slate-200 rounded text-xs font-mono mr-1" data-v-4969cdcf>↵</kbd> to select </span><span class="flex items-center" data-v-4969cdcf><kbd class="px-1.5 py-0.5 bg-white border border-slate-200 rounded text-xs font-mono mr-1" data-v-4969cdcf>↑↓</kbd> to navigate </span></div><span class="flex items-center" data-v-4969cdcf><kbd class="px-1.5 py-0.5 bg-white border border-slate-200 rounded text-xs font-mono mr-1" data-v-4969cdcf>esc</kbd> to close </span></div>',1)]))):V("",!0)],2)):V("",!0),m.value?(a(),i("div",{key:1,class:"fixed inset-0 z-40 bg-black/5",onClick:te})):V("",!0)]))}},hl=lt(yl,[["__scopeId","data-v-4969cdcf"]]),xl={class:"bg-white p-6 rounded-lg shadow-sm border mb-6"},wl={class:"mb-6"},_l={class:"relative max-w-2xl mx-auto"},kl={key:0,class:"absolute top-full left-0 right-0 mt-1 text-sm text-gray-500 text-center"},Cl={class:"border-t border-gray-200 pt-4"},$l={class:"flex items-center justify-between"},Sl={class:"flex items-center space-x-3 flex-1"},Il={key:0,class:"bg-blue-600 text-white text-xs px-1.5 py-0.5 rounded-full"},Tl={key:0,class:"flex items-center flex-1 overflow-x-auto flex-wrap gap-2"},Pl={class:"text-green-800 font-medium"},El={class:"text-green-600"},Ml={class:"text-green-900"},Rl=["onClick"],Al={class:"flex items-center space-x-2 ml-4"},Ll=["disabled"],Dl={key:0,class:"flex items-center"},jl={key:1},Fl={key:0,class:"relative"},Vl={class:"flex"},Ul={class:"w-48 border-r border-gray-200 bg-gray-50"},Ol={class:"max-h-64 overflow-y-auto"},Bl=["onClick"],zl={class:"text-xs text-gray-400 bg-gray-200 px-1 rounded"},Hl={class:"flex-1 min-w-96"},Nl={class:"p-4"},Gl={key:0,class:"text-center py-8 text-gray-500"},ql={key:1,class:"space-y-4"},Kl={class:"col-span-2 flex items-center"},Wl={class:"text-sm font-semibold text-gray-800 bg-white px-2 py-1 rounded-md border border-gray-200"},Jl={class:"col-span-2 flex items-center"},Ql={class:"text-gray-700 font-medium truncate"},Xl={class:"col-span-7"},Yl=["onUpdate:modelValue","placeholder"],Zl=["onUpdate:modelValue","placeholder"],en={key:2,class:"space-y-2"},tn={key:0,class:"grid grid-cols-2 gap-2"},sn=["onUpdate:modelValue","onInput"],on=["onUpdate:modelValue","onInput"],ln={key:1},nn=["onUpdate:modelValue"],an={key:3,class:"space-y-2"},rn={key:0,class:"grid grid-cols-2 gap-2"},un=["onUpdate:modelValue","onInput"],dn=["onUpdate:modelValue","onInput"],cn={key:1},pn=["onUpdate:modelValue"],gn={key:4,class:"relative"},mn={key:0},vn=["onUpdate:modelValue"],fn={value:""},bn=["value"],yn={key:1,class:"space-y-2"},hn={key:0,class:"flex flex-wrap gap-1 mb-2 p-2 bg-white rounded-md border border-gray-200"},xn=["onClick"],wn={key:5,class:"space-y-2"},_n={class:"space-y-2"},kn={key:0,class:"flex flex-wrap gap-1 mb-2 p-2 bg-white rounded-md border border-gray-200"},Cn=["onClick"],$n={class:"relative"},Sn=["onUpdate:modelValue","onInput","onKeydown","placeholder"],In={key:0,class:"absolute right-3 top-1/2 transform -translate-y-1/2"},Tn={key:1,class:"max-h-48 overflow-y-auto border border-gray-200 rounded-md bg-white shadow-lg"},Pn=["onClick"],En={class:"font-medium text-gray-900"},Mn={class:"text-xs text-gray-500"},Rn={key:6,class:"space-y-2"},An={key:0,class:"flex flex-wrap gap-1 mb-2 p-2 bg-white rounded-md border border-gray-200"},Ln=["onClick"],Dn={class:"relative"},jn=["onUpdate:modelValue","onInput","onKeyup","onKeydown"],Fn={key:0,class:"absolute right-3 top-1/2 transform -translate-y-1/2"},Vn={key:1,class:"max-h-48 overflow-y-auto border border-gray-200 rounded-md bg-white shadow-lg"},Un=["onClick"],On={class:"flex items-center justify-between"},Bn={class:"font-medium text-gray-900"},zn={class:"text-xs text-gray-500"},Hn={class:"col-span-1 flex items-start justify-center pt-1"},Nn=["onClick"],Gn={key:2,class:"flex justify-between items-center pt-4 mt-4 border-t border-gray-200"},qn=["disabled"],Kn={key:0,class:"flex items-center"},Wn={key:1},Jn={__name:"IssueFilters",props:{searchQuery:{type:String,default:""},filters:{type:Object,default:()=>({})},filteredCount:{type:Number,default:0},issues:{type:Array,default:()=>[]}},emits:["update:searchQuery","update:filters","suggestion-selected","filters-applied"],setup(t,{emit:s}){const o=t,n=s,u=D(o.searchQuery),p=D(!1),y=D([]),h=D([]);let m=0;const _=D(!1),v=[{value:"subject",label:"Subject",type:"text"},{value:"status",label:"Status",type:"select"},{value:"raised_by",label:"Raised By",type:"email"},{value:"description",label:"Description",type:"text"},{value:"customer",label:"Customer",type:"link"},{value:"contact",label:"Contact",type:"link"},{value:"lead",label:"Lead",type:"link"},{value:"custom_assigned_csm_team",label:"Assigned CSM Team",type:"link"},{value:"custom_users_assigned",label:"User Assigned",type:"link"},{value:"creation",label:"Created Date",type:"date"},{value:"modified",label:"Modified Date",type:"date"},{value:"_user_tags",label:"Tags",type:"tags"}],L={status:[{value:"New",label:"New"},{value:"In Review",label:"In Review"},{value:"Confirmed",label:"Confirmed"},{value:"In Transit",label:"In Transit"},{value:"Delivered",label:"Delivered"},{value:"Closed",label:"Closed"}]},T={text:[{value:"like",label:"Contains"},{value:"equals",label:"Equals"},{value:"not_equals",label:"Not Equals"},{value:"starts_with",label:"Starts With"},{value:"ends_with",label:"Ends With"}],email:[{value:"equals",label:"Equals"},{value:"like",label:"Contains"},{value:"not_equals",label:"Not Equals"}],select:[{value:"equals",label:"Equals"},{value:"not_equals",label:"Not Equals"},{value:"in",label:"In"},{value:"not_in",label:"Not In"}],link:[{value:"in",label:"In"},{value:"equals",label:"Is"},{value:"not_equals",label:"Is Not"},{value:"like",label:"Contains"},{value:"not_in",label:"Not In"}],datetime:[{value:"equals",label:"On"},{value:"greater_than",label:"After"},{value:"less_than",label:"Before"},{value:"between",label:"Between"}],date:[{value:"equals",label:"On"},{value:"greater_than",label:"After"},{value:"less_than",label:"Before"},{value:"between",label:"Between"}],tags:[{value:"has",label:"Has Tag"},{value:"has_all",label:"Has All Tags"},{value:"not_has",label:"Does Not Have"}]},E=z(()=>JSON.stringify(y.value)!==JSON.stringify(h.value)),x=r=>{const b=v.find(f=>f.value===r);return(b==null?void 0:b.type)||"text"},d=r=>{const b=v.find(f=>f.value===r);return(b==null?void 0:b.label)||r},F=r=>({subject:"Enter issue title...",description:"Enter description...",raised_by:"Enter email address...",customer:"Search for customer...",contact:"Search for contact...",lead:"Search for lead...",custom_assigned_csm_team:"Search for CSM team...",custom_users_assigned:"Search for users...",creation:"Select date",modified:"Select date"})[r]||`Enter ${d(r).toLowerCase()}...`,k=r=>{const b=x(r);return T[b]||T.text},S=r=>L[r]||[],C=r=>r.displayValue?r.displayValue:Array.isArray(r.value)?r.value.join(", "):r.value,P=r=>r?typeof r=="string"?r.split(",").map(b=>b.trim()).filter(Boolean):r:[],M=(r,b)=>{const f=P(r.value);f.splice(b,1),r.value=f.join(", ")},W=r=>r?r.split(",").map(b=>b.trim()).filter(Boolean):[],X=(r,b)=>{const f=W(r.value);f.splice(b,1),r.value=f.join(", ")},J=(r,b)=>b.userDisplayMap&&b.userDisplayMap[r]?b.userDisplayMap[r]:r,oe=(r,b)=>{const f=P(r.value);f.includes(b.value)||(f.push(b.value),r.value=f.join(", "),r.userDisplayMap||(r.userDisplayMap={}),r.userDisplayMap[b.value]=b.label),r.searchValue="",r.suggestions=[],r.selectedLinkIndex=-1},ie=(r,b)=>{if(!r.suggestions||r.suggestions.length===0)return;const f=r.suggestions.length-1;(r.selectedLinkIndex===void 0||r.selectedLinkIndex===null)&&(r.selectedLinkIndex=-1),b==="down"?r.selectedLinkIndex=r.selectedLinkIndex<f?r.selectedLinkIndex+1:0:b==="up"&&(r.selectedLinkIndex=r.selectedLinkIndex>0?r.selectedLinkIndex-1:f),Y()},te=r=>{r.selectedLinkIndex>=0&&r.suggestions&&r.suggestions[r.selectedLinkIndex]&&oe(r,r.suggestions[r.selectedLinkIndex])},H=r=>{r.suggestions=[],r.selectedLinkIndex=-1},Y=r=>{Je(()=>{const b=document.querySelector('[ref="selectedLinkOption"]');b&&b.scrollIntoView({block:"nearest",behavior:"smooth"})})};let ce={};const N=(r,b)=>de(this,null,function*(){r.loadingTags=!0;const f=r.selectedTagIndex;ce[r.id]&&clearTimeout(ce[r.id]),ce[r.id]=setTimeout(()=>de(this,null,function*(){try{const w=yield fetch("/api/method/force_trans_customization.api.issues.search_tags",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":window.csrf_token||""},body:JSON.stringify({search_query:b||"",limit:15})});if(w.ok){const A=yield w.json();r.tagSuggestions=A.message||[],!r.tagSuggestions||r.tagSuggestions.length===0?r.selectedTagIndex=-1:f>=0&&f<r.tagSuggestions.length?r.selectedTagIndex=f:r.selectedTagIndex>=r.tagSuggestions.length&&(r.selectedTagIndex=Math.max(0,r.tagSuggestions.length-1))}}catch(w){console.error("Tag search error:",w),r.tagSuggestions=[]}finally{r.loadingTags=!1}}),300)}),G=(r,b)=>{const f=W(r.value);f.includes(b.value)||(f.push(b.value),r.value=f.join(", ")),r.tagInput="",r.tagSuggestions=[],r.selectedTagIndex=-1},ee=(r,b)=>{if(!r.tagSuggestions||r.tagSuggestions.length===0)return;const f=r.tagSuggestions.length-1;(r.selectedTagIndex===void 0||r.selectedTagIndex===null)&&(r.selectedTagIndex=-1),b==="down"?r.selectedTagIndex=r.selectedTagIndex<f?r.selectedTagIndex+1:0:b==="up"&&(r.selectedTagIndex=r.selectedTagIndex>0?r.selectedTagIndex-1:f),Ae()},xe=r=>{r.selectedTagIndex>=0&&r.tagSuggestions&&r.tagSuggestions[r.selectedTagIndex]&&G(r,r.tagSuggestions[r.selectedTagIndex])},be=r=>{r.tagSuggestions=[],r.selectedTagIndex=-1},Ae=r=>{Je(()=>{const b=document.querySelector('[ref="selectedTagOption"]');b&&b.scrollIntoView({block:"nearest",behavior:"smooth"})})},Pe=r=>{const b=ns(r);if(b){const f=b.startsWith("#")?b:`#${b}`,w=f.replace("#",""),A=parseInt(w.substr(0,2),16),pe=parseInt(w.substr(2,2),16),qe=parseInt(w.substr(4,2),16);return{backgroundColor:`rgba(${A}, ${pe}, ${qe}, 0.15)`,color:"#000000",borderColor:f,borderWidth:"1.5px"}}return{backgroundColor:"rgba(107, 114, 128, 0.1)",color:"#000000",borderColor:"rgba(107, 114, 128, 0.3)",borderWidth:"1px"}};let Ee={};const We=(r,b)=>de(this,null,function*(){r.searchValue=b,r.loading=!0;const f=r.selectedLinkIndex;Ee[r.id]&&clearTimeout(Ee[r.id]),Ee[r.id]=setTimeout(()=>de(this,null,function*(){try{let w=[],A="";if(r.field==="customer"?A="/api/method/force_trans_customization.api.issues.search_customers":r.field==="contact"?A="/api/method/force_trans_customization.api.issues.search_contacts":r.field==="lead"?A="/api/method/force_trans_customization.api.issues.search_leads":r.field==="custom_assigned_csm_team"?A="/api/method/force_trans_customization.api.issues.search_user_groups":r.field==="custom_users_assigned"&&(A="/api/method/force_trans_customization.api.issues.search_users"),A){const pe=yield fetch(A,{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":window.csrf_token||""},body:JSON.stringify({search_query:b||"",limit:10,doctype_filter:r.field==="custom_users_assigned"?"User":void 0})});pe.ok&&(w=(yield pe.json()).message||[])}r.suggestions=w,!r.suggestions||r.suggestions.length===0?r.selectedLinkIndex=-1:f>=0&&f<r.suggestions.length?r.selectedLinkIndex=f:r.selectedLinkIndex>=r.suggestions.length&&(r.selectedLinkIndex=Math.max(0,r.suggestions.length-1))}catch(w){console.error("Search error:",w),r.suggestions=[]}finally{r.loading=!1}}),300)}),ke=(r,b)=>k(r).map(w=>({label:w.label,onClick:()=>{b.operator!==w.value&&(x(r)==="date"&&(w.value==="between"?b.value&&!b.startValue&&(b.startValue=b.value,b.endValue=""):b.operator==="between"&&(b.startValue&&!b.value&&(b.value=b.startValue),b.startValue="",b.endValue="")),b.multiSelectValue=null,b.searchValue="",b.suggestions=[],b.searchOptions=[]),b.operator=w.value}})),Se=(r,b)=>{var w;return((w=k(b).find(A=>A.value===r))==null?void 0:w.label)||r},R=(r,b)=>{const w=S(b).find(A=>A.value===r);return w?w.label:r},U=r=>{r.startValue&&r.endValue?r.value=`${r.startValue},${r.endValue}`:r.value=""},j=r=>{var A;const b=x(r);let f="equals";b==="link"?f="in":b==="tags"?f="has":f=((A=k(r)[0])==null?void 0:A.value)||"equals";const w={id:++m,field:r,operator:f,value:"",startValue:"",endValue:"",searchValue:"",displayValue:"",suggestions:[],showSuggestions:!1,loading:!1,userDisplayMap:{},selectedLinkIndex:-1,tagInput:"",tagSuggestions:[],loadingTags:!1,selectedTagIndex:-1};y.value.push(w)},O=r=>{y.value.splice(r,1)},ye=r=>{h.value.splice(r,1),Ne()},ue=()=>de(this,null,function*(){if(E.value){_.value=!0;try{h.value=JSON.parse(JSON.stringify(y.value)),Ne(),p.value=!1}catch(r){console.error("Error applying filters:",r)}finally{setTimeout(()=>{_.value=!1},500)}}}),je=()=>{y.value=[],h.value=[],u.value="",n("update:searchQuery",""),n("update:filters",[]),n("filters-applied",[]),p.value=!1},Ne=()=>{const r=h.value.filter(b=>b.value&&b.value.toString().trim()).map(b=>({field:b.field,operator:b.operator,value:b.value.toString().trim(),displayValue:b.displayValue||null}));console.log("Emitting filters:",r),n("update:filters",r),n("filters-applied",r)},Ge=r=>{u.value=r,n("update:searchQuery",r)},rt=r=>{n("suggestion-selected",r)};return $e(()=>o.searchQuery,r=>{u.value=r}),Qe(()=>{const r=localStorage.getItem("issue_filters");if(r)try{const b=JSON.parse(r);h.value=b.applied||[],y.value=b.pending||[]}catch(b){console.warn("Failed to parse saved filters:",b)}$e(()=>y.value,b=>{b.forEach(f=>{x(f.field)==="link"&&f.searchValue&&We(f,f.searchValue)})},{deep:!0})}),$e([h,y],()=>{localStorage.setItem("issue_filters",JSON.stringify({applied:h.value,pending:y.value}))},{deep:!0}),(r,b)=>(a(),i("div",xl,[e("div",wl,[e("div",_l,[B(hl,{ref:"searchBoxRef","model-value":u.value,"onUpdate:modelValue":Ge,onSuggestionSelected:rt,issues:t.issues,placeholder:"Search issues by title, description, assignee...",class:"awesome-search"},null,8,["model-value","issues"]),u.value?(a(),i("div",kl," Searching in "+I(t.filteredCount)+" issues ",1)):V("",!0)])]),e("div",Cl,[e("div",$l,[e("div",Sl,[e("button",{onClick:b[0]||(b[0]=f=>p.value=!p.value),class:"inline-flex items-center space-x-2 px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-md text-sm font-medium text-gray-700 transition-colors"},[b[4]||(b[4]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.414A1 1 0 013 6.707V4z"})],-1)),b[5]||(b[5]=e("span",null,"Filters",-1)),h.value.length>0?(a(),i("span",Il,I(h.value.length),1)):V("",!0)]),h.value.length>0?(a(),i("div",Tl,[(a(!0),i(le,null,ae(h.value,(f,w)=>(a(),i("div",{key:f.id,class:"flex items-center space-x-1 bg-green-100 border border-green-200 rounded px-2 py-1 text-sm whitespace-nowrap"},[e("span",Pl,I(d(f.field)),1),e("span",El,I(f.operator),1),e("span",Ml,I(C(f)),1),e("button",{onClick:A=>ye(w),class:"text-green-400 hover:text-red-600 ml-1"},b[6]||(b[6]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Rl)]))),128))])):V("",!0)]),e("div",Al,[h.value.length>0||u.value?(a(),i("button",{key:0,onClick:je,class:"px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors"}," Clear All ")):V("",!0),y.value.length>0?(a(),i("button",{key:1,onClick:ue,class:q(["px-4 py-2 text-sm font-medium rounded-md transition-all duration-200",_.value?"bg-blue-500 text-white cursor-wait":E.value?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-300 text-gray-600 cursor-not-allowed"]),disabled:!E.value||_.value},[_.value?(a(),i("span",Dl,b[7]||(b[7]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),se(" Applying... ")]))):(a(),i("span",jl,I(E.value?"Apply Filters":"Filters Applied"),1))],10,Ll)):V("",!0)])])]),p.value?(a(),i("div",Fl,[e("div",{class:"absolute top-2 left-0 right-0 z-50 bg-white border border-gray-200 rounded-lg shadow-lg",onClick:b[2]||(b[2]=Ie(()=>{},["stop"]))},[e("div",Vl,[e("div",Ul,[b[8]||(b[8]=e("div",{class:"p-3 border-b border-gray-200"},[e("h4",{class:"text-sm font-medium text-gray-900"},"Add Filter")],-1)),e("div",Ol,[(a(),i(le,null,ae(v,f=>e("button",{key:f.value,onClick:Ie(w=>j(f.value),["stop"]),class:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center justify-between"},[e("span",null,I(f.label),1),e("span",zl,I(f.type),1)],8,Bl)),64))])]),e("div",Hl,[e("div",Nl,[y.value.length===0?(a(),i("div",Gl,b[9]||(b[9]=[e("p",{class:"text-sm"},"Select a field from the left to add a filter",-1)]))):(a(),i("div",ql,[(a(!0),i(le,null,ae(y.value,(f,w)=>(a(),i("div",{key:f.id,class:"grid grid-cols-12 gap-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg shadow-sm hover:shadow-md transition-shadow"},[e("div",Kl,[e("span",Wl,I(d(f.field)),1)]),e("div",Jl,[B(g(co),{options:ke(f.field,f),placement:"left"},{default:Q(({open:A})=>[e("button",{class:q(["w-full px-3 py-2 text-sm border rounded-md transition-all duration-200 flex items-center justify-between bg-white hover:bg-gray-50",A?"border-blue-500 ring-2 ring-blue-200 shadow-md":"border-gray-300 hover:border-gray-400 shadow-sm"])},[e("span",Ql,I(Se(f.operator,f.field)),1),b[10]||(b[10]=e("svg",{class:"w-4 h-4 text-gray-400 flex-shrink-0 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))],2)]),_:2},1032,["options"])]),e("div",Xl,[x(f.field)==="text"?re((a(),i("input",{key:0,"onUpdate:modelValue":A=>f.value=A,type:"text",placeholder:F(f.field),class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 hover:border-gray-400"},null,8,Yl)),[[me,f.value]]):x(f.field)==="email"?re((a(),i("input",{key:1,"onUpdate:modelValue":A=>f.value=A,type:"email",placeholder:F(f.field),class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 hover:border-gray-400"},null,8,Zl)),[[me,f.value]]):x(f.field)==="datetime"?(a(),i("div",en,[f.operator==="between"?(a(),i("div",tn,[e("div",null,[re(e("input",{"onUpdate:modelValue":A=>f.startValue=A,type:"datetime-local",placeholder:"Start date and time",onInput:A=>U(f),class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 hover:border-gray-400"},null,40,sn),[[me,f.startValue]]),b[11]||(b[11]=e("p",{class:"text-xs text-gray-500 mt-1"},"From",-1))]),e("div",null,[re(e("input",{"onUpdate:modelValue":A=>f.endValue=A,type:"datetime-local",placeholder:"End date and time",onInput:A=>U(f),class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 hover:border-gray-400"},null,40,on),[[me,f.endValue]]),b[12]||(b[12]=e("p",{class:"text-xs text-gray-500 mt-1"},"To",-1))])])):(a(),i("div",ln,[re(e("input",{"onUpdate:modelValue":A=>f.value=A,type:"datetime-local",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 hover:border-gray-400"},null,8,nn),[[me,f.value]]),b[13]||(b[13]=e("p",{class:"text-xs text-gray-500 italic mt-1"},"Select date and time",-1))]))])):x(f.field)==="date"?(a(),i("div",an,[f.operator==="between"?(a(),i("div",rn,[e("div",null,[re(e("input",{"onUpdate:modelValue":A=>f.startValue=A,type:"date",onInput:A=>U(f),class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 hover:border-gray-400"},null,40,un),[[me,f.startValue]]),b[14]||(b[14]=e("p",{class:"text-xs text-gray-500 mt-1"},"From",-1))]),e("div",null,[re(e("input",{"onUpdate:modelValue":A=>f.endValue=A,type:"date",onInput:A=>U(f),class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 hover:border-gray-400"},null,40,dn),[[me,f.endValue]]),b[15]||(b[15]=e("p",{class:"text-xs text-gray-500 mt-1"},"To",-1))])])):(a(),i("div",cn,[re(e("input",{"onUpdate:modelValue":A=>f.value=A,type:"date",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 hover:border-gray-400"},null,8,pn),[[me,f.value]])]))])):x(f.field)==="select"?(a(),i("div",gn,[f.isMultiSelect?(a(),i("div",yn,[P(f.value).length>0?(a(),i("div",hn,[(a(!0),i(le,null,ae(P(f.value),(A,pe)=>(a(),i("span",{key:pe,class:"inline-flex items-center px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full border border-blue-200 hover:bg-blue-200 transition-colors"},[se(I(R(A,f.field))+" ",1),e("button",{onClick:qe=>M(f,pe),class:"ml-1 text-blue-600 hover:text-red-600 transition-colors"},b[16]||(b[16]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,xn)]))),128))])):V("",!0)])):(a(),i("div",mn,[f.field==="priority"||f.field==="status"||f.field==="issue_type"?re((a(),i("select",{key:0,"onUpdate:modelValue":A=>f.value=A,onKeydown:b[1]||(b[1]=Ue(Ie(A=>A.target.blur(),["prevent"]),["enter"])),class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 hover:border-gray-400"},[e("option",fn,"Select "+I(d(f.field))+"...",1),(a(!0),i(le,null,ae(S(f.field),A=>(a(),i("option",{key:A.value,value:A.value},I(A.label),9,bn))),128))],40,vn)),[[Kt,f.value]]):V("",!0)]))])):x(f.field)==="link"?(a(),i("div",wn,[e("div",_n,[P(f.value).length>0?(a(),i("div",kn,[(a(!0),i(le,null,ae(P(f.value),(A,pe)=>(a(),i("span",{key:pe,class:"inline-flex items-center px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full border border-blue-200 hover:bg-blue-200 transition-colors"},[se(I(J(A,f))+" ",1),e("button",{onClick:qe=>M(f,pe),class:"ml-1 text-blue-600 hover:text-red-600 transition-colors"},b[17]||(b[17]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Cn)]))),128))])):V("",!0),e("div",$n,[re(e("input",{"onUpdate:modelValue":A=>f.searchValue=A,onInput:A=>We(f,f.searchValue),onKeydown:[Ue(Ie(A=>ie(f,"up"),["prevent"]),["up"]),Ue(Ie(A=>ie(f,"down"),["prevent"]),["down"]),Ue(Ie(A=>te(f),["prevent"]),["enter"]),Ue(A=>H(f),["escape"])],type:"text",placeholder:`Search and add ${d(f.field)}...`,class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 hover:border-gray-400"},null,40,Sn),[[me,f.searchValue]]),f.loading?(a(),i("div",In,b[18]||(b[18]=[e("svg",{class:"animate-spin h-4 w-4 text-blue-500",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):V("",!0)]),f.suggestions&&f.suggestions.length>0&&f.searchValue?(a(),i("div",Tn,[(a(!0),i(le,null,ae(f.suggestions,(A,pe)=>(a(),i("button",{key:pe,onClick:qe=>oe(f,A),class:q(["w-full text-left px-3 py-2 text-sm border-b border-gray-100 last:border-b-0 transition-colors",f.selectedLinkIndex===pe?"bg-blue-100 text-blue-900":"hover:bg-gray-100"]),ref_for:!0,ref:f.selectedLinkIndex===pe?"selectedLinkOption":null},[e("div",En,I(A.label),1),e("div",Mn,I(A.subtitle),1)],10,Pn))),128))])):V("",!0)])])):x(f.field)==="tags"?(a(),i("div",Rn,[W(f.value).length>0?(a(),i("div",An,[(a(!0),i(le,null,ae(W(f.value),(A,pe)=>(a(),i("span",{key:pe,style:Be(Pe(A)),class:"inline-flex items-center px-2 py-1 text-xs rounded-full border transition-colors"},[se(I(A)+" ",1),e("button",{onClick:qe=>X(f,pe),class:"ml-1 hover:text-red-600 transition-colors"},b[19]||(b[19]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Ln)],4))),128))])):V("",!0),e("div",Dn,[re(e("input",{"onUpdate:modelValue":A=>f.tagInput=A,onInput:A=>N(f,f.tagInput),onKeyup:Ue(A=>xe(f),["enter"]),onKeydown:[Ue(Ie(A=>ee(f,"up"),["prevent"]),["up"]),Ue(Ie(A=>ee(f,"down"),["prevent"]),["down"]),Ue(A=>be(f),["escape"])],type:"text",placeholder:"Search and select tags from dropdown...",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 hover:border-gray-400"},null,40,jn),[[me,f.tagInput]]),f.loadingTags?(a(),i("div",Fn,b[20]||(b[20]=[e("svg",{class:"animate-spin h-4 w-4 text-blue-500",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):V("",!0)]),f.tagSuggestions&&f.tagSuggestions.length>0?(a(),i("div",Vn,[(a(!0),i(le,null,ae(f.tagSuggestions,(A,pe)=>(a(),i("button",{key:pe,onClick:qe=>G(f,A),class:q(["w-full text-left px-3 py-2 text-sm border-b border-gray-100 last:border-b-0 transition-colors",f.selectedTagIndex===pe?"bg-blue-100 text-blue-900":"hover:bg-gray-100"]),ref_for:!0,ref:f.selectedTagIndex===pe?"selectedTagOption":null},[e("div",On,[e("div",null,[e("div",Bn,I(A.label),1),e("div",zn,I(A.subtitle),1)]),A.color?(a(),i("div",{key:0,class:"w-3 h-3 rounded-full border border-gray-300",style:Be({backgroundColor:A.color})},null,4)):V("",!0)])],10,Un))),128))])):V("",!0),b[21]||(b[21]=e("p",{class:"text-xs text-gray-500 italic"},"Search existing tags and select from dropdown only",-1))])):V("",!0)]),e("div",Hn,[e("button",{onClick:A=>O(w),class:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-all duration-200 group"},b[22]||(b[22]=[e("svg",{class:"w-4 h-4 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Nn)])]))),128))])),y.value.length>0?(a(),i("div",Gn,[e("button",{onClick:je,class:"text-sm text-gray-600 hover:text-gray-900"}," Clear All "),e("button",{onClick:ue,disabled:!E.value||_.value,class:q(["px-4 py-2 text-sm font-medium rounded transition-all duration-200",_.value?"bg-gray-700 text-white cursor-wait":E.value?"bg-gray-900 text-white hover:bg-gray-800":"bg-gray-300 text-gray-600 cursor-not-allowed"])},[_.value?(a(),i("span",Kn,b[23]||(b[23]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),se(" Applying... ")]))):(a(),i("span",Wn,I(E.value?"Apply Filters":"Filters Applied"),1))],10,qn)])):V("",!0)])])])]),e("div",{class:"fixed inset-0 z-40",onClick:b[3]||(b[3]=f=>p.value=!1)})])):V("",!0)]))}},Qn=lt(Jn,[["__scopeId","data-v-f08aca36"]]),Xn={class:"bg-white rounded-lg shadow-sm border mt-4"},Yn={class:"px-6 py-4 flex items-center justify-between"},Zn={class:"text-sm text-gray-700"},ea={key:0},ta={key:1},sa={key:0,class:"flex items-center space-x-2"},oa={class:"flex items-center space-x-1"},la={key:1,class:"px-2 text-gray-500"},na={key:2,class:"px-2 text-gray-500"},aa={key:1,class:"flex items-center space-x-2"},ra={__name:"IssuePagination",props:{currentPage:{type:Number,default:1},totalItems:{type:Number,default:0},itemsPerPage:{type:Number,default:10},showItemsPerPage:{type:Boolean,default:!0},maxVisiblePages:{type:Number,default:5}},emits:["update:currentPage","update:itemsPerPage","pageChange"],setup(t,{emit:s}){const o=t,n=s,u=D(o.itemsPerPage);$e(()=>o.itemsPerPage,S=>{u.value=S});const p=z(()=>Math.ceil(o.totalItems/o.itemsPerPage)),y=z(()=>o.totalItems===0?0:(o.currentPage-1)*o.itemsPerPage+1),h=z(()=>{const S=o.currentPage*o.itemsPerPage;return Math.min(S,o.totalItems)}),m=z(()=>{const S=[],C=o.maxVisiblePages,P=o.currentPage,M=p.value;if(M<=C)for(let W=1;W<=M;W++)S.push(W);else{let W=Math.max(1,P-Math.floor(C/2)),X=Math.min(M,W+C-1);X-W+1<C&&(W=Math.max(1,X-C+1)),W>1&&(W=Math.max(2,W)),X<M&&(X=Math.min(M-1,X));for(let J=W;J<=X;J++)S.push(J)}return S}),_=z(()=>p.value>o.maxVisiblePages&&!m.value.includes(1)),v=z(()=>p.value>o.maxVisiblePages&&!m.value.includes(p.value)),L=z(()=>_.value&&m.value.length>0&&m.value[0]>2),T=z(()=>v.value&&m.value.length>0&&m.value[m.value.length-1]<p.value-1),E=z(()=>[{label:"5",value:5},{label:"10",value:10},{label:"20",value:20},{label:"50",value:50},{label:"100",value:100}]),x=S=>{S>=1&&S<=p.value&&S!==o.currentPage&&(n("update:currentPage",S),n("pageChange",{page:S,itemsPerPage:o.itemsPerPage,offset:(S-1)*o.itemsPerPage}))},d=()=>{o.currentPage>1&&x(o.currentPage-1)},F=()=>{o.currentPage<p.value&&x(o.currentPage+1)},k=()=>{const S=u.value;n("update:itemsPerPage",S);const C=(o.currentPage-1)*o.itemsPerPage+1,P=Math.ceil(C/S);n("pageChange",{page:P,itemsPerPage:S,offset:(P-1)*S})};return(S,C)=>(a(),i("div",Xn,[e("div",Yn,[e("div",Zn,[t.totalItems>0?(a(),i("span",ea," Showing "+I(y.value)+" to "+I(h.value)+" of "+I(t.totalItems)+" results ",1)):(a(),i("span",ta," No results found "))]),p.value>1?(a(),i("div",sa,[B(g(ve),{theme:"gray",variant:"outline",size:"sm",disabled:t.currentPage===1,onClick:d},{prefix:Q(()=>[B(g(ge),{name:"chevron-left",class:"h-4 w-4"})]),default:Q(()=>[C[3]||(C[3]=se(" Previous "))]),_:1,__:[3]},8,["disabled"]),e("div",oa,[_.value?(a(),ne(g(ve),{key:0,theme:"gray",variant:"outline",size:"sm",class:q({"bg-blue-50 text-blue-600 border-blue-200":t.currentPage!==1,"pagination-active-btn":t.currentPage===1}),onClick:C[0]||(C[0]=P=>x(1))},{default:Q(()=>C[4]||(C[4]=[se(" 1 ")])),_:1,__:[4]},8,["class"])):V("",!0),L.value?(a(),i("span",la,"...")):V("",!0),(a(!0),i(le,null,ae(m.value,P=>(a(),ne(g(ve),{key:P,theme:"gray",variant:"outline",size:"sm",class:q({"bg-blue-50 text-blue-600 border-blue-200":t.currentPage!==P,"pagination-active-btn":t.currentPage===P}),onClick:M=>x(P)},{default:Q(()=>[se(I(P),1)]),_:2},1032,["class","onClick"]))),128)),T.value?(a(),i("span",na,"...")):V("",!0),v.value?(a(),ne(g(ve),{key:3,theme:"gray",variant:"outline",size:"sm",class:q({"bg-blue-50 text-blue-600 border-blue-200":t.currentPage!==p.value,"pagination-active-btn":t.currentPage===p.value}),onClick:C[1]||(C[1]=P=>x(p.value))},{default:Q(()=>[se(I(p.value),1)]),_:1},8,["class"])):V("",!0)]),B(g(ve),{theme:"gray",variant:"outline",size:"sm",disabled:t.currentPage===p.value,onClick:F},{suffix:Q(()=>[B(g(ge),{name:"chevron-right",class:"h-4 w-4"})]),default:Q(()=>[C[5]||(C[5]=se(" Next "))]),_:1,__:[5]},8,["disabled"])])):V("",!0),t.showItemsPerPage?(a(),i("div",aa,[C[6]||(C[6]=e("span",{class:"text-sm text-gray-700"},"Items per page:",-1)),B(g(Ms),{modelValue:u.value,"onUpdate:modelValue":C[2]||(C[2]=P=>u.value=P),options:E.value,onChange:k,class:"w-20"},null,8,["modelValue","options"])])):V("",!0)])]))}},ia=lt(ra,[["__scopeId","data-v-898deb80"]]),ua={class:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-8"},da={class:"text-3xl font-bold text-gray-900"},ca={class:"text-3xl font-bold text-blue-600"},pa={class:"text-3xl font-bold text-green-600"},ga={class:"text-3xl font-bold text-orange-600"},ma={class:"text-3xl font-bold text-purple-600"},va=3e4,fa={__name:"IssueStats",props:{issues:{type:Array,default:()=>[]},activeFilter:{type:String,default:"team_tickets"}},emits:["filter-changed"],setup(t,{expose:s,emit:o}){const n=t,u=o,p=st({team_tickets:0,open_tickets:0,assigned_to_me:0,actionable_tickets:0,response_tickets:0}),y=z(()=>p.value.team_tickets),h=z(()=>p.value.open_tickets),m=z(()=>p.value.assigned_to_me),_=z(()=>p.value.actionable_tickets),v=z(()=>p.value.response_tickets);let L=null,T=0;const E=()=>de(this,null,function*(){const k=Date.now();if(L&&k-T<va)return L;try{const S=yield Oe("force_trans_customization.api.issues.get_issue_stats");return p.value=S,L=S,T=k,S}catch(S){return console.error("Error fetching issue stats:",S),p.value}});let x=null;const d=()=>{x&&clearTimeout(x),x=setTimeout(()=>{E()},500)};Qe(()=>{E()}),$e(()=>n.issues.length,()=>{d()});const F=k=>{u("filter-changed",k)};return s({refreshStats:E}),(k,S)=>(a(),i("div",ua,[e("div",{onClick:S[0]||(S[0]=C=>F("team_tickets")),class:q(["bg-white p-6 rounded-lg shadow-sm border cursor-pointer transition-all duration-200 hover:shadow-md",t.activeFilter==="team_tickets"?"ring-2 ring-gray-500 bg-gray-50":"hover:bg-gray-50"])},[e("div",da,I(y.value),1),S[5]||(S[5]=e("div",{class:"text-sm text-gray-600 mt-1"},"Team Tickets",-1))],2),e("div",{onClick:S[1]||(S[1]=C=>F("open_tickets")),class:q(["bg-white p-6 rounded-lg shadow-sm border cursor-pointer transition-all duration-200 hover:shadow-md",t.activeFilter==="open_tickets"?"ring-2 ring-blue-500 bg-blue-50":"hover:bg-blue-50"])},[e("div",ca,I(h.value),1),S[6]||(S[6]=e("div",{class:"text-sm text-gray-600 mt-1"},"Open Tickets",-1))],2),e("div",{onClick:S[2]||(S[2]=C=>F("assigned_to_me")),class:q(["bg-white p-6 rounded-lg shadow-sm border cursor-pointer transition-all duration-200 hover:shadow-md",t.activeFilter==="assigned_to_me"?"ring-2 ring-green-500 bg-green-50":"hover:bg-green-50"])},[e("div",pa,I(m.value),1),S[7]||(S[7]=e("div",{class:"text-sm text-gray-600 mt-1"},"Assigned To Me",-1))],2),e("div",{onClick:S[3]||(S[3]=C=>F("actionable_tickets")),class:q(["bg-white p-6 rounded-lg shadow-sm border cursor-pointer transition-all duration-200 hover:shadow-md",t.activeFilter==="actionable_tickets"?"ring-2 ring-orange-500 bg-orange-50":"hover:bg-orange-50"]),title:"Tickets where customer awaits our reply"},[e("div",ga,I(_.value),1),S[8]||(S[8]=e("div",{class:"text-sm text-gray-600 mt-1"},"Customers Awaiting Our Reply",-1))],2),e("div",{onClick:S[4]||(S[4]=C=>F("response_tickets")),class:q(["bg-white p-6 rounded-lg shadow-sm border cursor-pointer transition-all duration-200 hover:shadow-md",t.activeFilter==="response_tickets"?"ring-2 ring-purple-500 bg-purple-50":"hover:bg-purple-50"]),title:"Tickets awaiting customer response"},[e("div",ma,I(v.value),1),S[9]||(S[9]=e("div",{class:"text-sm text-gray-600 mt-1"},"Awaiting Response from Customer",-1))],2)]))}},ba={props:["status"],template:`
    <Badge :label="displayStatus" :theme="statusTheme" variant="subtle" />
  `,computed:{displayStatus(){return this.status||"New"},statusTheme(){const t=this.status||"New";return{New:"blue","In Review":"orange",Confirmed:"purple","In Transit":"blue",Delivered:"green",Closed:"green",Open:"red",Replied:"orange","On Hold":"yellow",Resolved:"green"}[t]||"gray"}},components:{Badge:$t}},ya={props:["priority"],template:`
    <div class="flex items-center gap-2">
      <div :class="priorityIndicatorClass" class="w-2 h-2 rounded-full"></div>
      <Badge :label="displayPriority" :theme="priorityTheme" variant="subtle" />
    </div>
  `,computed:{displayPriority(){return this.priority||"Medium"},priorityTheme(){const t=this.priority||"Medium";return{Critical:"red",High:"red",Medium:"yellow",Low:"green"}[t]||"yellow"},priorityIndicatorClass(){const t=this.priority||"Medium";return{"bg-red-500":t==="Critical","bg-red-400":t==="High","bg-yellow-400":t==="Medium","bg-green-400":t==="Low"}}},components:{Badge:$t}},ha={components:{ListView:Fo,Avatar:ao,Badge:$t,Button:ve,FeatherIcon:ge,ListHeader:Zt,ListHeaderItem:Yt,ListRow:Tt,ListRowItem:es,ListRows:ts,ListSelectBanner:ss,StatusBadge:ba,PriorityBadge:ya,Tooltip:qt},props:{issues:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},sortField:{type:String,default:"creation"},sortDirection:{type:String,default:"desc"}},emits:["sort"],setup(t,{emit:s}){const o=D(!1),n=D(null),u=D({x:0,y:0}),p=D(!1),y=D({x:0,y:0}),h=D(null),m=D(!1),_=D({x:0,y:0}),v=D(null),L=R=>{if(!R||typeof R!="string")return"?";if(R.includes("@")){const U=R.split("@")[0];return U.includes(".")||U.includes("_")?U.split(/[._]/).map(O=>O[0]).join("").toUpperCase().slice(0,2):U.slice(0,2).toUpperCase()}return R.includes(" ")?R.split(" ").map(U=>U[0]).join("").toUpperCase().slice(0,2):R.slice(0,2).toUpperCase()},T=R=>{if(!R)return"";const U=R.match(/ISS-(\d{4}-\d+)/);return U?U[1]:R},E=R=>{if(!R)return"";const U=document.createElement("div");return U.innerHTML=R,U.textContent||U.innerText||""},x=R=>R?new Date(R).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-",d=R=>R?new Date(R).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",F=R=>({New:"blue","In Review":"orange",Confirmed:"purple","In Transit":"blue",Delivered:"green",Closed:"green",Open:"red",Replied:"orange","On Hold":"yellow",Resolved:"green"})[R]||"gray",k=R=>({Critical:"red",High:"red",Medium:"yellow",Low:"green"})[R]||"yellow",S=new Map,C=z(()=>t.issues.map(R=>{const U=R.name;if(S.has(U)){const O=S.get(U);if(O.originalStatus===R.status&&O.originalPriority===R.priority&&O.originalSubject===R.subject&&O.originalUsersAssigned===JSON.stringify(R.custom_users_assigned)&&O.originalIsResponseExpected===R.custom_is_response_expected)return O.transformed}const j=ut(Fe({},R),{status:{label:R.status||"New",color:F(R.status)},priority:{label:R.priority||"Medium",color:k(R.priority)}});return S.set(U,{transformed:j,originalStatus:R.status,originalPriority:R.priority,originalSubject:R.subject,originalUsersAssigned:JSON.stringify(R.custom_users_assigned),originalIsResponseExpected:R.custom_is_response_expected}),j})),P=st([{label:"Issue ID",key:"name",width:"90px",sortable:!0},{label:"Title",key:"subject",width:3,sortable:!0},{label:"Status",key:"status",width:"110px",sortable:!0},{label:"Raised By",key:"raised_by",width:"120px",sortable:!0},{label:"Assigned Users",key:"custom_users_assigned",width:"120px",sortable:!1},{label:"CSM Team",key:"custom_assigned_csm_team",width:"100px",sortable:!1},{label:"Tags",key:"_user_tags",width:"100px",sortable:!1},{label:"Created At",key:"creation",width:"90px",sortable:!0}]),M=st({showTooltip:!1,selectable:!0,resizeColumn:!1,rowHeight:60,emptyState:{title:"No tickets found",description:"Try adjusting your search or filter criteria"},onRowClick:R=>{J(R)}}),W=R=>{console.log("Selected rows:",R)},X=R=>`${window.location.origin}/app/issue/${R.name}`,J=R=>{console.log("Issue clicked:",R);const U=X(R);window.open(U,"_blank")},oe=R=>{const U=R||"New";return{"bg-blue-500":U==="New","bg-orange-500":U==="In Review","bg-purple-500":U==="Confirmed","bg-blue-500":U==="In Transit","bg-green-500":U==="Delivered","bg-green-500":U==="Closed","bg-red-500":U==="Open","bg-orange-500":U==="Replied","bg-yellow-500":U==="On Hold","bg-green-500":U==="Resolved"}},ie=R=>{const U=R||"Medium";return{"bg-red-500":U==="Critical"||U==="High","bg-yellow-500":U==="Medium","bg-green-500":U==="Low"}},te=R=>({New:"bg-blue-100 text-blue-800","In Review":"bg-orange-100 text-orange-800",Confirmed:"bg-purple-100 text-purple-800","In Transit":"bg-blue-100 text-blue-800",Delivered:"bg-green-100 text-green-800",Closed:"bg-green-100 text-green-800",Open:"bg-red-100 text-red-800",Replied:"bg-orange-100 text-orange-800","On Hold":"bg-yellow-100 text-yellow-800",Resolved:"bg-green-100 text-green-800"})[R||"New"]||"bg-gray-100 text-gray-800",H=R=>({Critical:"bg-red-100 text-red-800",High:"bg-red-100 text-red-800",Medium:"bg-yellow-100 text-yellow-800",Low:"bg-green-100 text-green-800"})[R||"Medium"]||"bg-yellow-100 text-yellow-800",Y=R=>{const U=R||"Medium";return{"bg-red-500":U==="Critical","bg-red-400":U==="High","bg-yellow-400":U==="Medium","bg-green-400":U==="Low"}},ce=(R,U)=>{const j=R.target.getBoundingClientRect();u.value={x:j.left+j.width/2,y:j.top-10},n.value=U,o.value=!0},N=()=>{o.value=!1,n.value=null},G=(R,U)=>{if(!U||U.length===0)return;const j=R.target.getBoundingClientRect();y.value={x:j.left+j.width/2,y:j.top-10},h.value=U,p.value=!0},ee=()=>{p.value=!1,h.value=null},xe=(R,U)=>{if(!U||!U.subject)return;const j=R.currentTarget.getBoundingClientRect();_.value={x:j.left+j.width/2,y:j.top-10},v.value={subject:U.subject,description:U.description},m.value=!0},be=()=>{m.value=!1,v.value=null},Ae=R=>{let U="asc";t.sortField===R&&(U=t.sortDirection==="asc"?"desc":"asc"),s("sort",{field:R,direction:U})},Pe=R=>t.sortField!==R?"arrow-up-down":t.sortDirection==="asc"?"arrow-up":"arrow-down",Ee=R=>t.sortField!==R?"text-gray-400":"text-blue-600",We=R=>t.sortField===R?"bg-blue-50":"",ke=new Map;return{columns:P,listOptions:M,transformedIssues:C,handleSelections:W,getIssueUrl:X,handleIssueClick:J,getStatusColor:oe,getPriorityColor:ie,getStatusBadgeClass:te,getPriorityBadgeClass:H,getPriorityIndicatorClass:Y,getInitials:L,formatIssueId:T,stripHtml:E,formatDate:x,formatTime:d,showPopup:o,popupUser:n,popupPosition:u,showUserPopup:ce,hideUserPopup:N,handleColumnSort:Ae,getSortIcon:Pe,getSortIconClass:Ee,getSortButtonClass:We,getTagStyle:R=>{if(ke.has(R))return ke.get(R);const U=ns(R);let j;if(U){const O=U.replace("#",""),ye=parseInt(O.substr(0,2),16),ue=parseInt(O.substr(2,2),16),je=parseInt(O.substr(4,2),16),Ne=`rgba(${ye}, ${ue}, ${je}, 0.1)`,Ge=`rgb(${Math.max(ye-50,0)}, ${Math.max(ue-50,0)}, ${Math.max(je-50,0)})`;j={backgroundColor:Ne,color:Ge,borderColor:Ge}}else j={backgroundColor:"#f3f4f6",color:"#374151",borderColor:"#d1d5db"};return ke.set(R,j),j},showTagsPopup:p,tagsPopupPosition:y,tagsPopupData:h,showTagsPopupFn:G,hideTagsPopupFn:ee,showIssueDetailsPopup:m,issueDetailsPopupPosition:_,issueDetailsPopupData:v,showIssueDetailsPopupFn:xe,hideIssueDetailsPopup:be}}},xa={class:"bg-white rounded-lg shadow-sm border"},wa={key:0,class:"px-6 py-12 text-center text-gray-500"},_a=["onClick"],ka=["href","onClick"],Ca=["onMouseenter"],$a={class:"font-medium truncate"},Sa={key:0,class:"relative"},Ia={class:"text-gray-500 text-sm mt-1 truncate max-w-xs"},Ta={class:"text-sm font-medium text-gray-900 truncate block"},Pa={key:3,class:"flex flex-wrap gap-1"},Ea=["onMouseenter"],Ma={key:1,class:"text-gray-400 text-sm"},Ra={class:"text-sm font-medium text-gray-900 truncate block"},Aa=["onMouseenter"],La=["title"],Da={class:"truncate"},ja={key:0,class:"inline-flex items-center px-1 py-1 text-xs font-medium text-gray-500"},Fa={key:1,class:"text-gray-400 text-sm"},Va={key:6,class:"flex flex-col"},Ua={class:"text-sm"},Oa={class:"text-xs text-gray-400"},Ba={key:8},za={class:"flex gap-2"},Ha={class:"text-sm"},Na={class:"font-semibold text-gray-900 mb-1"},Ga={class:"text-gray-600 flex items-center gap-1"},qa={class:"text-xs text-gray-500 mt-1"},Ka={class:"text-sm"},Wa={class:"font-bold text-gray-900 mb-3"},Ja={key:0,class:"text-gray-700 whitespace-pre-wrap max-h-48 overflow-y-auto"},Qa={key:1,class:"text-gray-400 italic"},Xa={class:"text-sm"},Ya={class:"flex flex-wrap gap-1"};function Za(t,s,o,n,u,p){const y=Le("FeatherIcon"),h=Le("ListHeaderItem"),m=Le("ListHeader"),_=Le("Avatar"),v=Le("Tooltip"),L=Le("ListRowItem"),T=Le("ListRow"),E=Le("ListRows"),x=Le("Button"),d=Le("ListSelectBanner"),F=Le("ListView");return a(),i("div",xa,[s[6]||(s[6]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"},"Issues")],-1)),o.loading?(a(),i("div",wa,s[3]||(s[3]=[e("div",{class:"flex items-center justify-center"},[e("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e("span",{class:"ml-2"},"Loading issues...")],-1)]))):(a(),ne(F,{key:1,columns:n.columns,rows:n.transformedIssues,"row-key":"name",options:n.listOptions,"onUpdate:selections":n.handleSelections,class:"p-4"},{default:Q(()=>[B(m,null,{default:Q(()=>[(a(!0),i(le,null,ae(n.columns,k=>(a(),ne(h,{key:k.key,item:k},Rs({_:2},[k.icon?{name:"prefix",fn:Q(({item:S})=>[B(y,{name:S.icon,class:"h-4 w-4"},null,8,["name"])]),key:"0"}:void 0,k.sortable?{name:"suffix",fn:Q(()=>[e("button",{onClick:S=>n.handleColumnSort(k.key),class:q(["ml-2 p-1 rounded hover:bg-gray-100 transition-colors",n.getSortButtonClass(k.key)])},[B(y,{name:n.getSortIcon(k.key),class:q(["h-3 w-3",n.getSortIconClass(k.key)])},null,8,["name","class"])],10,_a)]),key:"1"}:void 0]),1032,["item"]))),128))]),_:1}),B(E,null,{default:Q(()=>[(a(!0),i(le,null,ae(n.transformedIssues,k=>(a(),ne(T,{key:k.name,row:k,class:q({"bg-orange-50 hover:bg-orange-100":k.custom_is_response_expected===1})},{default:Q(({column:S,item:C})=>[B(L,{item:C,align:S.align},{prefix:Q(()=>[S.key==="raised_by"?(a(),ne(_,{key:0,size:"sm",label:n.getInitials(k.raised_by),class:"mr-3"},null,8,["label"])):V("",!0)]),default:Q(()=>{var P;return[S.key==="name"?(a(),i("a",{key:0,href:n.getIssueUrl(k),target:"_blank",class:"text-blue-600 hover:text-blue-800 hover:underline font-medium text-sm",onClick:Ie(M=>n.handleIssueClick(k),["prevent"])},I(n.formatIssueId(C)),9,ka)):S.key==="subject"?(a(),i("div",{key:1,class:"max-w-xs cursor-pointer",onMouseenter:M=>n.showIssueDetailsPopupFn(M,k),onMouseleave:s[0]||(s[0]=(...M)=>n.hideIssueDetailsPopup&&n.hideIssueDetailsPopup(...M))},[e("div",$a,I(k.subject),1),k.description&&k.description.length>0?(a(),i("div",Sa,[e("div",Ia,I(n.stripHtml(k.description)),1)])):V("",!0)],40,Ca)):S.key==="raised_by"?(a(),ne(v,{key:2,text:`Raised By: ${C||"Not assigned"}`},{default:Q(()=>[e("span",Ta,I(C||"-"),1)]),_:2},1032,["text"])):S.key==="custom_users_assigned"?(a(),i("div",Pa,[k.custom_users_assigned&&k.custom_users_assigned.length>0?(a(!0),i(le,{key:0},ae(k.custom_users_assigned.filter(M=>M.user_assigned),M=>(a(),i("div",{key:M.name||M,class:"relative inline-block"},[e("span",{class:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800 cursor-pointer hover:bg-blue-200 transition-colors",onMouseenter:W=>n.showUserPopup(W,M),onMouseleave:s[1]||(s[1]=(...W)=>n.hideUserPopup&&n.hideUserPopup(...W))},I(n.getInitials(M.user_assigned)),41,Ea)]))),128)):(a(),i("span",Ma,"-"))])):S.key==="custom_assigned_csm_team"?(a(),ne(v,{key:4,text:`CSM Team: ${k.custom_assigned_csm_team||"Not assigned"}`},{default:Q(()=>[e("span",Ra,I(k.custom_assigned_csm_team||"-"),1)]),_:2},1032,["text"])):S.key==="_user_tags"?(a(),i("div",{key:5,class:"flex items-center gap-1 cursor-pointer hover:bg-gray-50 p-1 rounded transition-colors",onMouseenter:M=>n.showTagsPopupFn(M,k._user_tags),onMouseleave:s[2]||(s[2]=(...M)=>n.hideTagsPopupFn&&n.hideTagsPopupFn(...M))},[k._user_tags&&k._user_tags.length>0?(a(),i(le,{key:0},[e("span",{style:Be(n.getTagStyle(k._user_tags[0])),class:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full border transition-colors max-w-16",title:k._user_tags[0]},[e("span",Da,I(k._user_tags[0]),1)],12,La),k._user_tags.length>1?(a(),i("span",ja," +"+I(k._user_tags.length-1),1)):V("",!0)],64)):(a(),i("span",Fa,"-"))],40,Aa)):S.key==="creation"?(a(),i("div",Va,[e("span",Ua,I(n.formatDate(C)),1),e("span",Oa,I(n.formatTime(C)),1)])):S.key==="status"?(a(),ne(v,{key:7,text:`Status: ${((P=k.status)==null?void 0:P.label)||k.status||"New"}`},{default:Q(()=>{var M,W;return[e("span",{class:q([n.getStatusBadgeClass(((M=k.status)==null?void 0:M.label)||k.status||"New"),"inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},I(((W=k.status)==null?void 0:W.label)||k.status||"New"),3)]}),_:2},1032,["text"])):(a(),i("span",Ba,I(C),1))]}),_:2},1032,["item","align"])]),_:2},1032,["row","class"]))),128))]),_:1}),B(d,null,{actions:Q(({unselectAll:k})=>[e("div",za,[B(x,{variant:"ghost",label:"Delete"}),B(x,{variant:"ghost",label:"Unselect all",onClick:k},null,8,["onClick"])])]),_:1})]),_:1},8,["columns","rows","options","onUpdate:selections"])),n.showPopup&&n.popupUser&&typeof n.popupUser=="object"?(a(),i("div",{key:2,class:"fixed z-50 bg-white border border-gray-200 rounded-lg shadow-lg p-3 min-w-48",style:Be({left:n.popupPosition.x+"px",top:n.popupPosition.y+"px",transform:"translateX(-50%) translateY(-100%)"})},[e("div",Ha,[e("div",Na,I(n.popupUser.user_assigned||"Unknown User"),1),e("div",Ga,[s[4]||(s[4]=e("span",{class:"inline-block w-2 h-2 bg-blue-500 rounded-full"},null,-1)),se(" "+I(n.popupUser.team||"No Team"),1)]),e("div",qa," Assigned: "+I(n.formatDate(n.popupUser.assigned_date)),1)])],4)):V("",!0),n.showIssueDetailsPopup&&n.issueDetailsPopupData?(a(),i("div",{key:3,class:"fixed z-50 bg-white border border-gray-200 rounded-lg shadow-lg p-4 max-w-md",style:Be({left:n.issueDetailsPopupPosition.x+"px",top:n.issueDetailsPopupPosition.y+"px",transform:"translateX(-50%) translateY(-100%)"})},[e("div",Ka,[e("div",Wa,I(n.issueDetailsPopupData.subject),1),n.issueDetailsPopupData.description?(a(),i("div",Ja,I(n.stripHtml(n.issueDetailsPopupData.description)),1)):(a(),i("div",Qa," No description available "))])],4)):V("",!0),n.showTagsPopup&&n.tagsPopupData?(a(),i("div",{key:4,class:"fixed z-50 bg-white border border-gray-200 rounded-lg shadow-lg p-3 min-w-48 max-w-xs",style:Be({left:n.tagsPopupPosition.x+"px",top:n.tagsPopupPosition.y+"px",transform:"translateX(-50%) translateY(-100%)"})},[e("div",Xa,[s[5]||(s[5]=e("div",{class:"font-semibold text-gray-900 mb-2"},"All Tags",-1)),e("div",Ya,[(a(!0),i(le,null,ae(n.tagsPopupData,k=>(a(),i("span",{key:k,style:Be(n.getTagStyle(k)),class:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full border"},I(k),5))),128))])])],4)):V("",!0)])}const er=lt(ha,[["render",Za]]),tr={class:"fixed top-4 right-4 z-50 space-y-2 max-w-sm"},sr={class:"flex items-start justify-between"},or={class:"flex items-start space-x-3"},lr={class:"flex-shrink-0"},nr={class:"flex-1 min-w-0"},ar={class:"text-sm font-medium text-gray-900"},rr={class:"text-sm text-gray-600 mt-1"},ir={class:"text-xs text-gray-500 mt-1"},ur=["onClick"],dr={__name:"RealTimeNotifications",props:{notifications:{type:Array,default:()=>[]}},emits:["remove"],setup(t){const s=p=>{const y="bg-white/95 border-l-4",h={success:"border-green-500",info:"border-blue-500",warning:"border-yellow-500",error:"border-red-500"};return`${y} ${h[p]||h.info}`},o=p=>{const y={success:"check-circle",info:"info",warning:"alert-triangle",error:"alert-circle"};return y[p]||y.info},n=p=>{const y={success:"text-green-500",info:"text-blue-500",warning:"text-yellow-500",error:"text-red-500"};return y[p]||y.info},u=p=>{const h=new Date-p,m=Math.floor(h/6e4);if(m<1)return"Just now";if(m<60)return`${m}m ago`;const _=Math.floor(m/60);return _<24?`${_}h ago`:p.toLocaleDateString()};return(p,y)=>(a(),i("div",tr,[B(As,{name:"notification",tag:"div"},{default:Q(()=>[(a(!0),i(le,null,ae(t.notifications,h=>(a(),i("div",{key:h.id,class:q([s(h.type),"p-4 rounded-lg shadow-lg border backdrop-blur-sm"])},[e("div",sr,[e("div",or,[e("div",lr,[B(g(ge),{name:o(h.type),class:q([n(h.type),"h-5 w-5"])},null,8,["name","class"])]),e("div",nr,[e("p",ar,I(h.title),1),e("p",rr,I(h.message),1),e("p",ir,I(u(h.timestamp)),1)])]),e("button",{onClick:m=>p.$emit("remove",h.id),class:"flex-shrink-0 ml-3 text-gray-400 hover:text-gray-600 focus:outline-none"},[B(g(ge),{name:"x",class:"h-4 w-4"})],8,ur)])],2))),128))]),_:1})]))}},cr=lt(dr,[["__scopeId","data-v-d57fd7d2"]]),pr=Wt.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",St(this.options.HTMLAttributes,t),0]},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),gr=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,mr=Ls.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:t}){return["img",St(this.options.HTMLAttributes,t)]},addCommands(){return{setImage:t=>({commands:s})=>s.insertContent({type:this.name,attrs:t})}},addInputRules(){return[Ds({find:gr,type:this.type,getAttributes:t=>{const[,,s,o,n]=t;return{src:o,alt:s,title:n}}})]}}),vr=mr.extend({addAttributes(){return{src:{default:null},alt:{default:null},style:{default:"width: 100%; height: auto; cursor: pointer;",parseHTML:t=>{const s=t.getAttribute("width");return s?`width: ${s}px; height: auto; cursor: pointer;`:`${t.style.cssText}`}},title:{default:null},loading:{default:null},srcset:{default:null},sizes:{default:null},crossorigin:{default:null},usemap:{default:null},ismap:{default:null},width:{default:null},height:{default:null},referrerpolicy:{default:null},longdesc:{default:null},decoding:{default:null},class:{default:null},id:{default:null},name:{default:null},draggable:{default:!0},tabindex:{default:null},"aria-label":{default:null},"aria-labelledby":{default:null},"aria-describedby":{default:null}}},addNodeView(){return({node:t,editor:s,getPos:o})=>{const{view:n,options:{editable:u}}=s,{style:p}=t.attrs,y=document.createElement("div"),h=document.createElement("div"),m=document.createElement("img"),_="width: 24px; height: 24px; cursor: pointer;",v=()=>{if(typeof o=="function"){const S=Object.assign(Object.assign({},t.attrs),{style:`${m.style.cssText}`});n.dispatch(n.state.tr.setNodeMarkup(o(),null,S))}},L=()=>{const S=document.createElement("div"),C=document.createElement("img"),P=document.createElement("img"),M=document.createElement("img");S.setAttribute("style","position: absolute; top: 0%; left: 50%; width: 100px; height: 25px; z-index: 999; background-color: rgba(255, 255, 255, 0.7); border-radius: 4px; border: 2px solid #6C6C6C; cursor: pointer; transform: translate(-50%, -50%); display: flex; justify-content: space-between; align-items: center; padding: 0 10px;"),C.setAttribute("src","https://fonts.gstatic.com/s/i/short-term/release/materialsymbolsoutlined/format_align_left/default/20px.svg"),C.setAttribute("style",_),P.setAttribute("src","https://fonts.gstatic.com/s/i/short-term/release/materialsymbolsoutlined/format_align_center/default/20px.svg"),P.setAttribute("style",_),M.setAttribute("src","https://fonts.gstatic.com/s/i/short-term/release/materialsymbolsoutlined/format_align_right/default/20px.svg"),M.setAttribute("style",_),C.addEventListener("click",()=>{y.setAttribute("style","display: flex; justify-content: flex-start;"),m.setAttribute("style",`${m.style.cssText} justify-content: flex-start;`),v()}),P.addEventListener("click",()=>{y.setAttribute("style","display: flex; justify-content: center;"),m.setAttribute("style",`${m.style.cssText} justify-content: center;`),v()}),M.addEventListener("click",()=>{y.setAttribute("style","display: flex; justify-content: flex-end;"),m.setAttribute("style",`${m.style.cssText} justify-content: flex-end;`),v()}),S.appendChild(C),S.appendChild(P),S.appendChild(M),h.appendChild(S)};y.appendChild(h);const T=p.match(/justify-content: (.*?);/);if(y.setAttribute("style",`display: flex; ${T?T[0]:""}`),T&&(m.className=`tiptap-image-${T[1]}`),h.setAttribute("style",`${p}`),h.appendChild(m),Object.entries(t.attrs).forEach(([S,C])=>{C!=null&&m.setAttribute(S,C)}),!u)return{dom:m};const E=["top: -4px; left: -4px; cursor: nwse-resize;","top: -4px; right: -4px; cursor: nesw-resize;","bottom: -4px; left: -4px; cursor: nesw-resize;","bottom: -4px; right: -4px; cursor: nwse-resize;"];let x=!1,d,F,k;return h.addEventListener("click",()=>{if(h.childElementCount>3)for(let S=0;S<5;S++)h.removeChild(h.lastChild);L(),h.setAttribute("style",`position: relative; border: 1px dashed #6C6C6C; ${p} cursor: pointer;`),Array.from({length:4},(S,C)=>{const P=document.createElement("div");P.setAttribute("style",`position: absolute; width: 9px; height: 9px; border: 1.5px solid #6C6C6C; border-radius: 50%; ${E[C]}`),P.addEventListener("mousedown",M=>{M.preventDefault(),x=!0,d=M.clientX,F=h.offsetWidth,k=h.offsetHeight;const W=J=>{if(!x)return;const oe=C%2===0?-(J.clientX-d):J.clientX-d,ie=F/k,te=F+oe,H=te/ie;h.style.width=te+"px",h.style.height=H+"px",m.style.width=te+"px",m.style.height=H+"px"},X=()=>{x&&(x=!1),v(),document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",X)};document.addEventListener("mousemove",W),document.addEventListener("mouseup",X)}),h.appendChild(P)})}),document.addEventListener("click",S=>{const C=S.target;if(!(h.contains(C)||C.style.cssText===_)){const M=h.getAttribute("style"),W=M==null?void 0:M.replace("border: 1px dashed #6C6C6C;","");if(h.setAttribute("style",W),h.childElementCount>3)for(let X=0;X<5;X++)h.removeChild(h.lastChild)}}),{dom:y}}}}),fr=Jt.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:t=>{var s;return(s=t.style.color)===null||s===void 0?void 0:s.replace(/['"]+/g,"")},renderHTML:t=>t.color?{style:`color: ${t.color}`}:{}}}}]},addCommands(){return{setColor:t=>({chain:s})=>s().setMark("textStyle",{color:t}).run(),unsetColor:()=>({chain:t})=>t().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),br=Jt.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:t=>{var s;return(s=t.style.fontFamily)===null||s===void 0?void 0:s.replace(/['"]+/g,"")},renderHTML:t=>t.fontFamily?{style:`font-family: ${t.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:t=>({chain:s})=>s().setMark("textStyle",{fontFamily:t}).run(),unsetFontFamily:()=>({chain:t})=>t().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),yr=/(?:^|\s)((?:==)((?:[^~=]+))(?:==))$/,hr=/(?:^|\s)((?:==)((?:[^~=]+))(?:==))/g,xr=Wt.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:t=>t.getAttribute("data-color")||t.style.backgroundColor,renderHTML:t=>t.color?{"data-color":t.color,style:`background-color: ${t.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:t}){return["mark",St(this.options.HTMLAttributes,t),0]},addCommands(){return{setHighlight:t=>({commands:s})=>s.setMark(this.name,t),toggleHighlight:t=>({commands:s})=>s.toggleMark(this.name,t),unsetHighlight:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[js({find:yr,type:this.type})]},addPasteRules(){return[Fs({find:hr,type:this.type})]}}),wr={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},_r={class:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden"},kr={class:"flex items-center justify-between p-6 border-b border-gray-200"},Cr={class:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]"},$r={class:"space-y-4"},Sr={class:"relative"},Ir={class:"max-h-96 overflow-y-auto border border-gray-200 rounded-lg"},Tr={key:0,class:"p-8 text-center"},Pr={key:1,class:"p-8 text-center text-gray-500"},Er={key:2,class:"divide-y divide-gray-200"},Mr=["onClick"],Rr={class:"flex items-center justify-between"},Ar={class:"flex items-center space-x-3"},Lr=["checked","onChange"],Dr={class:"font-medium text-gray-900"},jr={class:"text-sm text-gray-500"},Fr={key:0,class:"text-xs text-gray-400 mt-1"},Vr={class:"text-right"},Ur={class:"text-sm text-gray-500"},Or={key:0,class:"text-xs text-gray-400"},Br={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},zr={class:"font-medium text-blue-900 mb-2"},Hr={class:"space-y-1"},Nr={class:"text-blue-800"},Gr={class:"text-blue-600"},qr={class:"mt-2 pt-2 border-t border-blue-200"},Kr={class:"font-medium text-blue-900"},Wr={class:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50"},Jr={__name:"GroupSelectorDialog",props:{show:{type:Boolean,default:!1}},emits:["update:show","groups-selected"],setup(t,{emit:s}){const o=t,n=s,u=z({get:()=>o.show,set:C=>n("update:show",C)}),p=D(""),y=D(!1),h=D([]),m=D([]),_=D({}),v=z(()=>{if(!p.value)return h.value;const C=p.value.toLowerCase();return h.value.filter(P=>P.name.toLowerCase().includes(C)||P.description&&P.description.toLowerCase().includes(C))}),L=z(()=>m.value.reduce((C,P)=>C+(P.email_count||0),0)),T=()=>de(this,null,function*(){y.value=!0;try{console.log("Loading email groups from Frappe...");const C=yield Oe("frappe.client.get_list",{doctype:"Email Group",fields:["name","title","total_subscribers","creation","modified"],filters:[["title","not like","temp-grp-%"]],order_by:"modified desc",limit_page_length:100});console.log("Email Groups loaded:",C),h.value=C.map(P=>({name:P.name,title:P.title||P.name,email_count:P.total_subscribers||0,description:"",creation:P.creation,modified:P.modified,emails:[]}))}catch(C){console.error("Error loading email groups:",C),h.value=[]}finally{y.value=!1}}),E=C=>de(this,null,function*(){if(_.value[C])return _.value[C];try{console.log("Loading members for group:",C);const M=(yield Oe("frappe.client.get_list",{doctype:"Email Group Member",fields:["email","email_group"],filters:[["email_group","=",C]],limit_page_length:1e3})).map(W=>W.email);return _.value[C]=M,M}catch(P){return console.error("Error loading group members:",P),[]}}),x=C=>m.value.some(P=>P.name===C.name),d=C=>de(this,null,function*(){const P=m.value.findIndex(M=>M.name===C.name);if(P>-1)m.value.splice(P,1);else{const M=yield E(C.name);m.value.push(ut(Fe({},C),{emails:M}))}}),F=()=>{n("groups-selected",[...m.value]),k()},k=()=>{u.value=!1,m.value=[],p.value=""},S=C=>{if(!C)return"N/A";try{return new Date(C).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(P){return"Invalid Date"}};return Qe(()=>{o.show&&T()}),$e(()=>o.show,C=>{C&&T()}),(C,P)=>u.value?(a(),i("div",wr,[e("div",{class:"fixed inset-0 bg-black bg-opacity-50",onClick:k}),e("div",_r,[e("div",kr,[P[2]||(P[2]=e("h2",{class:"text-lg font-semibold text-gray-900"},"Select Email Groups",-1)),e("button",{onClick:k,class:"text-gray-400 hover:text-gray-600"},[B(g(ge),{name:"x",class:"w-5 h-5"})])]),e("div",Cr,[e("div",$r,[e("div",Sr,[B(g(ge),{name:"search",class:"w-4 h-4 text-gray-400 absolute left-3 top-3"}),re(e("input",{"onUpdate:modelValue":P[0]||(P[0]=M=>p.value=M),type:"text",placeholder:"Search email groups...",class:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[me,p.value]])]),e("div",Ir,[y.value?(a(),i("div",Tr,P[3]||(P[3]=[e("div",{class:"flex items-center justify-center"},[e("div",{class:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500 mr-2"}),se(" Loading email groups... ")],-1)]))):v.value.length===0?(a(),i("div",Pr,[B(g(ge),{name:"inbox",class:"w-8 h-8 mx-auto mb-2 text-gray-300"}),P[4]||(P[4]=e("p",null,"No email groups found",-1)),P[5]||(P[5]=e("p",{class:"text-xs mt-1"},"Create email groups in the system to see them here",-1))])):(a(),i("div",Er,[(a(!0),i(le,null,ae(v.value,M=>(a(),i("div",{key:M.name,class:"p-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:W=>d(M)},[e("div",Rr,[e("div",Ar,[e("input",{type:"checkbox",checked:x(M),onChange:W=>d(M),onClick:P[1]||(P[1]=Ie(()=>{},["stop"])),class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"},null,40,Lr),e("div",null,[e("div",Dr,I(M.title||M.name),1),e("div",jr,I(M.email_count||0)+" recipients ",1),M.description?(a(),i("div",Fr,I(M.description),1)):V("",!0)])]),e("div",Vr,[e("div",Ur," Created: "+I(S(M.creation)),1),M.modified!==M.creation?(a(),i("div",Or," Modified: "+I(S(M.modified)),1)):V("",!0)])])],8,Mr))),128))]))]),m.value.length>0?(a(),i("div",Br,[e("h4",zr,"Selected Groups ("+I(m.value.length)+")",1),e("div",Hr,[(a(!0),i(le,null,ae(m.value,M=>(a(),i("div",{key:M.name,class:"flex items-center justify-between text-sm"},[e("span",Nr,I(M.title||M.name),1),e("span",Gr,I(M.email_count||0)+" recipients",1)]))),128))]),e("div",qr,[e("span",Kr," Total Recipients: "+I(L.value),1)])])):V("",!0)])]),e("div",Wr,[B(g(ve),{onClick:k,variant:"outline"},{default:Q(()=>P[6]||(P[6]=[se(" Cancel ")])),_:1,__:[6]}),B(g(ve),{onClick:F,variant:"solid"},{default:Q(()=>P[7]||(P[7]=[se(" Done ")])),_:1,__:[7]})])])])):V("",!0)}},Qr={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Xr={class:"relative bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden"},Yr={class:"flex items-center justify-between p-6 border-b border-gray-200"},Zr={class:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]"},ei={class:"space-y-6"},ti={class:"flex items-start space-x-2"},si={class:"flex-1"},oi={class:"w-full min-h-[80px] px-3 py-2 border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500"},li={class:"flex flex-wrap gap-2 mb-2"},ni=["onClick"],ai={class:"font-medium"},ri={class:"text-xs text-blue-600"},ii=["onClick"],ui={key:0,class:"absolute z-20 mt-1 p-3 bg-white border border-gray-300 rounded-lg shadow-lg max-w-xs"},di={class:"flex items-center justify-between mb-2"},ci={class:"text-sm font-semibold text-gray-700"},pi=["onClick"],gi={class:"max-h-40 overflow-y-auto space-y-1"},mi={key:0,class:"text-xs text-gray-400 italic"},vi=["title"],fi={key:0,class:"text-red-600"},bi={key:1,class:"text-yellow-600"},yi={key:2,class:"text-green-600"},hi=["onClick"],xi={class:"text-xs text-gray-500 mt-1"},wi={key:0,class:"border border-gray-300 rounded-lg overflow-hidden"},_i={key:0,class:"bg-gray-50 p-2 border-b border-gray-300"},ki={class:"flex flex-wrap gap-1 mb-2"},Ci={class:"relative inline-block"},$i={key:0,class:"absolute z-10 mt-1 p-2 bg-white border border-gray-300 rounded shadow-lg"},Si={class:"relative inline-block"},Ii={key:0,class:"absolute z-10 mt-1 p-2 bg-white border border-gray-300 rounded shadow-lg"},Ti={class:"flex flex-wrap gap-1 mb-2"},Pi={class:"flex flex-wrap gap-1"},Ei=["disabled"],Mi=["disabled"],Ri={key:1},Ai={key:2},Li={class:"border border-gray-300 rounded-lg p-4 bg-gray-50"},Di={key:0,class:"flex flex-wrap gap-2 mb-3"},ji={class:"flex-shrink-0"},Fi={key:0,class:"w-5 h-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Vi={key:1,class:"w-5 h-5 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ui={key:2,class:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Oi={class:"flex-1 min-w-0"},Bi={class:"font-medium text-gray-900 truncate"},zi={class:"text-xs text-gray-500"},Hi=["onClick"],Ni={class:"flex items-center gap-2"},Gi={key:0,class:"text-xs text-gray-500"},qi={class:"bg-gray-50 p-4 rounded-lg"},Ki={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Wi={class:"space-y-3"},Ji={class:"flex items-center"},Qi={class:"flex items-center"},Xi={class:"flex items-center"},Yi={class:"space-y-3"},Zi={class:"flex items-center"},eu={key:0},tu={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},su={key:0},ou={class:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50"},lu={class:"flex items-center space-x-3"},nu={key:1,class:"fixed inset-0 z-50 flex items-center justify-center"},au={class:"relative bg-white rounded-lg shadow-xl max-w-md w-full mx-4"},ru={class:"flex items-center justify-between p-6 border-b border-gray-200"},iu={class:"p-6"},uu={class:"text-sm text-gray-600 mb-4"},du={class:"mb-4"},cu={class:"bg-blue-50 border border-blue-200 rounded-lg p-3"},pu={class:"text-xs text-blue-800 space-y-1 max-h-32 overflow-y-auto"},gu={class:"mt-2 pt-2 border-t border-blue-200 text-sm font-medium text-blue-900"},mu={class:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50"},vu=10*1024*1024,fu={__name:"ComposeEmailDialog",props:{show:{type:Boolean,default:!1}},emits:["update:show","email-sent"],setup(t,{emit:s}){const o=t,n=s,u=z({get:()=>o.show,set:$=>n("update:show",$)}),p=D(!1),y=D(!1),h=D(!1),m=D(!1),_=D(!1),v=D(""),L=D(null),T=D([]),E=D(""),x=D(null),d=Vs({extensions:[Us,pr,vr.configure({inline:!0,allowBase64:!0}),Os.configure({types:["heading","paragraph"]}),Bs,fr,br,xr.configure({multicolor:!0}),zs.configure({resizable:!0}),Hs,Ns,Gs],content:"",editorProps:{attributes:{class:"w-full px-3 py-2 focus:outline-none min-h-[200px] max-h-[400px] overflow-y-auto prose prose-sm max-w-none"}},onUpdate:({editor:$})=>{w.value.message=$.getHTML()}}),F=D(null),k=()=>{const $=prompt("Enter image URL (or paste base64 data URI):");$&&d.value.chain().focus().setImage({src:$}).run()},S=$=>{const l=$.target.files[0];if(l&&l.type.startsWith("image/")){const c=new FileReader;c.onload=K=>{d.value.chain().focus().setImage({src:K.target.result}).run()},c.readAsDataURL(l)}},C=D(!1),P=D(!1),M=D("#000000"),W=D("#ffff00"),X=$=>{d.value.chain().focus().setColor($).run(),C.value=!1},J=$=>{d.value.chain().focus().toggleHighlight({color:$}).run(),P.value=!1},oe=()=>{d.value.chain().focus().insertTable({rows:3,cols:3,withHeaderRow:!0}).run()},ie=D(null),te=D(""),H=D([]),Y=D([]),ce=D([]),N=D(null),G=D([]),ee=$=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test($.trim()),xe=$=>{const l=$.trim();if(!l)return"Email cannot be empty";if(!l.includes("@"))return"Email must contain @ symbol";const c=l.split("@");return c.length!==2?"Email must have exactly one @ symbol":c[0]?c[1]?c[1].includes(".")?c[1].split(".").some(Z=>!Z)?"Domain parts cannot be empty":/\s/.test(l)?"Email cannot contain spaces":"Invalid email format":"Domain must contain a dot (.)":"Email must have a domain after @":"Email must have a username before @"},be=$=>{const l=$.toLowerCase().trim();if(H.value.findIndex(K=>K.address.toLowerCase()===l)>-1)return"Already added manually";for(const K of Y.value)if(K.emails&&K.emails.some(Z=>Z.toLowerCase()===l))return`Already in group: ${K.name}`;return null},Ae=$=>{const l=$.trim();if(!l)return;let c="valid",K="";if(!ee(l))c="invalid",K=xe(l);else{const Z=be(l);Z&&(c="duplicate",K=Z)}H.value.push({address:l,status:c,reason:K}),te.value=""},Pe=$=>{H.value.splice($,1)},Ee=$=>{$.key===","||$.key==="Enter"?($.preventDefault(),Ae(te.value)):$.key==="Backspace"&&te.value===""&&H.value.length>0&&H.value.pop()},We=$=>{var K;$.preventDefault(),(((K=$.clipboardData)==null?void 0:K.getData("text"))||"").split(/[,;\s\n]+/).filter(Z=>Z.trim()).forEach(Z=>{Ae(Z)})},ke=()=>{te.value.trim()&&Ae(te.value)},Se=$=>{const l=ce.value.indexOf($);l>-1?ce.value.splice(l,1):ce.value.push($)},R=$=>{const l=Y.value.findIndex(c=>c.name===$);if(l>-1){Y.value.splice(l,1);const c=ce.value.indexOf($);c>-1&&ce.value.splice(c,1)}w.value.email_group=Y.value.map(c=>({email_group:c.name}))},U=$=>{Array.from($.target.files||[]).forEach(c=>{if(c.size>vu){alert(`File "${c.name}" is too large. Maximum size is 10MB.`);return}if(G.value.some(Z=>Z.name===c.name&&Z.size===c.size)){alert(`File "${c.name}" is already attached.`);return}G.value.push(c)}),N.value&&(N.value.value="")},j=$=>{G.value.splice($,1)},O=$=>{if($===0)return"0 Bytes";const l=1024,c=["Bytes","KB","MB","GB"],K=Math.floor(Math.log($)/Math.log(l));return Math.round($/Math.pow(l,K)*100)/100+" "+c[K]},ye=$=>$.type.startsWith("image/"),ue=$=>$.type==="application/pdf"||$.name.toLowerCase().endsWith(".pdf"),je=z(()=>G.value.reduce(($,l)=>$+l.size,0)),Ne=()=>`temp-grp-${Math.random().toString(36).substring(2,8)}`,Ge=($,l,c=!1)=>de(this,null,function*(){try{console.log(`Creating email group: ${$}`,l);const Z=yield Oe("frappe.client.insert",{doc:{doctype:"Email Group",title:$}});console.log("Email Group created:",Z);for(const we of l){const _e={doctype:"Email Group Member",email_group:Z.name,email:we,unsubscribed:0};yield Oe("frappe.client.insert",{doc:_e})}return console.log(`Added ${l.length} members to group ${$}`),{name:Z.name,title:$,email_count:l.length,emails:l,isTemporary:c}}catch(K){throw console.error("Error creating email group:",K),new Error(`Failed to create email group: ${K.message||K}`)}}),rt=($,l,c)=>{T.value=$,E.value=l,x.value=c,v.value="",_.value=!0,setTimeout(()=>{L.value&&L.value.focus()},100)},r=()=>{_.value=!1,T.value=[],E.value="",x.value=null,v.value=""},b=()=>de(this,null,function*(){if(_.value=!1,x.value){const $=Ne(),l=yield Ge($,T.value,!0);x.value(l)}r()}),f=()=>de(this,null,function*(){if(_.value=!1,x.value){const $=v.value.trim()||Ne(),l=!v.value.trim(),c=yield Ge($,T.value,l);x.value(c)}r()}),w=D({sender_name:"",sender_email:"",send_from:"",email_group:[],subject:"",content_type:"Rich Text",message:"",message_md:"",message_html:"",send_unsubscribe_link:!0,send_webview_link:!1,published:!1,route:"",schedule_sending:!1,schedule_send:"",campaign:"",attachments:[]}),A=z(()=>H.value.filter($=>$.status==="valid").length),pe=z(()=>H.value.filter($=>$.status==="invalid").length),qe=z(()=>H.value.filter($=>$.status==="duplicate").length),et=z(()=>{const $=Y.value.reduce((c,K)=>c+(K.email_count||0),0),l=A.value;return $+l});$e(()=>w.value.content_type,($,l)=>{$!=="Rich Text"&&(w.value.message=""),$!=="Markdown"&&(w.value.message_md=""),$!=="HTML"&&(w.value.message_html="")}),$e(()=>w.value.message,$=>{d.value&&d.value.getHTML()!==$&&d.value.commands.setContent($||"",!1)}),$e(m,$=>{w.value.schedule_sending=$,$||(w.value.schedule_send="")}),$e(()=>w.value.published,$=>{$&&w.value.subject&&!w.value.route?w.value.route=`newsletter/${w.value.subject.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")}`:$||(w.value.route="")});const tt=()=>{u.value=!1},rs=()=>{const $=nt.user||"Administrator",l=$.includes("@")?$:`${$}@yourcompany.com`;w.value={sender_name:$==="Administrator"?"System Administrator":$,sender_email:l,send_from:$==="Administrator"?"System Administrator":$,email_group:[],subject:"",content_type:"Rich Text",message:"",message_md:"",message_html:"",send_unsubscribe_link:!0,send_webview_link:!1,published:!1,route:"",schedule_sending:!1,schedule_send:"",campaign:"",attachments:[]},H.value=[],te.value="",Y.value=[],ce.value=[],m.value=!1,G.value=[],d.value&&d.value.commands.setContent("",!1)},is=$=>{Y.value=$,w.value.email_group=$.map(l=>({email_group:l.name}))},us=()=>de(this,null,function*(){const $=l=>de(this,null,function*(){try{y.value=!0;const c={doctype:"Newsletter",subject:w.value.subject,sender_name:w.value.sender_name||nt.user,sender_email:w.value.sender_email,send_from:w.value.send_from||`${w.value.sender_name} <${w.value.sender_email}>`,content_type:w.value.content_type,message:w.value.message||"",message_md:w.value.message_md||"",message_html:w.value.message_html||"",send_unsubscribe_link:w.value.send_unsubscribe_link?1:0,send_webview_link:w.value.send_webview_link?1:0,published:w.value.published?1:0,route:w.value.route||"",schedule_sending:w.value.schedule_sending?1:0,schedule_send:w.value.schedule_send||null,campaign:w.value.campaign||"",email_group:l.map(Z=>({email_group:Z.name}))};console.log("Saving Newsletter draft:",c);const K=yield Oe("frappe.client.insert",{doc:c});console.log("Newsletter saved:",K),n("email-sent",{type:"success",subject:K.subject,name:K.name,recipientCount:et.value,action:"draft_saved",message:`Newsletter draft "${K.subject}" saved successfully!`}),tt()}catch(c){console.error("Error saving newsletter:",c),n("email-sent",{type:"error",subject:w.value.subject,name:null,recipientCount:0,action:"draft_save_failed",message:`Failed to save newsletter: ${c.message||c}`})}finally{y.value=!1}});try{if(!w.value.subject)throw new Error("Subject is required");if(!w.value.sender_email)throw new Error("Sender Email is required");if(Y.value.length===0&&A.value===0)throw new Error("At least one email group or recipient is required");const l=H.value.filter(_e=>_e.status==="valid").map(_e=>_e.address),c=Y.value.length>0,K=l.length>0;if(c&&!K){yield $(Y.value);return}if(!c&&l.length===1){const _e=Ne(),Te=yield Ge(_e,l,!0);yield $([Te]);return}let Z=[...l],we="";c&&K?(Y.value.forEach(_e=>{_e.emails&&Z.push(..._e.emails)}),Z=[...new Set(Z)],we="You have selected email groups and added individual emails. Would you like to save all recipients as a new group for future use?"):we="Would you like to save these recipients as a group for future use?",rt(Z,we,_e=>de(this,null,function*(){yield $(c?[_e]:[_e])}))}catch(l){console.error("Error in save draft:",l),alert(`Error: ${l.message||l}`),y.value=!1}}),ds=()=>de(this,null,function*(){const $=l=>de(this,null,function*(){try{p.value=!0;const c={doctype:"Newsletter",subject:w.value.subject,sender_name:w.value.sender_name||nt.user,sender_email:w.value.sender_email,send_from:w.value.send_from||`${w.value.sender_name} <${w.value.sender_email}>`,content_type:w.value.content_type,message:w.value.message||"",message_md:w.value.message_md||"",message_html:w.value.message_html||"",send_unsubscribe_link:w.value.send_unsubscribe_link?1:0,send_webview_link:w.value.send_webview_link?1:0,published:w.value.published?1:0,route:w.value.route||"",schedule_sending:w.value.schedule_sending?1:0,schedule_send:w.value.schedule_send||null,campaign:w.value.campaign||"",email_group:l.map(Z=>({email_group:Z.name}))};console.log("Creating Newsletter:",c);let K;try{K=yield Oe("frappe.client.insert",{doc:c})}catch(Z){if(Z.message&&Z.message.includes("DuplicateEntryError")){const we=Date.now();c.subject=`${w.value.subject} (${we})`,K=yield Oe("frappe.client.insert",{doc:c})}else throw Z}console.log("Newsletter saved:",K),console.log("Email groups in newsletter:",l.map(Z=>Z.name));for(const Z of l){console.log(`Checking members for group: ${Z.name}`);try{const we=yield Oe("frappe.client.get_list",{doctype:"Email Group Member",fields:["email","email_group","unsubscribed"],filters:[["email_group","=",Z.name]],limit_page_length:1e3});console.log(`Group ${Z.name} has ${we.length} members:`,we)}catch(we){console.error(`Error checking members for ${Z.name}:`,we)}}w.value.schedule_sending&&w.value.schedule_send?n("email-sent",{type:"info",subject:K.subject,name:K.name,recipientCount:et.value,scheduled:!0,action:"scheduled",message:`Newsletter "${K.subject}" scheduled to send at ${w.value.schedule_send}`}):(console.log("Sending newsletter:",K.name),yield Oe("run_doc_method",{docs:K,method:"send_emails"}),n("email-sent",{type:"success",subject:K.subject,name:K.name,recipientCount:et.value,scheduled:!1,action:"sent",message:`Newsletter "${K.subject}" has been queued for sending to ${et.value} recipients!`})),tt()}catch(c){console.error("Error sending newsletter:",c),n("email-sent",{type:"error",subject:w.value.subject,name:null,recipientCount:0,scheduled:!1,action:"send_failed",message:`Failed to send newsletter: ${c.message||c}`})}finally{p.value=!1}});try{if(!w.value.subject)throw new Error("Subject is required");if(!w.value.sender_email)throw new Error("Sender Email is required");const l={"Rich Text":"message",Markdown:"message_md",HTML:"message_html"}[w.value.content_type];if(!w.value[l])throw new Error("Message content is required");if(Y.value.length===0&&A.value===0)throw new Error("At least one email group or recipient is required");const c=H.value.filter(Te=>Te.status==="valid").map(Te=>Te.address),K=Y.value.length>0,Z=c.length>0;if(K&&!Z){yield $(Y.value);return}if(!K&&c.length===1){const Te=Ne(),Pt=yield Ge(Te,c,!0);yield $([Pt]);return}let we=[...c],_e="";K&&Z?(Y.value.forEach(Te=>{Te.emails&&we.push(...Te.emails)}),we=[...new Set(we)],_e="You have selected email groups and added individual emails. Would you like to save all recipients as a new group for future use?"):_e="Would you like to save these recipients as a group for future use?",rt(we,_e,Te=>de(this,null,function*(){yield $(K?[Te]:[Te])}))}catch(l){console.error("Error in send email:",l),alert(`Error: ${l.message||l}`),p.value=!1}});return $e(()=>o.show,$=>{$&&rs()}),qs(()=>{d.value&&d.value.destroy()}),($,l)=>(a(),i(le,null,[u.value?(a(),i("div",Qr,[e("div",{class:"fixed inset-0 bg-black bg-opacity-50",onClick:tt}),e("div",Xr,[e("div",Yr,[l[44]||(l[44]=e("h2",{class:"text-lg font-semibold text-gray-900"},"Compose Email",-1)),e("button",{onClick:tt,class:"text-gray-400 hover:text-gray-600"},[B(g(ge),{name:"x",class:"w-5 h-5"})])]),e("div",Zr,[e("div",ei,[e("div",null,[l[46]||(l[46]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[se("Recipients "),e("span",{class:"text-red-500"},"*")],-1)),e("div",ti,[e("div",si,[e("div",oi,[e("div",li,[(a(!0),i(le,null,ae(Y.value,c=>(a(),i("div",{key:"group-"+c.name,class:"relative group"},[e("div",{class:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm cursor-pointer hover:bg-blue-200 transition-colors",onClick:K=>Se(c.name)},[B(g(ge),{name:"users",class:"w-3 h-3"}),e("span",ai,I(c.title||c.name),1),e("span",ri,"("+I(c.email_count||0)+")",1),e("button",{type:"button",onClick:Ie(K=>R(c.name),["stop"]),class:"ml-1 hover:bg-blue-300 rounded-full p-0.5"},[B(g(ge),{name:"x",class:"w-3 h-3"})],8,ii)],8,ni),ce.value.includes(c.name)?(a(),i("div",ui,[e("div",di,[e("h4",ci,I(c.title||c.name)+" Members",1),e("button",{type:"button",onClick:K=>Se(c.name),class:"text-gray-400 hover:text-gray-600"},[B(g(ge),{name:"x",class:"w-4 h-4"})],8,pi)]),e("div",gi,[(a(!0),i(le,null,ae(c.emails||[],(K,Z)=>(a(),i("div",{key:Z,class:"text-xs text-gray-600 py-1 px-2 bg-gray-50 rounded"},I(K),1))),128)),!c.emails||c.emails.length===0?(a(),i("div",mi," No members loaded ")):V("",!0)])])):V("",!0)]))),128)),(a(!0),i(le,null,ae(H.value,(c,K)=>(a(),i("div",{key:"email-"+K,class:q(["inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm relative group",c.status==="valid"?"bg-green-100 text-green-800":c.status==="invalid"?"bg-red-100 text-red-800":c.status==="duplicate"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"]),title:c.reason||""},[c.status==="invalid"?(a(),i("span",fi,"⚠️")):V("",!0),c.status==="duplicate"?(a(),i("span",bi,"⚠")):V("",!0),c.status==="valid"?(a(),i("span",yi,"✓")):V("",!0),e("span",null,I(c.address),1),e("button",{type:"button",onClick:Z=>Pe(K),class:q(["hover:bg-opacity-50 rounded-full p-0.5",c.status==="valid"?"hover:bg-green-300":c.status==="invalid"?"hover:bg-red-300":c.status==="duplicate"?"hover:bg-yellow-300":"hover:bg-gray-300"])},[B(g(ge),{name:"x",class:"w-3 h-3"})],10,hi),c.reason?(a(),i("div",{key:3,class:q(["absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-2 text-xs text-white rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-30",[c.status==="invalid"?"bg-red-600":c.status==="duplicate"?"bg-yellow-600":"bg-gray-600"]])},[se(I(c.reason)+" ",1),e("div",{class:q(["absolute top-full left-1/2 -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent",[c.status==="invalid"?"border-t-red-600":c.status==="duplicate"?"border-t-yellow-600":"border-t-gray-600"]])},null,2)],2)):V("",!0)],10,vi))),128))]),re(e("input",{ref_key:"recipientInput",ref:ie,"onUpdate:modelValue":l[0]||(l[0]=c=>te.value=c),onKeydown:Ee,onPaste:We,onBlur:ke,type:"text",placeholder:"Type email and press comma or enter...",class:"w-full outline-none text-sm"},null,544),[[me,te.value]])])]),B(g(ve),{onClick:l[1]||(l[1]=c=>h.value=!0),variant:"outline",size:"sm",class:"mt-1"},{prefix:Q(()=>[B(g(ge),{name:"users",class:"w-4 h-4"})]),default:Q(()=>[l[45]||(l[45]=se(" Select Group "))]),_:1,__:[45]})]),e("p",xi," Total Recipients: "+I(et.value)+" ("+I(A.value)+" valid, "+I(pe.value)+" invalid, "+I(qe.value)+" duplicates) ",1)]),e("div",null,[l[47]||(l[47]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[se("Subject "),e("span",{class:"text-red-500"},"*")],-1)),re(e("input",{"onUpdate:modelValue":l[2]||(l[2]=c=>w.value.subject=c),type:"text",placeholder:"Enter email subject",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},null,512),[[me,w.value.subject]])]),e("div",null,[l[49]||(l[49]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Content Type",-1)),re(e("select",{"onUpdate:modelValue":l[3]||(l[3]=c=>w.value.content_type=c),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},l[48]||(l[48]=[e("option",{value:"Rich Text"},"Rich Text",-1),e("option",{value:"Markdown"},"Markdown",-1),e("option",{value:"HTML"},"HTML",-1)]),512),[[Kt,w.value.content_type]])]),e("div",null,[l[56]||(l[56]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[se("Message "),e("span",{class:"text-red-500"},"*")],-1)),w.value.content_type==="Rich Text"?(a(),i("div",wi,[g(d)?(a(),i("div",_i,[e("div",ki,[e("button",{type:"button",onClick:l[4]||(l[4]=c=>g(d).chain().focus().toggleBold().run()),class:q([{"bg-gray-200":g(d).isActive("bold")},"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100 font-bold"]),title:"Bold (Ctrl+B)"}," B ",2),e("button",{type:"button",onClick:l[5]||(l[5]=c=>g(d).chain().focus().toggleItalic().run()),class:q([{"bg-gray-200":g(d).isActive("italic")},"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100 italic"]),title:"Italic (Ctrl+I)"}," I ",2),e("button",{type:"button",onClick:l[6]||(l[6]=c=>g(d).chain().focus().toggleUnderline().run()),class:q([{"bg-gray-200":g(d).isActive("underline")},"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100 underline"]),title:"Underline (Ctrl+U)"}," U ",2),e("button",{type:"button",onClick:l[7]||(l[7]=c=>g(d).chain().focus().toggleStrike().run()),class:q([{"bg-gray-200":g(d).isActive("strike")},"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100 line-through"]),title:"Strikethrough"}," S ",2),l[51]||(l[51]=e("div",{class:"border-l border-gray-300 mx-1"},null,-1)),e("div",Ci,[e("button",{type:"button",onClick:l[8]||(l[8]=c=>C.value=!C.value),class:"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100 flex items-center gap-1",title:"Text Color"},l[50]||(l[50]=[se(" A "),e("span",{class:"w-4 h-1 bg-current"},null,-1)])),C.value?(a(),i("div",$i,[re(e("input",{type:"color","onUpdate:modelValue":l[9]||(l[9]=c=>M.value=c),onChange:l[10]||(l[10]=c=>X(M.value)),class:"w-20 h-8"},null,544),[[me,M.value]]),e("button",{onClick:l[11]||(l[11]=c=>{g(d).chain().focus().unsetColor().run(),C.value=!1}),class:"mt-1 px-2 py-1 text-xs bg-gray-100 rounded hover:bg-gray-200 w-full"}," Clear ")])):V("",!0)]),e("div",Si,[e("button",{type:"button",onClick:l[12]||(l[12]=c=>P.value=!P.value),class:q([{"bg-gray-200":g(d).isActive("highlight")},"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100"]),title:"Highlight"}," 🎨 ",2),P.value?(a(),i("div",Ii,[re(e("input",{type:"color","onUpdate:modelValue":l[13]||(l[13]=c=>W.value=c),onChange:l[14]||(l[14]=c=>J(W.value)),class:"w-20 h-8"},null,544),[[me,W.value]]),e("button",{onClick:l[15]||(l[15]=c=>{g(d).chain().focus().unsetHighlight().run(),P.value=!1}),class:"mt-1 px-2 py-1 text-xs bg-gray-100 rounded hover:bg-gray-200 w-full"}," Clear ")])):V("",!0)])]),e("div",Ti,[e("button",{type:"button",onClick:l[16]||(l[16]=c=>g(d).chain().focus().toggleHeading({level:1}).run()),class:q([{"bg-gray-200":g(d).isActive("heading",{level:1})},"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100 font-bold"]),title:"Heading 1"}," H1 ",2),e("button",{type:"button",onClick:l[17]||(l[17]=c=>g(d).chain().focus().toggleHeading({level:2}).run()),class:q([{"bg-gray-200":g(d).isActive("heading",{level:2})},"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100 font-bold"]),title:"Heading 2"}," H2 ",2),e("button",{type:"button",onClick:l[18]||(l[18]=c=>g(d).chain().focus().toggleHeading({level:3}).run()),class:q([{"bg-gray-200":g(d).isActive("heading",{level:3})},"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100 font-bold"]),title:"Heading 3"}," H3 ",2),e("button",{type:"button",onClick:l[19]||(l[19]=c=>g(d).chain().focus().setParagraph().run()),class:q([{"bg-gray-200":g(d).isActive("paragraph")},"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100"]),title:"Paragraph"}," P ",2),l[52]||(l[52]=e("div",{class:"border-l border-gray-300 mx-1"},null,-1)),e("button",{type:"button",onClick:l[20]||(l[20]=c=>g(d).chain().focus().setTextAlign("left").run()),class:q([{"bg-gray-200":g(d).isActive({textAlign:"left"})},"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100"]),title:"Align Left"}," ⫷ ",2),e("button",{type:"button",onClick:l[21]||(l[21]=c=>g(d).chain().focus().setTextAlign("center").run()),class:q([{"bg-gray-200":g(d).isActive({textAlign:"center"})},"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100"]),title:"Align Center"}," ≡ ",2),e("button",{type:"button",onClick:l[22]||(l[22]=c=>g(d).chain().focus().setTextAlign("right").run()),class:q([{"bg-gray-200":g(d).isActive({textAlign:"right"})},"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100"]),title:"Align Right"}," ⫸ ",2),e("button",{type:"button",onClick:l[23]||(l[23]=c=>g(d).chain().focus().setTextAlign("justify").run()),class:q([{"bg-gray-200":g(d).isActive({textAlign:"justify"})},"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100"]),title:"Justify"}," ▤ ",2)]),e("div",Pi,[e("button",{type:"button",onClick:l[24]||(l[24]=c=>g(d).chain().focus().toggleBulletList().run()),class:q([{"bg-gray-200":g(d).isActive("bulletList")},"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100"]),title:"Bullet List"}," • ",2),e("button",{type:"button",onClick:l[25]||(l[25]=c=>g(d).chain().focus().toggleOrderedList().run()),class:q([{"bg-gray-200":g(d).isActive("orderedList")},"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100"]),title:"Numbered List"}," 1. ",2),e("button",{type:"button",onClick:l[26]||(l[26]=c=>g(d).chain().focus().toggleBlockquote().run()),class:q([{"bg-gray-200":g(d).isActive("blockquote")},"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100"]),title:"Quote"},' " ',2),e("button",{type:"button",onClick:l[27]||(l[27]=c=>g(d).chain().focus().toggleCodeBlock().run()),class:q([{"bg-gray-200":g(d).isActive("codeBlock")},"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100 font-mono"]),title:"Code Block"}," </> ",2),l[53]||(l[53]=e("div",{class:"border-l border-gray-300 mx-1"},null,-1)),e("button",{type:"button",onClick:l[28]||(l[28]=c=>$.$refs.imageInput.click()),class:"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100",title:"Upload Image"}," 📷 "),e("input",{ref_key:"imageInput",ref:F,type:"file",accept:"image/*",onChange:S,class:"hidden"},null,544),e("button",{type:"button",onClick:k,class:"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100",title:"Insert Image URL"}," 🖼️ "),e("button",{type:"button",onClick:oe,class:"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100",title:"Insert Table"}," ⊞ "),l[54]||(l[54]=e("div",{class:"border-l border-gray-300 mx-1"},null,-1)),e("button",{type:"button",onClick:l[29]||(l[29]=c=>g(d).chain().focus().setHorizontalRule().run()),class:"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100",title:"Horizontal Line"}," — "),l[55]||(l[55]=e("div",{class:"border-l border-gray-300 mx-1"},null,-1)),e("button",{type:"button",onClick:l[30]||(l[30]=c=>g(d).chain().focus().undo().run()),disabled:!g(d).can().undo(),class:"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",title:"Undo"}," ↶ ",8,Ei),e("button",{type:"button",onClick:l[31]||(l[31]=c=>g(d).chain().focus().redo().run()),disabled:!g(d).can().redo(),class:"px-3 py-1 text-sm border border-gray-200 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",title:"Redo"}," ↷ ",8,Mi)])])):V("",!0),B(g(Ks),{editor:g(d),class:"tiptap-editor"},null,8,["editor"])])):w.value.content_type==="Markdown"?(a(),i("div",Ri,[re(e("textarea",{"onUpdate:modelValue":l[32]||(l[32]=c=>w.value.message_md=c),placeholder:"Compose your email message in Markdown...",rows:"10",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm"},null,512),[[me,w.value.message_md]])])):w.value.content_type==="HTML"?(a(),i("div",Ai,[re(e("textarea",{"onUpdate:modelValue":l[33]||(l[33]=c=>w.value.message_html=c),placeholder:"Compose your email message in HTML...",rows:"10",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm"},null,512),[[me,w.value.message_html]])])):V("",!0)]),e("div",null,[l[62]||(l[62]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Attachments",-1)),e("div",Li,[G.value.length>0?(a(),i("div",Di,[(a(!0),i(le,null,ae(G.value,(c,K)=>(a(),i("div",{key:"attachment-"+K,class:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded-lg text-sm hover:bg-gray-50 transition-colors"},[e("div",ji,[ye(c)?(a(),i("svg",Fi,l[57]||(l[57]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"},null,-1)]))):ue(c)?(a(),i("svg",Vi,l[58]||(l[58]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)]))):(a(),i("svg",Ui,l[59]||(l[59]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)])))]),e("div",Oi,[e("div",Bi,I(c.name),1),e("div",zi,I(O(c.size)),1)]),e("button",{type:"button",onClick:Z=>j(K),class:"flex-shrink-0 text-gray-400 hover:text-red-600 transition-colors",title:"Remove attachment"},[B(g(ge),{name:"x",class:"w-4 h-4"})],8,Hi)]))),128))])):V("",!0),e("div",Ni,[e("input",{ref_key:"attachmentInput",ref:N,type:"file",multiple:"",onChange:U,class:"hidden"},null,544),B(g(ve),{onClick:l[34]||(l[34]=c=>$.$refs.attachmentInput.click()),variant:"outline",size:"sm"},{prefix:Q(()=>[B(g(ge),{name:"paperclip",class:"w-4 h-4"})]),default:Q(()=>[l[60]||(l[60]=se(" Add Attachments "))]),_:1,__:[60]}),G.value.length>0?(a(),i("span",Gi,I(G.value.length)+" file"+I(G.value.length!==1?"s":"")+" ("+I(O(je.value))+") ",1)):V("",!0)]),l[61]||(l[61]=e("p",{class:"text-xs text-gray-500 mt-2"}," Maximum file size: 10MB per file. Supported formats: All common file types. ",-1))])]),e("div",qi,[l[68]||(l[68]=e("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Email Options",-1)),e("div",Ki,[e("div",Wi,[e("label",Ji,[re(e("input",{type:"checkbox","onUpdate:modelValue":l[35]||(l[35]=c=>w.value.send_unsubscribe_link=c),class:"mr-2"},null,512),[[ct,w.value.send_unsubscribe_link]]),l[63]||(l[63]=e("span",{class:"text-sm text-gray-700"},"Send Unsubscribe Link",-1))]),e("label",Qi,[re(e("input",{type:"checkbox","onUpdate:modelValue":l[36]||(l[36]=c=>w.value.send_webview_link=c),class:"mr-2"},null,512),[[ct,w.value.send_webview_link]]),l[64]||(l[64]=e("span",{class:"text-sm text-gray-700"},"Send Web View Link",-1))]),e("label",Xi,[re(e("input",{type:"checkbox","onUpdate:modelValue":l[37]||(l[37]=c=>w.value.published=c),class:"mr-2"},null,512),[[ct,w.value.published]]),l[65]||(l[65]=e("span",{class:"text-sm text-gray-700"},"Publish as Web Page",-1))])]),e("div",Yi,[e("label",Zi,[re(e("input",{type:"checkbox","onUpdate:modelValue":l[38]||(l[38]=c=>m.value=c),class:"mr-2"},null,512),[[ct,m.value]]),l[66]||(l[66]=e("span",{class:"text-sm text-gray-700"},"Schedule sending at a later time",-1))]),m.value?(a(),i("div",eu,[l[67]||(l[67]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Send Email At",-1)),re(e("input",{"onUpdate:modelValue":l[39]||(l[39]=c=>w.value.schedule_send=c),type:"datetime-local",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[me,w.value.schedule_send]])])):V("",!0)])])]),e("div",tu,[e("div",null,[l[69]||(l[69]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Campaign (Optional)",-1)),re(e("input",{"onUpdate:modelValue":l[40]||(l[40]=c=>w.value.campaign=c),type:"text",placeholder:"Enter campaign name",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[me,w.value.campaign]])]),w.value.published?(a(),i("div",su,[l[70]||(l[70]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Route",-1)),re(e("input",{"onUpdate:modelValue":l[41]||(l[41]=c=>w.value.route=c),type:"text",placeholder:"e.g., newsletter/my-newsletter",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[me,w.value.route]])])):V("",!0)])])]),e("div",ou,[B(g(ve),{onClick:tt,variant:"outline"},{default:Q(()=>l[71]||(l[71]=[se(" Cancel ")])),_:1,__:[71]}),e("div",lu,[B(g(ve),{onClick:us,variant:"outline",loading:y.value},{prefix:Q(()=>[B(g(ge),{name:"save",class:"w-4 h-4"})]),default:Q(()=>[l[72]||(l[72]=se(" Save Draft "))]),_:1,__:[72]},8,["loading"]),B(g(ve),{onClick:ds,variant:"solid",loading:p.value},{default:Q(()=>[se(I(m.value?"Schedule Email":"Send Email"),1)]),_:1},8,["loading"])])])])])):V("",!0),B(Jr,{show:h.value,"onUpdate:show":l[42]||(l[42]=c=>h.value=c),onGroupsSelected:is},null,8,["show"]),_.value?(a(),i("div",nu,[e("div",{class:"fixed inset-0 bg-black bg-opacity-50",onClick:r}),e("div",au,[e("div",ru,[l[73]||(l[73]=e("h2",{class:"text-lg font-semibold text-gray-900"},"Save Email Group",-1)),e("button",{onClick:r,class:"text-gray-400 hover:text-gray-600"},[B(g(ge),{name:"x",class:"w-5 h-5"})])]),e("div",iu,[e("p",uu,I(E.value),1),e("div",du,[l[74]||(l[74]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Group Name (Optional) ",-1)),re(e("input",{ref_key:"groupNameInput",ref:L,"onUpdate:modelValue":l[43]||(l[43]=c=>v.value=c),type:"text",placeholder:"e.g., Marketing Team",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",onKeydown:Ue(f,["enter"])},null,544),[[me,v.value]]),l[75]||(l[75]=e("p",{class:"text-xs text-gray-500 mt-1"}," Leave empty to create a temporary group ",-1))]),e("div",cu,[l[76]||(l[76]=e("h4",{class:"text-sm font-medium text-blue-900 mb-2"},"Recipients to be saved:",-1)),e("div",pu,[(a(!0),i(le,null,ae(T.value,c=>(a(),i("div",{key:c,class:"py-1"},I(c),1))),128))]),e("div",gu," Total: "+I(T.value.length)+" recipients ",1)])]),e("div",mu,[B(g(ve),{onClick:r,variant:"outline"},{default:Q(()=>l[77]||(l[77]=[se(" Cancel ")])),_:1,__:[77]}),B(g(ve),{onClick:b,variant:"outline"},{default:Q(()=>l[78]||(l[78]=[se(" Skip (Create Temporary) ")])),_:1,__:[78]}),B(g(ve),{onClick:f,variant:"solid"},{default:Q(()=>[se(I(v.value?"Save Group":"Continue"),1)]),_:1})])])])):V("",!0)],64))}};function bu(t,s){let o;return function(...u){const p=()=>{clearTimeout(o),t(...u)};clearTimeout(o),o=setTimeout(p,s)}}function yu(){const t=D(""),s=D({status:"",priority:"",assignee:"",tags:"",sortBy:"creation desc"}),o=D(""),n=bu(E=>{o.value=E},300);$e(t,E=>{n(E)});const u=z(()=>{const E={};return o.value.trim()&&(E.subject=["like",`%${o.value.trim()}%`]),s.value.status&&(E.status=s.value.status),s.value.priority&&(E.priority=s.value.priority),s.value.assignee&&(E.raised_by=s.value.assignee),s.value.tags&&(E.issue_type=s.value.tags),E}),p=z(()=>s.value.sortBy||"creation desc"),y=new Map,h=E=>{if(!E||!Array.isArray(E))return[];const x=JSON.stringify({issuesLength:E.length,searchQuery:t.value.trim(),status:s.value.status,priority:s.value.priority,assignee:s.value.assignee,tags:s.value.tags,sortBy:s.value.sortBy});if(y.has(x))return y.get(x);let d=[...E];if(t.value.trim()){const k=t.value.toLowerCase().trim();d=d.filter(S=>{const C=(S.subject||"").toLowerCase(),P=(S.description||"").toLowerCase();return C.includes(k)||P.includes(k)})}s.value.status&&(d=d.filter(k=>k.status===s.value.status)),s.value.priority&&(d=d.filter(k=>k.priority===s.value.priority)),s.value.assignee&&(d=d.filter(k=>k.raised_by===s.value.assignee)),s.value.tags&&(d=d.filter(k=>k.issue_type===s.value.tags));const F=Xe({Critical:4,High:3,Medium:2,Low:1});if(d.sort((k,S)=>{const[C,P]=s.value.sortBy.split(" "),M=k[C]||"",W=S[C]||"";let X=0;return C==="creation"||C==="modified"?X=new Date(M)-new Date(W):C==="priority"?X=(F[M]||0)-(F[W]||0):X=M.toString().localeCompare(W.toString()),P==="desc"?-X:X}),y.size>50){const k=y.keys().next().value;y.delete(k)}return y.set(x,d),d};let m=null,_=null;const v=E=>{if(!E||!Array.isArray(E))return Xe([{label:"All Assignees",value:""}]);const x=E.map(k=>k.raised_by).filter(k=>k&&k.trim()).sort().join("|");if(m&&_===x)return m;const d=[...new Set(E.map(k=>k.raised_by).filter(k=>k&&k.trim()))],F=Xe([{label:"All Assignees",value:""},...d.map(k=>({label:k,value:k}))]);return m=F,_=x,F},L=()=>{t.value="",o.value="",s.value={status:"",priority:"",assignee:"",tags:"",sortBy:"creation desc"}},T=z(()=>t.value.trim()!==""||s.value.status!==""||s.value.priority!==""||s.value.assignee!==""||s.value.tags!==""||s.value.sortBy!=="creation desc");return{searchQuery:t,filters:s,debouncedSearchQuery:o,apiFilters:u,sortOrder:p,hasActiveFilters:T,filterIssues:h,getAssigneeOptions:v,resetFilters:L}}function hu(t,s,o){const n=Ws(),u=D([]),p=D(!1),y=D(!1);let h=null;const m=y.value?15e3:2e3,_=()=>{console.log(`⏰ Setting up debounced refresh with ${m}ms delay`),h&&(clearTimeout(h),console.log("🔄 Cleared existing debounce timer")),h=setTimeout(()=>{console.log("⏰ Debounce timer fired, calling processDocumentRefreshes"),T()},m)},v=()=>{if(!n||p.value)return;n.emit("doctype_subscribe","Issue"),n.off("list_update"),n.on("list_update",J=>{try{if(console.log("📡 Received list_update event:",J),(J==null?void 0:J.doctype)!=="Issue")return;if(F()){console.log("⏸️ Skipping realtime update (avoid condition met)");return}if(J.action==="insert"||J.action==="create"){console.log("📝 Skipping new issue creation update:",J.name);return}console.log("✅ Adding to pending refreshes:",J.name),u.value.push(J),_()}catch(oe){console.error("❌ Error processing list_update event:",oe)}}),["doctype_update","Issue_update","Issue_create","Issue_delete"].forEach(J=>{n.on(J,oe=>{if((oe==null?void 0:oe.doctype)!=="Issue"||F())return;const ie={doctype:"Issue",name:oe.name,action:J.includes("create")?"insert":J.includes("delete")?"delete":"update",modified_by:oe.modified_by||oe.owner,timestamp:new Date().toISOString()};if(ie.action==="insert"){console.log("📝 Skipping new issue creation update:",oe.name);return}u.value.push(ie),_()})}),p.value=!0},L=()=>{if(!n||!p.value)return;n.emit("doctype_unsubscribe","Issue"),n.off("list_update"),["doctype_update","Issue_update","Issue_create","Issue_delete"].forEach(J=>{n.off(J)}),p.value=!1},T=()=>de(this,null,function*(){if(console.log("🔄 processDocumentRefreshes called with",u.value.length,"pending refreshes"),!u.value.length){console.log("⏸️ No pending refreshes, returning early");return}const X=window.location.hash||window.location.pathname;if(console.log("🛣️ Current route:",X),!X.includes("issue-tracker")&&!X.includes("issues")&&!X.includes("frontend")){console.log("❌ Not on correct route, clearing pending refreshes and disabling updates"),u.value=[],L();return}console.log("✅ Route check passed, proceeding with refresh");const J=[...new Set(u.value.map(ie=>ie.name))],oe=J.length;console.log(`🔄 Processing ${oe} document refreshes:`,J),u.value=[];try{yield E(J),window&&typeof window.dispatchEvent=="function"&&window.dispatchEvent(new CustomEvent("issueListUpdated",{detail:{count:oe,documents:J}})),console.log(`✅ Successfully processed ${oe} document refreshes`)}catch(ie){console.error("❌ Error updating individual rows, falling back to full refresh:",ie);try{s&&typeof s=="function"?(console.log("🔄 Using custom refresh function for fallback"),yield s()):(console.log("🔄 Using default refresh functions for fallback"),yield at(),yield bt()),console.log("✅ Fallback refresh completed successfully")}catch(te){console.error("❌ Error in fallback refresh:",te)}}}),E=X=>de(this,null,function*(){try{const{activeResource:J,currentData:oe}=x();if(!oe||!Array.isArray(oe)){console.log("📋 No current data available, falling back to custom refresh"),s&&typeof s=="function"&&(yield s());return}let ie={limit_page_length:10,limit_start:0,filters:{},order_by:"creation desc"};if(t&&typeof t=="function")try{const Y=t();Y&&(ie=Fe(Fe({},ie),Y))}catch(Y){console.warn("Error getting current parameters, using defaults:",Y)}const te=oe.map(Y=>Y.name),H=X.filter(Y=>te.includes(Y));if(H.length===0){console.log("📋 Updated issues not visible on current page, skipping grid update");return}console.log(`🔄 Updating ${H.length} visible issues:`,H),yield d(H,J,oe)}catch(J){throw console.error("Error during targeted refresh:",J),s&&typeof s=="function"&&(yield s()),J}}),x=()=>{if(o&&typeof o=="function")try{const te=o();if(te)return console.log(`📊 Using ${te.resourceType} resource for updates (from parent)`),te}catch(te){console.warn("Error getting resource state from parent, falling back to detection:",te)}const X=Re.data&&Array.isArray(Re.data)&&Re.data.length>0,J=Me.data&&Array.isArray(Me.data)&&Me.data.length>0;if(X&&!J)return console.log("📊 Using statFilterResource for updates (only stat has data)"),{activeResource:Re,currentData:Re.data,resourceType:"stat"};if(J&&!X)return console.log("📋 Using issuesResource for updates (only issues has data)"),{activeResource:Me,currentData:Me.data,resourceType:"main"};const oe=Re.lastLoaded||0,ie=Me.lastLoaded||0;return X&&oe>=ie?(console.log("📊 Using statFilterResource for updates (more recent)"),{activeResource:Re,currentData:Re.data,resourceType:"stat"}):(console.log("📋 Using issuesResource for updates (default)"),{activeResource:Me,currentData:Me.data||[],resourceType:"main"})},d=(X,J,oe)=>de(this,null,function*(){try{const te=(yield Promise.all(X.map(H=>de(this,null,function*(){try{return yield Vo(H),ls.data}catch(Y){return console.warn(`Failed to fetch updated issue ${H}:`,Y),null}})))).filter(H=>H!==null);if(te.length===0){console.warn("No valid updated issues fetched, falling back to custom refresh"),s&&typeof s=="function"&&(yield s());return}if(J.data&&Array.isArray(J.data))console.log(`🔄 Updating ${te.length} issues in ${J.data.length} total issues`),te.forEach(H=>{const Y=J.data.findIndex(ce=>ce.name===H.name);Y!==-1?(console.log(`✅ Updating issue at index ${Y}: ${H.name}`),Object.assign(J.data[Y],H)):console.warn(`⚠️ Issue ${H.name} not found in current data for update`)});else{console.warn("⚠️ activeResource.data is not an array, using fallback method");const H=[...oe];te.forEach(Y=>{const ce=H.findIndex(N=>N.name===Y.name);ce!==-1?(console.log(`✅ Updating issue at index ${ce}: ${Y.name} (fallback)`),H[ce]=Y):console.warn(`⚠️ Issue ${Y.name} not found in current data for update (fallback)`)}),J.data=H}console.log(`🎯 Successfully updated ${te.length} issues in current view`)}catch(ie){console.error("Error updating visible issues in place:",ie),s&&typeof s=="function"&&(yield s())}}),F=()=>!!document.hidden,k=D(!1),S=()=>{document.hidden?k.value=!0:k.value&&(k.value=!1,console.log("🔄 Page came back into focus - refreshing Issue table"),u.value.length>0?(console.log(`📋 Processing ${u.value.length} pending updates`),T()):C())},C=()=>{u.value=[];try{s&&typeof s=="function"?s():(at(),bt())}catch(X){console.error("Error during manual refresh:",X)}},P=()=>{v()},M=()=>{p.value=!1},W=X=>{console.error("Socket connection error:",X),p.value=!1};return Qe(()=>{n&&(n.on("connect",P),n.on("disconnect",M),n.on("connect_error",W),document.addEventListener("visibilitychange",S),n.connected&&v())}),ht(()=>{n&&(n.off("connect",P),n.off("disconnect",M),n.off("connect_error",W)),document.removeEventListener("visibilitychange",S),L(),h&&clearTimeout(h)}),{pendingDocumentRefreshes:u,realtimeEventsSetup:p,setupRealtimeUpdates:v,disableRealtimeUpdates:L,manualRefresh:C,processDocumentRefreshes:T}}const xu={class:"min-h-screen bg-gray-50"},wu={class:"bg-white shadow-sm border-b"},_u={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},ku={class:"flex justify-between items-center py-4"},Cu={class:"flex items-center space-x-4"},$u={class:"flex space-x-4"},Su={class:"flex items-center space-x-4"},Iu={class:"text-sm text-gray-600"},Tu={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Pu={class:"fixed top-20 right-4 flex flex-col space-y-2"},Eu=["title"],Mu={class:"relative"},Ru={key:0,class:"absolute -top-2 -right-2 bg-orange-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-medium animate-bounce"},ju={__name:"IssueTracker",setup(t){const{searchQuery:s,filters:o,debouncedSearchQuery:n,apiFilters:u,sortOrder:p,getAssigneeOptions:y}=yu(),h=D(!1),m=D("team_tickets"),_=D(null),v=()=>{console.log("Refreshing current view:",{isUsingStatFilter:h.value,currentStatFilter:m.value,hasCustomFilters:H.value&&H.value.length>0});const j={limit_page_length:Se.value,limit_start:(ke.value-1)*Se.value,order_by:p.value};h.value?(H.value&&H.value.length>0&&(j.filters=JSON.stringify(H.value)),Promise.all([_t(m.value,j),H.value&&H.value.length>0?vt(m.value,JSON.stringify(H.value)):vt(m.value)]).then(()=>{console.log("Stat filter view refreshed successfully")}).catch(O=>{console.error("Error refreshing stat filter view:",O)})):Promise.all([at(Fe({filters:JSON.stringify(H.value)},j)),bt(JSON.stringify(H.value))]).then(()=>{console.log("Regular filter view refreshed successfully")}).catch(O=>{console.error("Error refreshing regular filter view:",O)})},{pendingDocumentRefreshes:L,realtimeEventsSetup:T,manualRefresh:E}=hu(()=>({filters:U.value,order_by:p.value,limit_page_length:Se.value,limit_start:(ke.value-1)*Se.value}),v,()=>h.value?{activeResource:Re,currentData:Re.data||[],resourceType:"stat"}:{activeResource:Me,currentData:Me.data||[],resourceType:"main"}),x=()=>{v()},d=D([]),F=D(!1),k=j=>{d.value.push(Fe({id:Date.now()+Math.random()},j)),setTimeout(()=>{var O;S((O=d.value[d.value.length-1])==null?void 0:O.id)},5e3)},S=j=>{d.value=d.value.filter(O=>O.id!==j)},C=j=>{const O={sent:"Email Sent",scheduled:"Email Scheduled",draft_saved:"Draft Saved",send_failed:"Send Failed",draft_save_failed:"Save Failed"};k({type:j.type||"success",title:O[j.action]||"Email Action",message:j.message||`Email "${j.subject}" sent successfully to ${j.recipientCount} recipients`,timestamp:new Date}),j.type!=="error"&&(F.value=!1)},P=z(()=>h.value?Re.data||[]:Me.data||[]),M=z(()=>h.value?as.data||0:os.data||0),W=z(()=>h.value?Re.loading:Me.loading),X=z(()=>P.value),J=z(()=>(p.value||"creation desc").split(" ")[0]),oe=z(()=>(p.value||"creation desc").split(" ")[1]||"desc"),ie=({field:j,direction:O})=>{const ye=`${j} ${O}`;o.value.sortBy=ye,ke.value=1,v()},te=j=>{},H=D([]),Y=j=>{console.log("Filters applied:",j),H.value=j,ke.value=1,j&&j.length>0?h.value?(console.log("Applying custom filters on top of card filter:",m.value),ee(m.value)):(console.log("Applying custom filters in regular mode"),ce()):(console.log("No filters applied, returning to default view"),N())},ce=()=>{h.value=!1,m.value="team_tickets",Promise.all([at({filters:JSON.stringify(H.value),order_by:p.value,limit_page_length:Se.value,limit_start:0}),bt(JSON.stringify(H.value))]).then(()=>{console.log("Custom filters applied successfully")}).catch(j=>{console.error("Error applying custom filters:",j)})},N=()=>{h.value=!0,m.value="team_tickets",ee("team_tickets")},G=j=>{console.log("Card clicked:",j,"Current filters:",H.value),h.value=!0,m.value=j,s.value="",ke.value=1,ee(j)},ee=j=>{const O={limit_page_length:Se.value,limit_start:0,order_by:p.value};H.value&&H.value.length>0?(O.filters=JSON.stringify(H.value),console.log("Applying card filter with custom filters:",j,H.value)):console.log("Applying card filter without custom filters:",j),Promise.all([_t(j,O),H.value&&H.value.length>0?vt(j,JSON.stringify(H.value)):vt(j)]).then(()=>{console.log("Card filter applied successfully")}).catch(ye=>{console.error("Error applying card filter:",ye)})},xe=st(Xe(Bo())),be=st(Xe(zo())),Ae=st(Xe(No()));let Pe=null,Ee=0;const We=z(()=>{const j=P.value.length;return Pe&&Ee===j||(Pe=Xe(y(P.value)),Ee=j),Pe}),ke=D(1),Se=D(10),R=({page:j,itemsPerPage:O,offset:ye})=>{console.log("Page change:",{page:j,newItemsPerPage:O,offset:ye}),ke.value=j,Se.value=O;const ue={limit_page_length:O,limit_start:ye,order_by:p.value};h.value?(H.value&&H.value.length>0&&(ue.filters=JSON.stringify(H.value)),_t(m.value,ue).then(()=>{console.log("Pagination completed successfully (stat filter)")}).catch(je=>{console.error("Error during pagination (stat filter):",je)})):at(Fe({filters:JSON.stringify(H.value)},ue)).then(()=>{console.log("Pagination completed successfully (regular filter)")}).catch(je=>{console.error("Error during pagination (regular filter):",je)})},U=z(()=>{const j={};return o.value.status&&(j.status=o.value.status),o.value.priority&&(j.priority=o.value.priority),o.value.assignee&&(j.raised_by=o.value.assignee),o.value.tags&&(j.issue_type=o.value.tags),j});return Qe(()=>{console.log("IssueTracker mounted, initializing with default view"),h.value=!0,m.value="team_tickets",ee("team_tickets"),window.addEventListener("issueListUpdated",j=>de(this,null,function*(){const{count:O,documents:ye}=j.detail;k({type:"info",title:"List Updated",message:`${O} issue${O>1?"s":""} updated: ${ye.slice(0,3).join(", ")}${ye.length>3?"...":""}`,timestamp:new Date}),console.log("🔄 List updated event received - refreshing only stat cards");try{_.value&&_.value.refreshStats&&(console.log("📊 Refreshing stat cards..."),yield _.value.refreshStats(),console.log("📊 Stat cards refreshed successfully")),console.log("✅ Stat cards refreshed after websocket update"),console.log("ℹ️  Individual row updates are handled automatically by the composable")}catch(ue){console.error("❌ Error refreshing stat cards after websocket update:",ue),k({type:"error",title:"Refresh Error",message:"Failed to refresh stat cards. Please refresh manually.",timestamp:new Date})}}))}),ht(()=>{window.removeEventListener("issueListUpdated",()=>{})}),(j,O)=>{const ye=Le("router-link");return a(),i("div",xu,[e("div",wu,[e("div",_u,[e("div",ku,[e("div",Cu,[O[11]||(O[11]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Ticket Tracker",-1)),e("nav",$u,[B(ye,{to:"/",class:"bg-blue-100 text-blue-700 px-3 py-2 rounded-md text-sm font-medium","active-class":"bg-blue-100 text-blue-700","inactive-class":"text-gray-600 hover:text-gray-900"},{default:Q(()=>O[7]||(O[7]=[se(" Tickets ")])),_:1,__:[7]}),B(ye,{to:"/sent-emails",class:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium","active-class":"bg-blue-100 text-blue-700","inactive-class":"text-gray-600 hover:text-gray-900"},{default:Q(()=>O[8]||(O[8]=[se(" Sent Emails ")])),_:1,__:[8]}),O[9]||(O[9]=e("a",{href:"/app/support",class:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium"}," Desk ",-1)),O[10]||(O[10]=e("a",{href:"/intro",class:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium"}," Wiki ",-1))])]),e("div",Su,[B(g(ve),{onClick:O[0]||(O[0]=ue=>F.value=!0),variant:"solid",size:"sm"},{prefix:Q(()=>[B(g(ge),{name:"mail",class:"w-4 h-4"})]),default:Q(()=>[O[12]||(O[12]=se(" Compose Email "))]),_:1,__:[12]}),e("span",Iu,I(g(nt).user),1),B(g(ve),{onClick:O[1]||(O[1]=ue=>g(nt).logout.submit()),variant:"outline",size:"sm"},{default:Q(()=>O[13]||(O[13]=[se(" Logout ")])),_:1,__:[13]})])])])]),e("div",Tu,[B(fa,{ref_key:"issueStatsRef",ref:_,issues:X.value,activeFilter:m.value,onFilterChanged:G},null,8,["issues","activeFilter"]),B(Qn,{searchQuery:g(s),"onUpdate:searchQuery":O[2]||(O[2]=ue=>jt(s)?s.value=ue:null),filters:g(o),"onUpdate:filters":O[3]||(O[3]=ue=>jt(o)?o.value=ue:null),statusOptions:Ae.value,priorityOptions:xe.value,assigneeOptions:We.value,tagsOptions:be.value,issues:P.value,filteredCount:M.value,onSuggestionSelected:te,onFiltersApplied:Y},null,8,["searchQuery","filters","statusOptions","priorityOptions","assigneeOptions","tagsOptions","issues","filteredCount"]),B(er,{issues:X.value,loading:W.value,sortField:J.value,sortDirection:oe.value,onSort:ie},null,8,["issues","loading","sortField","sortDirection"]),B(ia,{currentPage:ke.value,"onUpdate:currentPage":O[4]||(O[4]=ue=>ke.value=ue),itemsPerPage:Se.value,"onUpdate:itemsPerPage":O[5]||(O[5]=ue=>Se.value=ue),totalItems:M.value,onPageChange:R},null,8,["currentPage","itemsPerPage","totalItems"]),e("div",Pu,[e("div",{class:"group relative bg-white rounded-full shadow-lg border p-2 hover:shadow-xl transition-all duration-200",title:g(T)?"Real-time updates active":"Real-time updates disabled"},[e("div",Mu,[B(g(ge),{name:g(T)?"wifi":"wifi-off",class:q(["h-5 w-5 transition-colors duration-200",g(T)?"text-green-600":"text-red-500"])},null,8,["name","class"]),e("div",{class:q(["absolute -top-1 -right-1 w-3 h-3 rounded-full border-2 border-white",g(T)?"bg-green-500 animate-pulse":"bg-red-500"])},null,2),g(L).length>0?(a(),i("div",Ru,I(g(L).length>9?"9+":g(L).length),1)):V("",!0)])],8,Eu),e("button",{onClick:x,class:"group bg-white rounded-full shadow-lg border p-2 hover:shadow-xl hover:bg-blue-50 transition-all duration-200 active:scale-95",title:"Manual refresh"},[B(g(ge),{name:"refresh-cw",class:"h-5 w-5 text-gray-600 group-hover:text-blue-600 group-active:rotate-180 transition-all duration-300"})])])]),B(cr,{notifications:d.value,onRemove:S},null,8,["notifications"]),B(fu,{show:F.value,"onUpdate:show":O[6]||(O[6]=ue=>F.value=ue),onEmailSent:C},null,8,["show"])])}}};export{ju as default};
//# sourceMappingURL=IssueTracker-BbuHUK95.js.map
